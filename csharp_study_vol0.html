<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="python勉強中です。。">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>大人の学び舎 - python-study</title>

    <!-- CSS -->
    <link href="https://unpkg.com/ress/dist/ress.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <!-- <link href="vibrant-ink.css" rel="stylesheet"> -->
    <link href="prettify.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c" rel="stylesheet">
    <link rel="icon" type="image/png" href="favicon.png">

    <!-- javascript -->
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
</head>

<body>
    <div id="study" class="big-bg">
        <header class="page-header wrapper">
            <h1>
                <a href="index.html"><img class="logo" src="logo.png" alt="大人の学び舎ホーム"></a>
            </h1>
            <nav>
                <ul class="main-nav">
                    <li><a href="python_study_vol0.html">python</a></li>
                    <li><a href="csharp_study_vol0.html">C#</a></li>
                    <li><a href="excelvba_study_vol0.html">ExcelVBA</a></li>
                    <li><a href="statistics_study_vol0.html">統計</a></li>
                </ul>
            </nav>
        </header>

        <div class="wrapper">
            <h2 class="page-title">c#-study</h2>
        </div>
    </div>

    <div class="study-contents wrapper">
        <aside>
            <h3 class="sub-title">カテゴリー</h3>
            <ul class="sub-menu">
                <li><a href="python_study_vol0.html">基本操作</a></li>
                <li><a href="python_study_vol1.html">画像関連</a></li>
                <li><a href="python_study_vol2.html">********</a></li>
                <li><a href="python_study_vol3.html">********</a></li>
            </ul>

            <h3 class="sub-title-2nd">基本操作</h3>
            <ul class="sub-menu">
                <li><a href="#python-base-v0">ディレクトリ内のファイルをリストアップ</a></li>
                <li><a href="#">********</a></li>
                <li><a href="#">********</a></li>
                <li><a href="#">********</a></li>
            </ul>
        </aside>

        <article id="python-base-v0">
            <header class="post-info">
                <h2 class="post-title">アップデート2/17</h2>
                <p class="post-date">2/17 <span>2025</span></p>
                <p class="post-cat">カテゴリー：example</p>
            </header>

            <p>
                AddWindow.xaml
            </p>
            <pre><code class="prettyprint">
                Padding="0 0 0 0"  materialDesign:HintAssist.Hint="Path"
            </code></pre>

            <p>
                DataItem.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;

namespace DataManager
{
    public partial class DataItem : ObservableObject
    {
        [ObservableProperty]
        private bool isSelected;

        public int No { get; set; }
        public string DataName { get; set; } = string.Empty;
        public string Link { get; set; } = string.Empty;

        [ObservableProperty]
        private string product = string.Empty;

        [ObservableProperty]
        private string type = string.Empty;

        [ObservableProperty]
        private string itemName = string.Empty;

        [ObservableProperty]
        private string ver = string.Empty;

        [ObservableProperty]
        private string lot = string.Empty;

        [ObservableProperty]
        private string slot = string.Empty;

        public string LotSlot { get; set; } = string.Empty;

        [ObservableProperty]
        private string program = string.Empty;

        [ObservableProperty]
        private string date = string.Empty;

        [ObservableProperty]
        private string owner = string.Empty;

        [ObservableProperty]
        private string remark = string.Empty;

        [ObservableProperty]
        private bool isStructured;

        [ObservableProperty]
        private bool isRegistered;
    }
}
            </code></pre>

            <p>
                EditMajorViewModel.cs(新)
            </p>
            <pre><code class="prettyprint">
                using System.Windows;
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;

namespace DataManager
{
    public partial class EditMajorViewModel : ObservableObject
    {
        #region "変数定義"
        [ObservableProperty]
        private string editMajorTitle = string.Empty;

        [ObservableProperty]
        private string targetTitle = string.Empty;
        
        [ObservableProperty]
        private string targetValue = string.Empty;
        partial void OnTargetValueChanged(string value)
        {
            EditMajorOKCommand.NotifyCanExecuteChanged();
        }

        [ObservableProperty]
        private bool isTargetEnabled;

        [ObservableProperty]
        private string baseTitle = string.Empty;

        [ObservableProperty]
        private string baseValue = string.Empty;

        [ObservableProperty]
        private string dataTypeText = string.Empty;

        [ObservableProperty]
        private int dataTypeNum;

        [ObservableProperty]
        private List&lt;string&gt; _dataTypes = [];

        [ObservableProperty]
        private bool isDataTypeEnabled;
        #endregion

        #region "コンストラクタ"
        public EditMajorViewModel(string _editMajorTitle, string _targetTitle, string _targetValue, bool _isTargetEnabled, string _baseTitle, string _baseValue, bool _isDataTypeEnabled, int dataTypeNum)
        {
            EditMajorTitle = _editMajorTitle;
            TargetTitle = _targetTitle;
            TargetValue = _targetValue;
            IsTargetEnabled = _isTargetEnabled;
            BaseTitle = _baseTitle;
            BaseValue = _baseValue;
            IsDataTypeEnabled = _isDataTypeEnabled;
            foreach (var t in Vals.dataTypes) DataTypes.Add(t);
            DataTypeText = DataTypes[dataTypeNum];
        }
        #endregion

        #region "コマンド定義"
        [RelayCommand(CanExecute = nameof(CanEditMajorOK))]
        private void EditMajorOK(Window window)
        {
            if (TargetValue == BaseValue)
            {
                System.Windows.MessageBox.Show("コピー元と同じ名前は使用できません！");
                return;
            }
            if (IsDataTypeEnabled && DataTypeText == DataTypes[0]) 
            {
                System.Windows.MessageBox.Show("データタイプを選択してください！");
                return;
            }

            DataTypeNum = 0;
            foreach (var t in Vals.dataTypes)
            {
                if (t == DataTypeText) break;
                DataTypeNum++;
            }

            window.DialogResult = true;
            window.Close();
        }
        private bool CanEditMajorOK()
        {
            return !String.IsNullOrEmpty(TargetValue);
        }

        [RelayCommand]
        private static void EditMajorCancel(Window window)
        {
            window.DialogResult = false;
            window.Close();
        }
        #endregion

        #region "メソッド定義"

        #endregion
    }
}
            </code></pre>

            <p>
                EditMajorWindow.xaml(新)
            </p>
            <pre><code class="prettyprint">
                &lt;Window x:Class="DataManager.EditMajorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DataManager"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Style="{StaticResource MaterialDesignWindow}"
        Title="{Binding EditMajorTitle}" Height="207" Width="368"
        ResizeMode="NoResize"&gt;
    &lt;Grid&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
        &lt;/Grid.RowDefinitions&gt;

        &lt;Grid Grid.Row="0" VerticalAlignment="Center"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;

            &lt;Grid Grid.Column="0"&gt;
                &lt;TextBlock Text="{Binding TargetTitle}" Width="70" Margin="8" HorizontalAlignment="Right" VerticalAlignment="Center" TextAlignment="Right"/&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="1"&gt;
                &lt;TextBox Text="{Binding TargetValue}" Margin="8" Width="200" HorizontalAlignment="Left" VerticalAlignment="Center" Background="White"/&gt;
            &lt;/Grid&gt;
        &lt;/Grid&gt;

        &lt;Grid Grid.Row="1" VerticalAlignment="Center"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;

            &lt;Grid Grid.Column="0"&gt;
                &lt;TextBlock Text="{Binding BaseTitle}" Width="70" Margin="8" HorizontalAlignment="Right" VerticalAlignment="Center" TextAlignment="Right"/&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="1"&gt;
                &lt;TextBox Text="{Binding BaseValue}" Margin="8" Width="200" HorizontalAlignment="Left" VerticalAlignment="Center" IsReadOnly="True" IsEnabled="{Binding IsTargetEnabled}"/&gt;
            &lt;/Grid&gt;
        &lt;/Grid&gt;

        &lt;Grid Grid.Row="2" VerticalAlignment="Center"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;

            &lt;Grid Grid.Column="0"&gt;
                &lt;TextBlock Text="データタイプ:" Width="70" Margin="8" HorizontalAlignment="Right" VerticalAlignment="Center" TextAlignment="Right"/&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="1"&gt;
                &lt;ComboBox Margin="8" Width="100" HorizontalAlignment="Left" VerticalAlignment="Center" ItemsSource="{Binding DataTypes}" Text="{Binding DataTypeText}" IsEnabled="{Binding IsDataTypeEnabled}" Background="White"/&gt;
            &lt;/Grid&gt;
        &lt;/Grid&gt;

        &lt;Grid Grid.Row="3"&gt;
            &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center"&gt;
                &lt;Button Command="{Binding EditMajorOKCommand}" Width="90" Margin="0 4 4 0" Content="OK"
                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/&gt;
                &lt;Button Command="{Binding EditMajorCancelCommand}" Width="90" Margin="4 4 8 0" Content="Cancel"
                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/&gt;
            &lt;/StackPanel&gt;
        &lt;/Grid&gt;

    &lt;/Grid&gt;
&lt;/Window&gt;
            </code></pre>

            <p>
                EditMajorWindow.xaml.cs(新)
            </p>
            <pre><code class="prettyprint">
                using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;

namespace DataManager
{
    /// &lt;summary&gt;
    /// EditMajorWindow.xaml の相互作用ロジック
    /// &lt;/summary&gt;
    public partial class EditMajorWindow : Window
    {
        public EditMajorWindow(EditMajorViewModel viewModel)
        {
            InitializeComponent();
            DataContext = viewModel;
        }
    }
}
            </code></pre>

            <p>
                EnumToBooleanConverter.cs (新：不要かも)
            </p>
            <pre><code class="prettyprint">
                using System.Globalization;
using System.Windows.Data;

namespace DataManager
{
    public class EnumToBooleanConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return value != null && value.Equals(parameter);
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if ((bool)value)
            {
                return parameter;
            }
            return System.Windows.Data.Binding.DoNothing;
        }
    }
}
            </code></pre>

            <p>
                ExtractModel.cs
            </p>
            <pre><code class="prettyprint">
                namespace DataManager
{
    public class ExtractModel
    {
        public string LotSlot { get; set; } = string.Empty;
        public string DataName { get; set; } = string.Empty;
        public string Product { get; set; } = string.Empty;
        public string Type { get; set; } = string.Empty;
        public string ItemName { get; set; } = string.Empty;
        public string Ver { get; set; } = string.Empty;
        public bool IsStructured { get; set; }

        // EqualsとGetHashCodeをオーバーライド
        public override bool Equals(object? obj)
        {
            if (obj is ExtractModel otherItem)
            {
                return this.LotSlot == otherItem.LotSlot &&
                        this.DataName == otherItem.DataName &&
                        this.Product == otherItem.Product &&
                        this.Type == otherItem.Type &&
                        this.ItemName == otherItem.ItemName &&
                        this.Ver == otherItem.Ver;
            }
            return false;
        }

        public override int GetHashCode()
        {
            return HashCode.Combine(LotSlot, DataName, Product, Type, ItemName, Ver);
        }
    }
}
            </code></pre>

            <p>
                ItemModel.cs
            </p>
            <pre><code class="prettyprint">
                public int DataTypeNum { get; set; } = 0;
            </code></pre>

            <p>
                MainViewModel.Manegement.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using NPOI.SS.UserModel;
using NPOI.XSSF.UserModel;
using System.Collections.ObjectModel;
using System.IO;
using System.Windows.Input;

namespace DataManager
{
    public partial class MainViewModel : ObservableObject
    {
        #region "変数定義"
        private const double DISPLAY_OFFSET_H = 10.0;
        private const double DISPLAY_OFFSET_V = 30.0;

        //*** 大分類用 ***
        [ObservableProperty]
        private Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt; dataManegementListBoxData;

        [ObservableProperty]
        public ObservableCollection&lt;string&gt; modes = [];

        [ObservableProperty]
        private string selectedMode = string.Empty;
        partial void OnSelectedModeChanged(string value)    //モード切り替え時の動作
        {
            if (value == "public") DataManegementListBoxData = LoadMajorCategory(publicSetupFile);
            else DataManegementListBoxData = LoadMajorCategory(privateSetupFile);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = 0;   //Product以降の動作はOnSelectedProductChangedで記述
        }

        [ObservableProperty]
        private ObservableCollection&lt;ItemModel&gt; products = [];

        [ObservableProperty]
        private ItemModel selectedProduct = new();
        partial void OnSelectedProductChanged(ItemModel value)
        {
            RemoveProductCommand.NotifyCanExecuteChanged(); //選択状態が変わったら、CanRemoveProductを動作させる
            CopyProductCommand.NotifyCanExecuteChanged();
            RenameProductCommand.NotifyCanExecuteChanged();
            if (value != null && DataManegementListBoxData.ContainsKey(value))
            {
                Types = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData[value].Keys);
                SelectedType = null!;
                if (Types.Count &gt; 0) SelectedType = Types[0];    //Type以降の動作はOnSelectedTypeChangedで記述
            }
        }

        [ObservableProperty]
        private int selectedProductIndex;

        [ObservableProperty]
        private string newProductText = string.Empty;   //追加用のTextBoxにバインド

        [ObservableProperty]
        private ObservableCollection&lt;ItemModel&gt; types = [];

        [ObservableProperty]
        private ItemModel selectedType = new();
        partial void OnSelectedTypeChanged(ItemModel value)
        {
            RemoveTypeCommand.NotifyCanExecuteChanged();    //選択状態が変わったら、CanRemoveTypeを動作させる
            CopyTypeCommand.NotifyCanExecuteChanged();
            RenameTypeCommand.NotifyCanExecuteChanged();
            if (value != null && DataManegementListBoxData[SelectedProduct].ContainsKey(value)) 
            {
                ItemNames = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData[SelectedProduct][value]);
                SelectedItemName = null!;
                if (ItemNames.Count &gt; 0) SelectedItemName = ItemNames[0];  //ItemName以降の動作はOnSelectedItemNameChangedで記述
            }
        }

        [ObservableProperty]
        private int selectedTypeIndex;

        [ObservableProperty]
        private string newTypeText = string.Empty;  //追加用のTextBoxにバインド

        [ObservableProperty]
        private ObservableCollection&lt;ItemModel&gt; itemNames = [];

        [ObservableProperty]
        private ItemModel selectedItemName = new();
        partial void OnSelectedItemNameChanged(ItemModel value)
        {
            RemoveItemNameCommand.NotifyCanExecuteChanged(); //選択状態が変わったら、CanRemoveItemNameを動作させる
            CopyItemNameCommand.NotifyCanExecuteChanged();
            RenameItemNameCommand.NotifyCanExecuteChanged();
            if (value != null)
            {
                string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                                    + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + value.Name + ".xlsx";
                try
                {
                    Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                    LoadDataList(filePath); //DataGrid用のExcel設定ファイルを読み込む
                }
                finally
                {
                    Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
                }
            }
        }

        [ObservableProperty]
        private int selectedItemNameIndex;

        [ObservableProperty]
        private string newItemNameText = string.Empty;  //追加用のTextBoxにバインド

        //*** データリスト(フィルタリング) ***
        [ObservableProperty]
        private ObservableCollection&lt;string&gt; headers = [];  //データリスト==DataGridのヘッダー情報

        [ObservableProperty]
        private Dictionary&lt;string, string&gt; listFilters = [];  //フィルタ用のディクショナリ

        [ObservableProperty] 
        private string selectedFilterHeader = string.Empty;
        partial void OnSelectedFilterHeaderChanged(string value)
        {
            isHolding = true;
            UpdateFilterText();  //ComboBoxのHeader選択を切り替えたら、フィルタの表示(TextBox)を更新する
            isHolding = false;
        }
        private bool isHolding;

        [ObservableProperty] 
        private string filterValue = string.Empty;
        partial void OnFilterValueChanged(string value)
        {
            if (!string.IsNullOrEmpty(SelectedFilterHeader) && !isHolding) //フィルタのヘッダーの切り替え時、フィルタのクリア時(isHolding=true)は実行しない
            { 
                ListFilters[SelectedFilterHeader] = value;   //フィルタ(TextBox)の値を更新したらフィルタ用のディクショナリを更新
            }
        }

        [ObservableProperty]
        private bool isFiltering;   //フィルタの実行はコマンドで実施するため、フィルタが実行中である変数を用意。クリアが実行されるまでtrue。

        //*** データリスト ***
        [ObservableProperty]
        private ObservableCollection&lt;DataItem&gt; dataItems = [];  //DataGridのデータ

        //[ObservableProperty] 
        //private ObservableCollection&lt;DataItem&gt; tmpDataItems = [];    //DataGridのテンポラリデータ

        [ObservableProperty]
        private List&lt;string&gt; dataManegementColumnHeaders = [];  // TODO: DataGridのヘッダー。現状は有効利用できていない。

        [ObservableProperty]
        private DataItem selectedDataItem = new();  //DataGridの選択行
        partial void OnSelectedDataItemChanged(DataItem value)
        {
            UpdateDataItemInfo(value);    //選択が変わったらInfomationを更新
        }

        [ObservableProperty]
        private string dataItemInfo = string.Empty; //選択行の情報

        [ObservableProperty]
        private bool isDataManegementEnabled;   //各コマンド実行中にボタンを無効にするための変数。DataManegementのコントロールのEnabledにバインディング。

        [ObservableProperty]
        private bool isDataListAdding;  //DataGridの追加中を示す変数。

        [ObservableProperty]
        private int addDataListStatus; // DataGridの削除中のボタン状態の変数。

        [ObservableProperty]
        private bool isDataListEditing;  //DataGridの編集中を示す変数。

        [ObservableProperty]
        private int editDataListStatus; // DataGridの編集中のボタン状態の変数。

        [ObservableProperty]
        private bool isDataListRemoving;  //DataGridの削除中を示す変数。

        [ObservableProperty]
        private int removeDataListStatus; // DataGridの削除中のボタン状態の変数。

        [ObservableProperty]
        private bool isDataGridEditing;  //DataGridのセルの編集中を示す変数。

        public ObservableCollection&lt;ExtractModel&gt; TargetDataItems { get; } = [];

        [ObservableProperty]
        private string selectedTargetDataName = string.Empty;

        [ObservableProperty]
        private int selectedTargetDataNameIndex;

        public ObservableCollection&lt;ExtractModel&gt; SelectedTargetDataNames { get; } = [];  // 選択されたListBoxのアイテム
        #endregion

        #region "コマンド定義"
        /// &lt;summary&gt;
        /// Product追加コマンド(大分類のファイルに追記する and データリストのファイル新規作成)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand]
        private void AddProduct()
        {
            if (!string.IsNullOrWhiteSpace(NewProductText) && !Products.Any(item =&gt; item.Name == NewProductText))
            {
                AddProductToFile(NewProductText);
                NewProductText = string.Empty;
            }
        }

        /// &lt;summary&gt;
        /// Product削除コマンド(大分類のファイルから削除する and データリストのファイル削除)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveProduct))]
        private void RemoveProduct()
        {
            TargetDataItems.Clear();    //抽出のListBoxをクリア
            foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア

            int _selectedIndex = SelectedProductIndex;
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream fs = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(fs);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            for (int i = sheet.LastRowNum; i &gt;= 0; i--)
            {
                IRow row = sheet.GetRow(i);
                if (row != null)
                {
                    ICell cell0 = row.GetCell(0); // 1列目のセルを取得
                    ICell cell1 = row.GetCell(1); // 2列目のセルを取得
                    ICell cell2 = row.GetCell(2); // 3列目のセルを取得
                    ICell cell4 = row.GetCell(4); // 5列目のセルを取得
                    if (cell0 != null && cell2 != null && cell4 != null && cell0.StringCellValue == SelectedProduct.Name && cell1.NumericCellValue != 0)
                    {
                        sheet.RemoveRow(row);   //行を削除                 
                        if (i &lt; sheet.LastRowNum) sheet.ShiftRows(i + 1, sheet.LastRowNum, -1); // 後続の行を上にシフト
                        string deleteFilePath = folderPath + "\\" + cell0.StringCellValue + "_" + cell2.StringCellValue + "_" + cell4.StringCellValue + ".xlsx";
                        if (File.Exists(deleteFilePath)) File.Delete(deleteFilePath);
                    }
                }
            }

            using (FileStream fs = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fs); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProductIndex = _selectedIndex - 1;  //削除できないデータが1つ以上あるため0以下になるケアは不要
        }
        private bool CanRemoveProduct()
        {
            return SelectedProduct != null && SelectedProduct.IsDeletable;
        }

        /// &lt;summary&gt;
        /// Productコピーコマンド
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanCopyProduct))]
        private void CopyProduct()
        {
            var editMajorViewModel = new EditMajorViewModel("ProductのCopy", "Copy先", "NewName", true, "Copy元", SelectedProduct.Name, false, 0);
            var editMajorWindow = new EditMajorWindow(editMajorViewModel)
            {
                Owner = System.Windows.Application.Current.MainWindow,
                Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
            };
            if (editMajorWindow.ShowDialog() == true)
            {
                CopyProductToFile(SelectedProduct.Name, editMajorViewModel.TargetValue);
            }
        }
        private bool CanCopyProduct()
        {
            return SelectedProduct != null;
        }

        /// &lt;summary&gt;
        /// Productリネームコマンド
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRenameProduct))]
        private void RenameProduct()
        {
            TargetDataItems.Clear();    //抽出のListBoxをクリア
            foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア

            var editMajorViewModel = new EditMajorViewModel("Productの名前変更", "変更後", "NewName", true, "変更元", SelectedProduct.Name, false, 0);
            var editMajorWindow = new EditMajorWindow(editMajorViewModel)
            {
                Owner = System.Windows.Application.Current.MainWindow,
                Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
            };
            if (editMajorWindow.ShowDialog() == true)
            {
                RenameProductToFile(SelectedProduct.Name, editMajorViewModel.TargetValue);
            }
        }
        private bool CanRenameProduct()
        {
            return SelectedProduct != null && SelectedProduct.IsDeletable;
        }

        /// &lt;summary&gt;
        /// Type追加コマンド(大分類のファイルに追記する and データリストのファイル新規作成)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand]
        private void AddType()
        {
            if (!string.IsNullOrWhiteSpace(NewTypeText) && !Types.Any(item =&gt; item.Name == NewTypeText))
            {
                var editMajorViewModel = new EditMajorViewModel("Typeの追加", "追加する名前", "NewName", true, "---", "---", true, 0);
                var editMajorWindow = new EditMajorWindow(editMajorViewModel)
                {
                    Owner = System.Windows.Application.Current.MainWindow,
                    Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                    Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
                };
                if (editMajorWindow.ShowDialog() == true)
                {
                    var newType = new ItemModel { Name = editMajorViewModel.TargetValue, IsDeletable = true, DataTypeNum = editMajorViewModel.DataTypeNum };
                    //AddTypeToFile(NewTypeText);
                    AddTypeToFile(newType);
                    NewTypeText = string.Empty;
                }
            }
        }

        /// &lt;summary&gt;
        /// Type削除コマンド(大分類のファイルから削除する and データリストのファイル削除)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveType))]
        private void RemoveType()
        {
            TargetDataItems.Clear();    //抽出のListBoxをクリア
            foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア

            int _selectedProductIndex = SelectedProductIndex;
            int _selectedTypeIndex = SelectedTypeIndex;
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream fs = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(fs);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            for (int i = sheet.LastRowNum; i &gt;= 0; i--)
            {
                IRow row = sheet.GetRow(i);
                if (row != null)
                {
                    ICell cell0 = row.GetCell(0); // 1列目のセルを取得
                    ICell cell2 = row.GetCell(2); // 3列目のセルを取得
                    ICell cell3 = row.GetCell(3); // 4列目のセルを取得
                    ICell cell4 = row.GetCell(4); // 4列目のセルを取得
                    if (cell0 != null && cell2 != null && cell4 != null
                        && cell0.StringCellValue == SelectedProduct.Name && cell2.StringCellValue == SelectedType.Name && cell3.NumericCellValue != 0)
                    {
                        sheet.RemoveRow(row);   // 行を削除                   
                        if (i &lt; sheet.LastRowNum) sheet.ShiftRows(i + 1, sheet.LastRowNum, -1); // 後続の行を上にシフト
                        string deleteFilePath = folderPath + "\\" + cell0.StringCellValue + "_" + cell2.StringCellValue + "_" + cell4.StringCellValue + ".xlsx";
                        if (File.Exists(deleteFilePath)) File.Delete(deleteFilePath);
                    }
                }
            }

            using (FileStream fs = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fs); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = _selectedProductIndex;
            SelectedTypeIndex = _selectedTypeIndex - 1;   //削除できないデータが1つ以上あるため0以下になるケアは不要
        }
        private bool CanRemoveType()
        {
            return SelectedType != null && SelectedType.IsDeletable;
        }

        /// &lt;summary&gt;
        /// Typeコピーコマンド
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanCopyType))]
        private void CopyType()
        {
            var editMajorViewModel = new EditMajorViewModel("TypeのCopy", "Copy先", "NewName", true, "Copy元", SelectedType.Name, false, 0);
            var editMajorWindow = new EditMajorWindow(editMajorViewModel)
            {
                Owner = System.Windows.Application.Current.MainWindow,
                Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
            };
            if (editMajorWindow.ShowDialog() == true)
            {
                CopyTypeToFile(SelectedType.Name, editMajorViewModel.TargetValue);
            }
        }
        private bool CanCopyType()
        {
            return SelectedType != null;
        }

        /// &lt;summary&gt;
        /// Typeリネームコマンド、データタイプも変更可能
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRenameType))]
        private void RenameType()
        {
            TargetDataItems.Clear();    //抽出のListBoxをクリア
            foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア

            var editMajorViewModel = new EditMajorViewModel("Typeの名前変更", "変更後", "NewName", true, "変更元", SelectedType.Name, true, SelectedType.DataTypeNum);
            var editMajorWindow = new EditMajorWindow(editMajorViewModel)
            {
                Owner = System.Windows.Application.Current.MainWindow,
                Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
            };
            if (editMajorWindow.ShowDialog() == true)
            {
                var newRenameType = new ItemModel { Name = editMajorViewModel.TargetValue, IsDeletable = true, DataTypeNum = editMajorViewModel.DataTypeNum };
                RenameTypeToFile(SelectedType.Name, newRenameType);
            }
        }
        private bool CanRenameType()
        {
            return SelectedType != null && SelectedType.IsDeletable;
        }

        /// &lt;summary&gt;
        /// ItemName追加コマンド(大分類のファイルに追記する and データリストのファイル新規作成)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand]
        private void AddItemName()
        {
            if (!string.IsNullOrWhiteSpace(NewItemNameText) && !ItemNames.Any(item =&gt; item.Name == NewItemNameText))
            {
                AddItemNameToFile(NewItemNameText);
                NewItemNameText = string.Empty;
            }
        }

        /// &lt;summary&gt;
        /// ItemName削除コマンド(大分類のファイルから削除する and データリストのファイル削除)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveItemName))]
        private void RemoveItemName()
        {
            TargetDataItems.Clear();    //抽出のListBoxをクリア
            foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア

            int _selectedProductIndex = SelectedProductIndex;
            int _selectedTypeIndex = SelectedTypeIndex;
            int _selectedItemNameIndex = SelectedItemNameIndex;
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream fs = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(fs);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            for (int i = sheet.LastRowNum; i &gt;= 0; i--)
            {
                IRow row = sheet.GetRow(i);
                if (row != null)
                {
                    ICell cell0 = row.GetCell(0); // 1列目のセルを取得
                    ICell cell2 = row.GetCell(2); // 3列目のセルを取得
                    ICell cell4 = row.GetCell(4); // 4列目のセルを取得
                    ICell cell5 = row.GetCell(5); // 4列目のセルを取得
                    if (cell0 != null && cell2 != null && cell4 != null
                        && cell0.StringCellValue == SelectedProduct.Name && cell2.StringCellValue == SelectedType.Name && cell4.StringCellValue == SelectedItemName.Name && cell5.NumericCellValue != 0)
                    {
                        sheet.RemoveRow(row);   // 行を削除
                                                // 後続の行を上にシフト
                        if (i &lt; sheet.LastRowNum) sheet.ShiftRows(i + 1, sheet.LastRowNum, -1);
                        string deleteFilePath = folderPath + "\\" + cell0.StringCellValue + "_" + cell2.StringCellValue + "_" + cell4.StringCellValue + ".xlsx";
                        if (File.Exists(deleteFilePath)) File.Delete(deleteFilePath);
                        break;
                    }
                }
            }

            using (FileStream fs = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fs); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = _selectedProductIndex;
            SelectedType = null!;
            SelectedTypeIndex = _selectedTypeIndex;
            SelectedItemNameIndex = _selectedItemNameIndex - 1;     //削除できないデータが1つ以上あるため0以下になるケアは不要
        }
        private bool CanRemoveItemName()
        {
            return SelectedItemName != null && SelectedItemName.IsDeletable;
        }

        /// &lt;summary&gt;
        /// ItemNameコピーコマンド
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanCopyItemName))]
        private void CopyItemName()
        {
            var editMajorViewModel = new EditMajorViewModel("ItemNameのCopy", "Copy先", "NewName", true, "Copy元", SelectedItemName.Name, false, 0);
            var editMajorWindow = new EditMajorWindow(editMajorViewModel)
            {
                Owner = System.Windows.Application.Current.MainWindow,
                Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
            };
            if (editMajorWindow.ShowDialog() == true)
            {
                CopyItemNameToFile(SelectedItemName.Name, editMajorViewModel.TargetValue);
            }
        }
        private bool CanCopyItemName()
        {
            return SelectedItemName != null;
        }

        /// &lt;summary&gt;
        /// ItemNameリネームコマンド
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRenameItemName))]
        private void RenameItemName()
        {
            TargetDataItems.Clear();    //抽出のListBoxをクリア
            foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア

            var editMajorViewModel = new EditMajorViewModel("ItemNameの名前変更", "変更後", "NewName", true, "変更元", SelectedItemName.Name, false, 0);
            var editMajorWindow = new EditMajorWindow(editMajorViewModel)
            {
                Owner = System.Windows.Application.Current.MainWindow,
                Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
            };
            if (editMajorWindow.ShowDialog() == true)
            {
                RenameProductToFile(SelectedItemName.Name, editMajorViewModel.TargetValue);
            }
        }
        private bool CanRenameItemName()
        {
            return SelectedItemName != null && SelectedItemName.IsDeletable;
        }

        /// &lt;summary&gt;
        /// データリストにフィルタを実行するコマンド
        /// &lt;/summary&gt;
        [RelayCommand]
        private void ApplyFilter()
        {
            IsFiltering = true;
            //TargetDataItems.Clear();    //抽出のListBoxをクリア
            //foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア

            Dictionary&lt;string, string&gt; filters = [];
            foreach (var filter in ListFilters)
            {
                if (filter.Value != "") filters.Add(filter.Key, filter.Value);
            }
            if (filters.Count == 0) return; //フィルタが空の場合は終了

            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   //DataListの編集には時間がかかる可能性があるのでマウスカーソルの状態を変える
                string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                                    + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedItemName.Name + ".xlsx";
                using var fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);
                XSSFWorkbook workbook = new(fs);
                ISheet sheet = workbook.GetSheetAt(0);

                //フィルタをかけるヘッダとデータリストの列番号を紐づけ
                var headerRow = sheet.GetRow(0);
                Dictionary&lt;string, int&gt; headersColumn = [];
                foreach (var filter in filters)
                {
                    for (int j = 0; j &lt; headerRow.LastCellNum; j++)
                    {
                        if (filter.Key == headerRow.GetCell(j).ToString())
                        {
                            headersColumn.Add(filter.Key, j);
                        }
                    }
                }

                // データ行を取得
                DataItems.Clear();
                for (int i = 1; i &lt;= sheet.LastRowNum; i++)
                {
                    var row = sheet.GetRow(i);
                    if (row == null) continue;

                    int matchCnt = 0;
                    foreach (var filter in filters)
                    {
                        if (filter.Key == "No") //TODO:Noでフィルタをかけるアルゴは要検討
                        {
                            if (row.GetCell(headersColumn[filter.Key]).NumericCellValue.ToString().Contains(filter.Value)) ++matchCnt;
                        }
                        else
                        {
                            if (row.GetCell(headersColumn[filter.Key]).StringCellValue.Contains(filter.Value)) ++matchCnt;
                        }
                    }

                    if (matchCnt == filters.Count)  //フィルタ数とマッチ数が一致したdataItemをDataItemsに追加
                    {
                        var dataItem = SetDataItem(row);
                        DataItems.Add(dataItem);
                    }
                }
                workbook.Close();

                //TargetDataItemsに含まれる場合は選択状態にする
                foreach (var item in TargetDataItems)
                {
                    var matchItem = DataItems.FirstOrDefault(f =&gt;
                        f.LotSlot == item.LotSlot &&
                        f.DataName == item.DataName &&
                        f.Product == item.Product &&
                        f.Type == item.Type &&
                        f.ItemName == item.ItemName &&
                        f.Ver == item.Ver);
                    if (matchItem != null) matchItem.IsRegistered = true;  // IsRegistered を false に設定
                }
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }
        }

        /// &lt;summary&gt;
        /// フィルタをクリアするコマンド
        /// &lt;/summary&gt;
        [RelayCommand]
        private void ClearFilter()
        {
            ClearFilterDictionary();
            string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                                    + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedItemName.Name + ".xlsx";
            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   //DataListの編集には時間がかかる可能性があるのでマウスカーソルの状態を変える
                LoadDataList(filePath); //DataGrid用のExcel設定ファイルを読み込む
                foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }
        }

        /// &lt;summary&gt;
        /// データリストにdataItemを追加するコマンド(別ウインドウが立ち上がる)
        /// &lt;/summary&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        [RelayCommand]
        private async Task AddDataListAsync()
        {
            IsDataListAdding = true;
            IsDataManegementEnabled = !IsDataListAdding;
            AddDataListStatus = -1;
            //TargetDataItems.Clear();    //抽出のListBoxをクリア
            //foreach (var item in DataItems) item.IsRegistered = false;

            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            var addViewModel = new AddViewModel(folderPath, SelectedProduct, SelectedType, SelectedItemName, DataManegementListBoxData);
            var addWindow = new AddWindow(addViewModel)
            {
                Owner = System.Windows.Application.Current.MainWindow,
                Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
            };
            if (addWindow.ShowDialog() == true) 
            {
                string preProduct = string.Empty, preType = string.Empty, preItemName = string.Empty, tmpProduct, tmpType, tmpItemName;
                List&lt;DataItem&gt; tmpDataItems = [];
                int cnt = 0;
                foreach (var newItem in addViewModel.NewDataItems)
                {
                    tmpProduct = newItem.Product;
                    tmpType = newItem.Type;
                    tmpItemName = newItem.ItemName;
                    if(cnt &gt; 0 && !(preProduct == tmpProduct && preType == tmpType && preItemName == tmpItemName))
                    {   //大項目分類が切り替わったら、新規の大分類かチェックし、データリストを更新
                        CheckMajorCategory(preProduct, preType, preItemName);
                        await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, false);
                        tmpDataItems = [];
                    }
                    tmpDataItems.Add(newItem);
                    preProduct = tmpProduct;
                    preType = tmpType;
                    preItemName = tmpItemName;
                    cnt++;
                }
                CheckMajorCategory(preProduct, preType, preItemName);
                await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, true);
            }

            IsDataListAdding = false;
            IsDataManegementEnabled = !IsDataListAdding;
            AddDataListStatus = 0;
        }

        /// &lt;summary&gt;
        /// ドロップされたファイルをデータリストに追加するコマンド(別ウインドウが立ち上がる)
        /// &lt;/summary&gt;
        /// &lt;param name="files"&gt;ドロップされたファイル&lt;/param&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        [RelayCommand]
        private async Task AddDataDragAsync(string[] files)
        {
            IsDataManegementEnabled = false;
            //TargetDataItems.Clear();    //抽出のListBoxをクリア
            //foreach (var item in DataItems) item.IsRegistered = false;

            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            var addViewModel = new AddViewModel(folderPath, SelectedProduct, SelectedType, SelectedItemName, DataManegementListBoxData, files);
            var addWindow = new AddWindow(addViewModel)
            {
                Owner = System.Windows.Application.Current.MainWindow,
                Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
            };
            if (addWindow.ShowDialog() == true)
            {
                string preProduct = string.Empty, preType = string.Empty, preItemName = string.Empty, tmpProduct, tmpType, tmpItemName;
                List&lt;DataItem&gt; tmpDataItems = [];
                int cnt = 0;
                foreach (var newItem in addViewModel.NewDataItems)
                {
                    tmpProduct = newItem.Product;
                    tmpType = newItem.Type;
                    tmpItemName = newItem.ItemName;
                    if (cnt &gt; 0 && !(preProduct == tmpProduct && preType == tmpType && preItemName == tmpItemName))
                    {
                        CheckMajorCategory(preProduct, preType, preItemName);
                        await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, false);
                        tmpDataItems = [];
                    }
                    tmpDataItems.Add(newItem);
                    preProduct = tmpProduct;
                    preType = tmpType;
                    preItemName = tmpItemName;
                    cnt++;
                }
                CheckMajorCategory(preProduct, preType, preItemName);
                await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, true);
            }

            IsDataManegementEnabled = true;
        }

        /// &lt;summary&gt;
        /// 選択アイテムの編集
        /// &lt;/summary&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        [RelayCommand(CanExecute = nameof(CanEditDataList))]
        private async Task EditDataListAsync()
        {
            IsDataListEditing = true;
            IsDataManegementEnabled = !IsDataListEditing;
            EditDataListStatus = -1;
            //TargetDataItems.Clear();    //抽出のListBoxをクリア
            //foreach (var item in DataItems) item.IsRegistered = false;

            List&lt;DataItem&gt; selectedDataItems = [];
            foreach (var item in DataItems)
            {
                if (item.IsSelected) selectedDataItems.Add(item);
            }

            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            var addViewModel = new AddViewModel(folderPath, DataManegementListBoxData, selectedDataItems);
            var addWindow = new AddWindow(addViewModel)
            {
                Owner = System.Windows.Application.Current.MainWindow,
                Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
            };
            if (addWindow.ShowDialog() == true)
            {
                string preProduct = string.Empty, preType = string.Empty, preItemName = string.Empty, tmpProduct, tmpType, tmpItemName;
                List&lt;DataItem&gt; tmpDataItems = [];
                int cnt = 0;
                foreach (var newItem in addViewModel.NewDataItems)
                {
                    tmpProduct = newItem.Product;
                    tmpType = newItem.Type;
                    tmpItemName = newItem.ItemName;
                    if (cnt &gt; 0 && !(preProduct == tmpProduct && preType == tmpType && preItemName == tmpItemName))
                    {
                        CheckMajorCategory(preProduct, preType, preItemName);
                        await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, false);
                        tmpDataItems = [];
                    }
                    tmpDataItems.Add(newItem);
                    preProduct = tmpProduct;
                    preType = tmpType;
                    preItemName = tmpItemName;
                    cnt++;
                }
                CheckMajorCategory(preProduct, preType, preItemName);
                await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, true);
            }

            IsDataListEditing = false;
            IsDataManegementEnabled = !IsDataListEditing;
            EditDataListStatus = 0;
        }
        private bool CanEditDataList() 
        {
            return DataItems.Any(item =&gt; item.IsSelected);
        }

        /// &lt;summary&gt;
        /// 選択行のデータをデータリストから削除
        /// &lt;/summary&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveDataList))]
        private async Task RemoveDataListAsync()
        {
            IsDataListRemoving = true;
            IsDataManegementEnabled = !IsDataListRemoving;
            RemoveDataListStatus = -1;
            foreach (var item in DataItems) item.IsRegistered = false;
            var itemsToRemove = DataItems.Where(item =&gt; item.IsSelected).Select(item =&gt; item.No).ToList();
            //TargetDataItems.Clear();    //抽出のListBoxをクリア
            //TargetDataItemsに削除アイテムが含まれる場合は削除
            foreach (var no in itemsToRemove)
            {
                var item = DataItems[no];
                var matchItem = TargetDataItems.FirstOrDefault(f =&gt;
                    f.LotSlot == item.LotSlot &&
                    f.DataName == item.DataName &&
                    f.Product == item.Product &&
                    f.Type == item.Type &&
                    f.ItemName == item.ItemName &&
                    f.Ver == item.Ver);
                if (matchItem != null) TargetDataItems.Remove(matchItem);
            }

            string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                            + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedItemName.Name + ".xlsx";
            Dictionary&lt;string, List&lt;DataItem&gt;&gt; deleteItems = [];

            //データの削除では行をシフトさせる処理が重くなるケースが考えられるためいったんファイルを削除し新規作成する。
            List&lt;DataItem&gt; tmpDataItems = LoadDataItems(filePath);  //現状のファイル内容をいったん保持
            if (File.Exists(filePath)) File.Delete(filePath);       //いったん削除

            XSSFWorkbook workbook = new();  //設定ファイル新規作成
            ISheet sheet = workbook.CreateSheet("DataGrid");

            await Task.Run(() =&gt; 
            {
                // ヘッダー行を作成
                IRow headerRow = sheet.CreateRow(0);
                int i = 0;
                foreach (var header in Vals.dataGridHeaders)
                {
                    headerRow.CreateCell(i).SetCellValue(header);
                    i++;
                }

                int rowcnt = 1;
                foreach (DataItem item in tmpDataItems)
                {
                    if (!itemsToRemove.Contains(item.No))
                    {   //削除対象でない場合は設定ファイルに追記
                        IRow row = sheet.CreateRow(rowcnt);
                        SetDataItemToExcel(row, rowcnt, item);
                        rowcnt++;
                    }
                    else if (itemsToRemove.Contains(item.No))
                    {   //削除対象の場合はdeleteItemsに追加
                        var dataItem = SetDataItem(item);
                        if (!deleteItems.ContainsKey(item.ItemName)) deleteItems[item.ItemName] = [];
                        deleteItems[item.ItemName].Add(dataItem);
                    }
                }
            });

            //DataGridアップデート(★この時点ではまだデータリストのエクセルファイルは閉じてない)
            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                if (IsFiltering)
                {   //フィルタリングが有効の場合、フィルタリングをした状態にする
                    //ヘッダと紐づけ
                    Dictionary&lt;string, string&gt; filters = [];
                    foreach (var filter in ListFilters)
                    {
                        if (filter.Value != "") filters.Add(filter.Key, filter.Value);
                    }

                    var headerRow = sheet.GetRow(0);
                    Dictionary&lt;string, int&gt; headersColumn = [];
                    foreach (var filter in filters)
                    {
                        for (int j = 0; j &lt; headerRow.LastCellNum; j++)
                        {
                            if (filter.Key == headerRow.GetCell(j).ToString())
                            {
                                headersColumn.Add(filter.Key, j);
                            }
                        }
                    }

                    // データ行を取得
                    DataItems.Clear();
                    for (int i = 1; i &lt;= sheet.LastRowNum; i++)
                    {
                        var row = sheet.GetRow(i);
                        if (row == null) continue;

                        int matchCnt = 0;
                        foreach (var filter in filters)
                        {
                            if (row.GetCell(headersColumn[filter.Key]).StringCellValue.Contains(filter.Value)) ++matchCnt;
                        }

                        if (matchCnt == filters.Count)
                        {
                            var dataItem = SetDataItem(row);
                            DataItems.Add(dataItem);
                        }
                    }
                }
                else
                {   //フィルタリングが無効の場合
                    // データ行を取得
                    DataItems.Clear();
                    for (int i = 1; i &lt;= sheet.LastRowNum; i++)
                    {
                        var row = sheet.GetRow(i);
                        if (row == null) continue;
                        var dataItem = SetDataItem(row);
                        DataItems.Add(dataItem);
                    }
                }

                //TargetDataItemsに含まれる場合は選択状態にする
                foreach (var item in TargetDataItems)
                {
                    var matchItem = DataItems.FirstOrDefault(f =&gt;
                        f.LotSlot == item.LotSlot &&
                        f.DataName == item.DataName &&
                        f.Product == item.Product &&
                        f.Type == item.Type &&
                        f.ItemName == item.ItemName &&
                        f.Ver == item.Ver);
                    if (matchItem != null) matchItem.IsRegistered = true;  // IsRegistered を false に設定
                }
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
                using var fs = new FileStream(filePath, FileMode.Create, FileAccess.Write); // ワークブックをファイルに保存して閉じる
                workbook.Write(fs);
                workbook.Close();
            }

            if (SelectedItemName.Name != "all")
            {   //"all"以外が選択されている場合は、allのファイルでも同じデータを削除する
                filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                            + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + "all" + ".xlsx";
                tmpDataItems = LoadDataItems(filePath);
                if (File.Exists(filePath)) File.Delete(filePath);

                workbook = new();
                sheet = workbook.CreateSheet("DataGrid");

                await Task.Run(() =&gt;
                {
                    // ヘッダー行を作成
                    IRow headerRow = sheet.CreateRow(0);
                    int i = 0;
                    foreach (var header in Vals.dataGridHeaders)
                    {
                        headerRow.CreateCell(i).SetCellValue(header);
                        i++;
                    }

                    int rowcnt = 1;
                    foreach (var item in tmpDataItems)
                    {
                        if (!MatchDataItem(item, deleteItems[SelectedItemName.Name]))
                        {
                            IRow row = sheet.CreateRow(rowcnt);
                            SetDataItemToExcel(row, rowcnt, item);
                            rowcnt++;
                        }
                    }
                });

                // ワークブックをファイルに保存
                using var fs0 = new FileStream(filePath, FileMode.Create, FileAccess.Write);
                workbook.Write(fs0);
                workbook.Close();
            }
            else 
            {   //"all"が選択されていたら、該当するItemNameのファイルのデータも削除する
                foreach (var key in deleteItems.Keys)
                {
                    filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                        + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + key + ".xlsx";
                    tmpDataItems = LoadDataItems(filePath);
                    if (File.Exists(filePath)) File.Delete(filePath);

                    workbook = new();
                    sheet = workbook.CreateSheet("DataGrid");

                    await Task.Run(() =&gt;
                    {
                        // ヘッダー行を作成
                        IRow headerRow = sheet.CreateRow(0);
                        int i = 0;
                        foreach (var header in Vals.dataGridHeaders)
                        {
                            headerRow.CreateCell(i).SetCellValue(header);
                            i++;
                        }

                        int rowcnt = 1;
                        foreach (var item in tmpDataItems)
                        {
                            if (!MatchDataItem(item, deleteItems[key]))
                            {
                                IRow row = sheet.CreateRow(rowcnt);
                                SetDataItemToExcel(row, rowcnt, item);
                                rowcnt++;
                            }
                        }
                    });

                    // ワークブックをファイルに保存
                    using var fs0 = new FileStream(filePath, FileMode.Create, FileAccess.Write);
                    workbook.Write(fs0);
                    workbook.Close();
                }
            }

            IsDataListRemoving = false;
            IsDataManegementEnabled = !IsDataListRemoving;
            RemoveDataListStatus = 0;
        }
        private bool CanRemoveDataList()
        {
            return DataItems.Any(item =&gt; item.IsSelected);
        }

        /// &lt;summary&gt;
        /// データリストの全データをListBoxに登録
        /// &lt;/summary&gt;
        [RelayCommand]
        private void MoveAllFiles()
        {
            foreach (var item in DataItems)
            {
                var target = new ExtractModel { LotSlot = item.LotSlot, DataName = item.DataName, Product = item.Product, Type = item.Type, ItemName = item.ItemName, Ver = item.Ver, IsStructured = item.IsStructured };
                if (!TargetDataItems.Contains(target))
                {
                    TargetDataItems.Add(target);
                    item.IsRegistered = true;  // IsRegistered を true に設定
                }
                item.IsSelected = false;
            }
        }

        /// &lt;summary&gt;
        /// 選択したデータリストのデータを抽出リストに登録
        /// &lt;/summary&gt;
        [RelayCommand]
        private void MoveSelectedFiles()
        {
            var selectedDataItems = DataItems.Where(item =&gt; item.IsSelected).ToList();
            foreach (var item in selectedDataItems)
            {
                var target = new ExtractModel { LotSlot = item.LotSlot, DataName = item.DataName, Product = item.Product, Type = item.Type, ItemName = item.ItemName, Ver = item.Ver, IsStructured = item.IsStructured };
                if (!TargetDataItems.Contains(target))
                {
                    TargetDataItems.Add(target);
                    item.IsRegistered = true;  // IsRegistered を true に設定
                }
                item.IsSelected = false;
            }
        }

        /// &lt;summary&gt;
        /// 選択した抽出リストのデータを抽出リストから削除
        /// &lt;/summary&gt;
        [RelayCommand]
        private void CancelSelectedFiles()
        {
            var canceledDataItems = SelectedTargetDataNames.ToList();
            HashSet&lt;ExtractModel&gt; data1Set = new(canceledDataItems);
            foreach (var item in canceledDataItems)
            {
                var matchItem = DataItems.FirstOrDefault(f =&gt;
                    f.LotSlot == item.LotSlot &&
                    f.DataName == item.DataName &&
                    f.Product == item.Product &&
                    f.Type == item.Type &&
                    f.ItemName == item.ItemName &&
                    f.Ver == item.Ver);
                if (matchItem != null)
                {
                    TargetDataItems.Remove(item);
                    matchItem.IsRegistered = false;  // IsRegistered を false に設定
                }
            }
            foreach (var item in DataItems) item.IsSelected = false;
        }

        /// &lt;summary&gt;
        /// 全てのListBoxのデータをクリア
        /// &lt;/summary&gt;
        [RelayCommand]
        private void CancelAllFiles()
        {
            TargetDataItems.Clear();
            foreach (var item in DataItems)
            {
                item.IsRegistered = false;  // IsRegistered を false に設定
            }
            foreach (var item in DataItems) item.IsSelected = false;
        }
        #endregion

        #region "メソッド定義"
        /// &lt;summary&gt;
        /// 大分類設定ファイルの新規作成
        /// &lt;/summary&gt;
        /// &lt;param name="_path"&gt;設定ファイルのパス&lt;/param&gt;
        private static void MakeInitialSetupFile(string _path)
        {
            XSSFWorkbook workbook = new();
            ISheet sheet = workbook.CreateSheet("setup");

            // ヘッダー行を作成
            IRow headerRow = sheet.CreateRow(0);
            headerRow.CreateCell(0).SetCellValue("Product");
            headerRow.CreateCell(1).SetCellValue("isProductDeletable");
            headerRow.CreateCell(2).SetCellValue("Type");
            headerRow.CreateCell(3).SetCellValue("isTypeDeletable");
            headerRow.CreateCell(4).SetCellValue("ItemName");
            headerRow.CreateCell(5).SetCellValue("isItemNameDeletable");
            headerRow.CreateCell(6).SetCellValue("DataTypeNum");

            // データ行を作成
            int d = 0;
            for (int i = 0; i &lt; Vals.initialProducts.Count; i++)
            {
                for (int j = 0; j &lt; Vals.initialTypes.Count; j++)
                {
                    for (int k = 0; k &lt; Vals.initialItemNames.Count; k++)
                    {
                        IRow row = sheet.CreateRow(++d);
                        row.CreateCell(0).SetCellValue(Vals.initialProducts[i]);
                        row.CreateCell(1).SetCellValue(0);
                        row.CreateCell(2).SetCellValue(Vals.initialTypes[j]);
                        row.CreateCell(3).SetCellValue(0);
                        row.CreateCell(4).SetCellValue(Vals.initialItemNames[k]);
                        row.CreateCell(5).SetCellValue(0);
                        int _dataTypeNum;
                        if (Vals.initialTypes[j] == Vals.initialTypes[0]) _dataTypeNum = 0;
                        else if (Vals.initialTypes[j] == Vals.initialTypes[1]) _dataTypeNum = 1;
                        else if (Vals.initialTypes[j] == Vals.initialTypes[2]) _dataTypeNum = 1;
                        else if (Vals.initialTypes[j] == Vals.initialTypes[3]) _dataTypeNum = 2;
                        else if (Vals.initialTypes[j] == Vals.initialTypes[4]) _dataTypeNum = 2;
                        else _dataTypeNum = 3;
                        row.CreateCell(6).SetCellValue(_dataTypeNum);
                    }
                }
            }

            using var fs = new FileStream(_path, FileMode.Create, FileAccess.Write);    // ワークブックをファイルに保存
            workbook.Write(fs);
            workbook.Close();
        }

        /// &lt;summary&gt;
        /// 初期の大分類ファイルに対応したデータリスト設定ファイルを作成する。
        /// &lt;/summary&gt;
        /// &lt;param name="folderPath"&gt;データリストの保存フォルダ&lt;/param&gt;
        /// &lt;param name="filePath"&gt;データリストの設定ファイルパス&lt;/param&gt;
        private static void MakeInitialDataGridInfo(string folderPath, string filePath)
        {
            using FileStream fs = new(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(fs);
            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得

            for (int i = 1; i &lt;= sheet.LastRowNum; i++) // 2行目以降を処理
            {
                IRow row = sheet.GetRow(i);
                var product = row.GetCell(0).StringCellValue;
                var type = row.GetCell(2).StringCellValue;
                var itemName = row.GetCell(4).StringCellValue;
                string outFilePath = folderPath + "\\" + product + "_" + type + "_" + itemName + ".xlsx";
                MakeInitialDataGridFile(outFilePath);
            }
            workbook.Close();
        }

        /// &lt;summary&gt;
        /// 初期の設定ファイル(ヘッダー情報だけのファイル)を作成する
        /// &lt;/summary&gt;
        /// &lt;param name="_path"&gt;作成する設定ファイルのパス&lt;/param&gt;
        private static void MakeInitialDataGridFile(string _path)
        {
            XSSFWorkbook workbook = new();
            ISheet sheet = workbook.CreateSheet("DataGrid");

            // ヘッダー行を作成
            IRow headerRow = sheet.CreateRow(0);
            int i = 0;
            foreach (var header in Vals.dataGridHeaders)
            {
                headerRow.CreateCell(i).SetCellValue(header);
                i++;
            }

            // ワークブックをファイルに保存
            using var fs = new FileStream(_path, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }

        /// &lt;summary&gt;
        /// 大分類の設定ファイルを読み込む(Excelファイル)
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;
        /// &lt;returns&gt;大分類のリスト(ディクショナリ)&lt;/returns&gt;
        private static Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt; LoadMajorCategory(string filePath)
        {
            var result = new Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt;();

            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                XSSFWorkbook workbook = new(file);
                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
                for (int i = 1; i &lt;= sheet.LastRowNum; i++) // 2行目以降を処理
                {
                    IRow row = sheet.GetRow(i);
                    var product = new ItemModel { Name = row.GetCell(0).StringCellValue, IsDeletable = row.GetCell(1).NumericCellValue != 0 };
                    var type = new ItemModel { Name = row.GetCell(2).StringCellValue, IsDeletable = row.GetCell(3).NumericCellValue != 0, DataTypeNum = (int)row.GetCell(6).NumericCellValue };
                    var itemName = new ItemModel { Name = row.GetCell(4).StringCellValue, IsDeletable = row.GetCell(5).NumericCellValue != 0 };
                    if (!result.ContainsKey(product)) result[product] = [];
                    if (!result[product].ContainsKey(type)) result[product][type] = [];
                    if (!result[product][type].Contains(itemName)) result[product][type].Add(itemName);
                }
                workbook.Close();
            }
            return result;
        }

        /// &lt;summary&gt;
        /// Filterの表示テキストを更新する
        /// &lt;/summary&gt;
        private void UpdateFilterText()
        {
            FilterValue = ListFilters[SelectedFilterHeader];
        }

        /// &lt;summary&gt;
        /// 選択されたDataItemの情報を表示
        /// &lt;/summary&gt;
        /// &lt;param name="value"&gt;DataGridで選択されたDataItem&lt;/param&gt;
        private void UpdateDataItemInfo(DataItem value)
        {
            if (value != null)
            {
                DataItemInfo = "DataName:" + value.DataName + "\n"
                                    + "Remark:" + value.Remark + "\n"
                                    + "Product:" + value.Product + " Type:" + value.Type + " ItemName:" + value.ItemName + "\n"
                                    + "Ver:" + value.Ver + ", LotSlot:" + value.LotSlot + "\n"
                                    + "Program:" + value.Program + "\n"
                                    + "Date:" + value.Date + " Owner:" + value.Owner;
            }
            else DataItemInfo = string.Empty;
        }

        /// &lt;summary&gt;
        /// Productを追加するメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="value"&gt;newProductのテキスト&lt;/param&gt;
        private void AddProductToFile(string value)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            for (int j = 0; j &lt; Vals.initialTypes.Count; j++)
            {
                for (int k = 0; k &lt; Vals.initialItemNames.Count; k++)
                {
                    IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
                    row.CreateCell(0).SetCellValue(value);
                    row.CreateCell(1).SetCellValue(1);  //追加のproductは編集可能に
                    row.CreateCell(2).SetCellValue(Vals.initialTypes[j]);
                    row.CreateCell(3).SetCellValue(0);
                    row.CreateCell(4).SetCellValue(Vals.initialItemNames[k]);
                    row.CreateCell(5).SetCellValue(0);
                    int _dataTypeNum;
                    if (Vals.initialTypes[j] == Vals.initialTypes[0]) _dataTypeNum = 0;
                    else if (Vals.initialTypes[j] == Vals.initialTypes[1]) _dataTypeNum = 1;
                    else if (Vals.initialTypes[j] == Vals.initialTypes[2]) _dataTypeNum = 1;
                    else if (Vals.initialTypes[j] == Vals.initialTypes[3]) _dataTypeNum = 2;
                    else if (Vals.initialTypes[j] == Vals.initialTypes[4]) _dataTypeNum = 2;
                    else _dataTypeNum = 3;
                    row.CreateCell(6).SetCellValue(_dataTypeNum);
                    string outFilePath = folderPath + "\\" + value + "_" + Vals.initialTypes[j] + "_" + Vals.initialItemNames[k] + ".xlsx";
                    MakeInitialDataGridFile(outFilePath);
                }
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            var newProduct = new ItemModel { Name = value, IsDeletable = true };
            SelectedProduct = newProduct;
        }

        /// &lt;summary&gt;
        /// Productをコピーするメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="baseValue"&gt;コピー元の名前&lt;/param&gt;
        /// &lt;param name="newValue"&gt;コピー先の名前&lt;/param&gt;
        private void CopyProductToFile(string baseValue, string newValue)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;

            List&lt;MajorModel&gt; copyMajorModel = [];
            for (int i = 0; i &lt;= lastRowNum; i++)
            {
                IRow row = sheet.GetRow(i);
                if (row.GetCell(0).StringCellValue == baseValue)
                {
                    var match = new MajorModel { 
                        Product = newValue,
                        ProductDeletableNum = 1,
                        Type = row.GetCell(2).StringCellValue,
                        TypeDeletableNum = (int)row.GetCell(3).NumericCellValue,
                        ItemName = row.GetCell(4).StringCellValue,
                        ItemNameDeletableNum = (int)row.GetCell(5).NumericCellValue,
                        DataTypeNum = (int)row.GetCell(6).NumericCellValue
                    };
                    copyMajorModel.Add(match);
                }
            }

            foreach (var item in copyMajorModel)
            {
                IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
                row.CreateCell(0).SetCellValue(item.Product);
                row.CreateCell(1).SetCellValue(item.ProductDeletableNum);
                row.CreateCell(2).SetCellValue(item.Type);
                row.CreateCell(3).SetCellValue(item.TypeDeletableNum);
                row.CreateCell(4).SetCellValue(item.ItemName);
                row.CreateCell(5).SetCellValue(item.ItemNameDeletableNum);
                row.CreateCell(6).SetCellValue(item.DataTypeNum);
                string outFilePath = folderPath + "\\" + item.Product + "_" + item.Type + "_" + item.ItemName + ".xlsx";
                MakeInitialDataGridFile(outFilePath);
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            var newProduct = new ItemModel { Name = newValue, IsDeletable = true };
            SelectedProduct = newProduct;
        }

        /// &lt;summary&gt;
        /// Productをリネームするメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="baseValue"&gt;元の名前&lt;/param&gt;
        /// &lt;param name="newValue"&gt;変更後の名前&lt;/param&gt;
        private void RenameProductToFile(string baseValue, string newValue)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            for (int i = 0; i &lt;= lastRowNum; i++)
            {
                IRow row = sheet.GetRow(i);
                if (row.GetCell(0).StringCellValue == baseValue)
                {
                    row.GetCell(0).SetCellValue(newValue);
                    string sourceFilePath = folderPath + "\\" + baseValue + "_" + row.GetCell(2).StringCellValue + "_" + row.GetCell(4).StringCellValue + ".xlsx";
                    string destinationFilePath = folderPath + "\\" + newValue + "_" + row.GetCell(2).StringCellValue + "_" + row.GetCell(4).StringCellValue + ".xlsx";
                    File.Move(sourceFilePath, destinationFilePath);

                    XSSFWorkbook wbDataGrid;
                    using (FileStream file = new(destinationFilePath, FileMode.Open, FileAccess.Read))
                    {
                        wbDataGrid = new XSSFWorkbook(file);
                    }
                    ISheet shDataGrid = wbDataGrid.GetSheetAt(0);
                    int lastRowNumDataGrid = shDataGrid.LastRowNum;
                    IRow rowDataGrid = shDataGrid.GetRow(0);
                    int col = 0;
                    for (int k = 0; k &lt; rowDataGrid.LastCellNum; k++)
                    {
                        if (rowDataGrid.GetCell(k).StringCellValue == "Product") col = k;
                    }

                    for (int j = 1; j &lt;= lastRowNumDataGrid; j++)
                    {
                        if (rowDataGrid.GetCell(col).StringCellValue == baseValue) rowDataGrid.GetCell(col).SetCellValue(newValue);
                    }

                    using (FileStream fileOut = new(destinationFilePath, FileMode.Create, FileAccess.Write))
                    {
                        wbDataGrid.Write(fileOut); // ファイルに書き込み
                    }
                    wbDataGrid.Close();
                }
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            var newProduct = new ItemModel { Name = newValue, IsDeletable = true };
            SelectedProduct = newProduct;
        }

        /// &lt;summary&gt;
        /// Typeを追加するメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="value"&gt;newTypeのテキスト&lt;/param&gt;
        private void AddTypeToFile(ItemModel value)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedIndex = SelectedProductIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            for (int k = 0; k &lt; Vals.initialItemNames.Count; k++)
            {
                IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
                row.CreateCell(0).SetCellValue(SelectedProduct.Name);
                row.CreateCell(1).SetCellValue(SelectedProduct.IsDeletable ? 1 : 0);
                row.CreateCell(2).SetCellValue(value.Name);
                row.CreateCell(3).SetCellValue(1);  //追加のTypeは編集可能に
                row.CreateCell(4).SetCellValue(Vals.initialItemNames[k]);
                row.CreateCell(5).SetCellValue(0);
                row.CreateCell(6).SetCellValue(value.DataTypeNum);
                string outFilePath = folderPath + "\\" + SelectedProduct.Name + "_" + value.Name + "_" + Vals.initialItemNames[k] + ".xlsx";
                MakeInitialDataGridFile(outFilePath);
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = _selectedIndex;
            //var newType = new ItemModel { Name = value.Name, IsDeletable = value.IsDeletable, DataTypeNum = value.DataTypeNum };
            //SelectedType = newType;
            SelectedType = Types.FirstOrDefault(item =&gt; item == value) ?? null!;               //処理的にnullにならないはず。警告対策。
        }

        /// &lt;summary&gt;
        /// Typeをコピーするメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="baseValue"&gt;コピー元の名前&lt;/param&gt;
        /// &lt;param name="newValue"&gt;コピー先の名前&lt;/param&gt;
        private void CopyTypeToFile(string baseValue, string newValue)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedIndex = SelectedProductIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;

            List&lt;MajorModel&gt; copyMajorModel = [];
            for (int i = 0; i &lt;= lastRowNum; i++)
            {
                IRow row = sheet.GetRow(i);
                if (row.GetCell(2).StringCellValue == baseValue)
                {
                    var match = new MajorModel
                    {
                        Product = row.GetCell(0).StringCellValue,
                        ProductDeletableNum = (int)row.GetCell(1).NumericCellValue,
                        Type = newValue,
                        TypeDeletableNum = 1,
                        ItemName = row.GetCell(4).StringCellValue,
                        ItemNameDeletableNum = (int)row.GetCell(5).NumericCellValue,
                        DataTypeNum = (int)row.GetCell(6).NumericCellValue
                    };
                    copyMajorModel.Add(match);
                }
            }

            foreach (var item in copyMajorModel)
            {
                IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
                row.CreateCell(0).SetCellValue(item.Product);
                row.CreateCell(1).SetCellValue(item.ProductDeletableNum);
                row.CreateCell(2).SetCellValue(item.Type);
                row.CreateCell(3).SetCellValue(item.TypeDeletableNum);
                row.CreateCell(4).SetCellValue(item.ItemName);
                row.CreateCell(5).SetCellValue(item.ItemNameDeletableNum);
                row.CreateCell(6).SetCellValue(item.DataTypeNum);
                string outFilePath = folderPath + "\\" + item.Product + "_" + item.Type + "_" + item.ItemName + ".xlsx";
                MakeInitialDataGridFile(outFilePath);
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = _selectedIndex;
            SelectedType = Types.FirstOrDefault(item =&gt; item.Name == newValue) ?? null!;               //処理的にnullにならないはず。警告対策。
        }

        /// &lt;summary&gt;
        /// Typeをリネームするメソッド(データタイプも変えられる)
        /// &lt;/summary&gt;
        /// &lt;param name="baseValue"&gt;元の名前&lt;/param&gt;
        /// &lt;param name="newValue"&gt;変更後のType(ItemModel)&lt;/param&gt;
        private void RenameTypeToFile(string baseValue, ItemModel newValue)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedIndex = SelectedProductIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            for (int i = 0; i &lt;= lastRowNum; i++)
            {
                IRow row = sheet.GetRow(i);
                if (row.GetCell(2).StringCellValue == baseValue)
                {
                    row.GetCell(2).SetCellValue(newValue.Name);
                    row.GetCell(6).SetCellValue(newValue.DataTypeNum);
                    string sourceFilePath = folderPath + "\\" + row.GetCell(0).StringCellValue + "_" + baseValue + "_" + row.GetCell(4).StringCellValue + ".xlsx";
                    string destinationFilePath = folderPath + "\\" + row.GetCell(0).StringCellValue + "_" + newValue.Name + "_" + row.GetCell(4).StringCellValue + ".xlsx";
                    File.Move(sourceFilePath, destinationFilePath);

                    XSSFWorkbook wbDataGrid;
                    using (FileStream file = new(destinationFilePath, FileMode.Open, FileAccess.Read))
                    {
                        wbDataGrid = new XSSFWorkbook(file);
                    }
                    ISheet shDataGrid = wbDataGrid.GetSheetAt(0);
                    int lastRowNumDataGrid = shDataGrid.LastRowNum;
                    IRow rowDataGrid = shDataGrid.GetRow(0);
                    int col = 0;
                    for (int k = 0; k &lt; rowDataGrid.LastCellNum; k++)
                    {
                        if (rowDataGrid.GetCell(k).StringCellValue == "Type") col = k;
                    }

                    for (int j = 1; j &lt;= lastRowNumDataGrid; j++)
                    {
                        if (rowDataGrid.GetCell(col).StringCellValue == baseValue) rowDataGrid.GetCell(col).SetCellValue(newValue.Name);
                    }

                    using (FileStream fileOut = new(destinationFilePath, FileMode.Create, FileAccess.Write))
                    {
                        wbDataGrid.Write(fileOut); // ファイルに書き込み
                    }
                    wbDataGrid.Close();
                }
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = _selectedIndex;
            SelectedType = Types.FirstOrDefault(item =&gt; item == newValue) ?? null!;               //処理的にnullにならないはず。警告対策。
        }

        /// &lt;summary&gt;
        /// ItemNameを追加するメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="value"&gt;newItemNameのテキスト&lt;/param&gt;
        private void AddItemNameToFile(string value)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedProductIndex = SelectedProductIndex;
            int _selectedTypeIndex = SelectedTypeIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
            row.CreateCell(0).SetCellValue(SelectedProduct.Name);
            row.CreateCell(1).SetCellValue(SelectedProduct.IsDeletable ? 1 : 0);
            row.CreateCell(2).SetCellValue(SelectedType.Name);
            row.CreateCell(3).SetCellValue(SelectedType.IsDeletable ? 1 : 0);
            row.CreateCell(4).SetCellValue(value);
            row.CreateCell(5).SetCellValue(1);  //追加のTypeは編集可能に
            row.CreateCell(6).SetCellValue(SelectedType.DataTypeNum);
            string outFilePath = folderPath + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + value + ".xlsx";
            MakeInitialDataGridFile(outFilePath);

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProductIndex = -1;
            SelectedProductIndex = _selectedProductIndex;
            SelectedTypeIndex = -1;
            SelectedTypeIndex = _selectedTypeIndex;
            var newItemName = new ItemModel { Name = value, IsDeletable = true };
            SelectedItemName = newItemName;
        }

        /// &lt;summary&gt;
        /// ItemNameをコピーするメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="baseValue"&gt;コピー元の名前&lt;/param&gt;
        /// &lt;param name="newValue"&gt;コピー先の名前&lt;/param&gt;
        private void CopyItemNameToFile(string baseValue, string newValue)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedProductIndex = SelectedProductIndex;
            int _selectedTypeIndex = SelectedTypeIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;

            List&lt;MajorModel&gt; copyMajorModel = [];
            for (int i = 0; i &lt;= lastRowNum; i++)
            {
                IRow row = sheet.GetRow(i);
                if (row.GetCell(4).StringCellValue == baseValue)
                {
                    var match = new MajorModel
                    {
                        Product = row.GetCell(0).StringCellValue,
                        ProductDeletableNum = (int)row.GetCell(1).NumericCellValue,
                        Type = row.GetCell(2).StringCellValue,
                        TypeDeletableNum = (int)row.GetCell(3).NumericCellValue,
                        ItemName = newValue,
                        ItemNameDeletableNum = 1,
                        DataTypeNum = (int)row.GetCell(6).NumericCellValue
                    };
                    copyMajorModel.Add(match);
                }
            }

            foreach (var item in copyMajorModel)
            {
                IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
                row.CreateCell(0).SetCellValue(item.Product);
                row.CreateCell(1).SetCellValue(item.ProductDeletableNum);
                row.CreateCell(2).SetCellValue(item.Type);
                row.CreateCell(3).SetCellValue(item.TypeDeletableNum);
                row.CreateCell(4).SetCellValue(item.ItemName);
                row.CreateCell(5).SetCellValue(item.ItemNameDeletableNum);
                row.CreateCell(6).SetCellValue(item.DataTypeNum);
                string outFilePath = folderPath + "\\" + item.Product + "_" + item.Type + "_" + item.ItemName + ".xlsx";
                MakeInitialDataGridFile(outFilePath);
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProductIndex = -1;
            SelectedProductIndex = _selectedProductIndex;
            SelectedTypeIndex = -1;
            SelectedTypeIndex = _selectedTypeIndex;
            var newItemName = new ItemModel { Name = newValue, IsDeletable = true };
            SelectedItemName = newItemName;
        }

        /// &lt;summary&gt;
        /// ItemNameをリネームするメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="baseValue"&gt;元の名前&lt;/param&gt;
        /// &lt;param name="newValue"&gt;変更後の名前&lt;/param&gt;
        private void RenameItemNameToFile(string baseValue, string newValue)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedProductIndex = SelectedProductIndex;
            int _selectedTypeIndex = SelectedTypeIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            for (int i = 0; i &lt;= lastRowNum; i++)
            {
                IRow row = sheet.GetRow(i);
                if (row.GetCell(4).StringCellValue == baseValue)
                {
                    row.GetCell(4).SetCellValue(newValue);
                    string sourceFilePath = folderPath + "\\" + row.GetCell(0).StringCellValue + "_" + row.GetCell(2).StringCellValue + "_" + baseValue + ".xlsx";
                    string destinationFilePath = folderPath + "\\" + row.GetCell(0).StringCellValue + "_" + row.GetCell(2).StringCellValue + "_" + newValue + ".xlsx";
                    File.Move(sourceFilePath, destinationFilePath);

                    XSSFWorkbook wbDataGrid;
                    using (FileStream file = new(destinationFilePath, FileMode.Open, FileAccess.Read))
                    {
                        wbDataGrid = new XSSFWorkbook(file);
                    }
                    ISheet shDataGrid = wbDataGrid.GetSheetAt(0);
                    int lastRowNumDataGrid = shDataGrid.LastRowNum;
                    IRow rowDataGrid = shDataGrid.GetRow(0);
                    int col = 0;
                    for (int k = 0; k &lt; rowDataGrid.LastCellNum; k++)
                    {
                        if (rowDataGrid.GetCell(k).StringCellValue == "ItemName") col = k;
                    }

                    for (int j = 1; j &lt;= lastRowNumDataGrid; j++)
                    {
                        if (rowDataGrid.GetCell(col).StringCellValue == baseValue) rowDataGrid.GetCell(col).SetCellValue(newValue);
                    }

                    using (FileStream fileOut = new(destinationFilePath, FileMode.Create, FileAccess.Write))
                    {
                        wbDataGrid.Write(fileOut); // ファイルに書き込み
                    }
                    wbDataGrid.Close();
                }
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProductIndex = -1;
            SelectedProductIndex = _selectedProductIndex;
            SelectedTypeIndex = -1;
            SelectedTypeIndex = _selectedTypeIndex;
            var newItemName = new ItemModel { Name = newValue, IsDeletable = true };
            SelectedItemName = newItemName;
        }

        /// &lt;summary&gt;
        /// dataItemを設定する(エクセル行入力版)
        /// &lt;/summary&gt;
        /// &lt;param name="row"&gt;エクセルの行データ&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private static DataItem SetDataItem(IRow row)
        {
            int col = 0;
            return new DataItem
            {
                No = (int)row.GetCell(col).NumericCellValue,
                DataName = row.GetCell(++col).StringCellValue,
                Link = row.GetCell(++col).StringCellValue,
                Product = row.GetCell(++col).StringCellValue,
                Type = row.GetCell(++col).StringCellValue,
                ItemName = row.GetCell(++col).StringCellValue,
                Ver = row.GetCell(++col).StringCellValue,
                Lot = row.GetCell(++col).StringCellValue,
                Slot = row.GetCell(++col).StringCellValue,
                LotSlot = row.GetCell(++col).StringCellValue,
                Program = row.GetCell(++col).StringCellValue,
                Date = row.GetCell(++col).StringCellValue,
                Owner = row.GetCell(++col).StringCellValue,
                Remark = row.GetCell(++col).StringCellValue
            };
        }

        /// &lt;summary&gt;
        /// dataItemを設定する(DataItem入力版)
        /// &lt;/summary&gt;
        /// &lt;param name="item"&gt;DataItem&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private static DataItem SetDataItem(DataItem item)
        {
            return new DataItem
            {
                No = item.No,
                DataName = item.DataName,
                Link = item.Link,
                Product = item.Product,
                Type = item.Type,
                ItemName = item.ItemName,
                Ver = item.Ver,
                Lot = item.Lot,
                Slot = item.Slot,
                LotSlot = item.LotSlot,
                Program = item.Program,
                Date = item.Date,
                Owner = item.Owner,
                Remark = item.Remark
            };
        }

        /// &lt;summary&gt;
        /// フィルタの情報をクリア
        /// &lt;/summary&gt;
        private void ClearFilterDictionary()
        {
            IsFiltering = false;    //フィルタリング状態の変数をオフにする
            isHolding = true;       //FilterValueの変更メソッドが走らないようにする変数
            foreach (var headerFilter in ListFilters)
            {
                ListFilters[headerFilter.Key] = "";
            }
            FilterValue = string.Empty;
            isHolding = false;
        }

        /// &lt;summary&gt;
        /// データリストをロードする(DataItems==DataGridの更新)
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;データリストの設定ファイルのパス&lt;/param&gt;
        private void LoadDataList(string filePath)
        {
            IsFiltering = false;    //データをロードし直した場合、フィルタリングをオフする
            //TargetDataItems.Clear();    //抽出のListBoxをクリア(複数の分類から登録できるようにするためマスク)
            using var fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(fs);
            ISheet sheet = workbook.GetSheetAt(0);

            // データ行を取得
            DataItems.Clear();
            for (int i = 1; i &lt;= sheet.LastRowNum; i++)
            {
                var row = sheet.GetRow(i);
                if (row == null) continue;
                var dataItem = SetDataItem(row);
                DataItems.Add(dataItem);
            }
            workbook.Close();

            //TargetDataItemsに含まれる場合は選択状態にする
            foreach (var item in TargetDataItems)
            {
                var matchItem = DataItems.FirstOrDefault(f =&gt;
                    f.LotSlot == item.LotSlot &&
                    f.DataName == item.DataName &&
                    f.Product == item.Product &&
                    f.Type == item.Type &&
                    f.ItemName == item.ItemName &&
                    f.Ver == item.Ver);
                if (matchItem != null) matchItem.IsRegistered = true;  // IsRegistered を true に設定
            }
        }

        /// &lt;summary&gt;
        /// 大分類をチェックし、新規であれば追加
        /// &lt;/summary&gt;
        /// &lt;param name="_product"&gt;品種名&lt;/param&gt;
        /// &lt;param name="_type"&gt;種類&lt;/param&gt;
        /// &lt;param name="_itemName"&gt;項目名&lt;/param&gt;
        private void CheckMajorCategory(string _product, string _type, string _itemName)
        {
            //SelectedProduct = null!;
            if (!Products.Any(item =&gt; item.Name == _product)) AddProductToFile(_product);
            SelectedProduct = Products.FirstOrDefault(item =&gt; item.Name == _product) ?? null!;      //処理的にnullにならないはず。警告対策。
            //SelectedType = null!;
            if (!Types.Any(item =&gt; item.Name == _type))
            {
                var editMajorViewModel = new EditMajorViewModel("Typeのデータタイプ選択", "追加する名前", _type, false, "---", "---", true, 0);
                var editMajorWindow = new EditMajorWindow(editMajorViewModel)
                {
                    Owner = System.Windows.Application.Current.MainWindow,
                    Left = System.Windows.Application.Current.MainWindow.Left + DISPLAY_OFFSET_H,
                    Top = System.Windows.Application.Current.MainWindow.Top + DISPLAY_OFFSET_V
                };
                if (editMajorWindow.ShowDialog() == true)
                {
                    var newType = new ItemModel { Name = editMajorViewModel.TargetValue, IsDeletable = true, DataTypeNum = editMajorViewModel.DataTypeNum };
                    AddTypeToFile(newType);
                    NewTypeText = string.Empty;
                }
            }
            SelectedType = Types.FirstOrDefault(item =&gt; item.Name == _type) ?? null!;               //処理的にnullにならないはず。警告対策。
            //SelectedItemName = null!;
            if (!ItemNames.Any(item =&gt; item.Name == _itemName)) AddItemNameToFile(_itemName);
            SelectedItemName = ItemNames.FirstOrDefault(item =&gt; item.Name == _itemName) ?? null!;   //処理的にnullにならないはず。警告対策。
        }

        /// &lt;summary&gt;
        /// データリストの設定ファイルを更新する
        /// &lt;/summary&gt;
        /// &lt;param name="newDataItems"&gt;追加するdataItemのリスト&lt;/param&gt;
        /// &lt;param name="_product"&gt;品種名&lt;/param&gt;
        /// &lt;param name="_type"&gt;種類&lt;/param&gt;
        /// &lt;param name="_itemName"&gt;項目名&lt;/param&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        private async Task UpdateDataList(List&lt;DataItem&gt; newDataItems, string _product, string _type, string _itemName, bool isLastItem)
        {
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            string filePath;
            if (SelectedItemName.Name == "all") filePath = folderPath + "\\" + _product + "_" + _type + "_" + "-" + ".xlsx";
            else filePath = folderPath + "\\" + _product + "_" + _type + "_" + _itemName + ".xlsx";

            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                await WriteDataList(filePath, newDataItems);
                //DataItems.Clear();
                if (SelectedItemName.Name != "all" && isLastItem) LoadDataList(filePath); //DataGrid更新
                filePath = folderPath + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + "all" + ".xlsx";
                await WriteDataList(filePath, newDataItems);
                if (SelectedItemName.Name == "all" && isLastItem) LoadDataList(filePath); //DataGrid更新
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }
        }

        /// &lt;summary&gt;
        /// データリストの設定ファイルに書き込み
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;設定ファイルのパス&lt;/param&gt;
        /// &lt;param name="newDataItems"&gt;追加するdataItemのリスト&lt;/param&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        private static async Task WriteDataList(string filePath, List&lt;DataItem&gt; newDataItems)
        {
            await Task.Run(() =&gt;
            {
                XSSFWorkbook workbook;
                using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(file);
                }
                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得

                int j = sheet.LastRowNum;
                foreach (var item in newDataItems)
                {
                    IRow row = sheet.CreateRow(++j);
                    IRow prerow = sheet.GetRow(j - 1);
                    int k = 0;
                    if (j &gt; 1) row.CreateCell(k).SetCellValue((int)prerow.GetCell(0).NumericCellValue + 1);
                    else row.CreateCell(k).SetCellValue(1);
                    row.CreateCell(++k).SetCellValue(item.DataName);
                    row.CreateCell(++k).SetCellValue(item.Link);
                    row.CreateCell(++k).SetCellValue(item.Product);
                    row.CreateCell(++k).SetCellValue(item.Type);
                    row.CreateCell(++k).SetCellValue(item.ItemName != "all" ? item.ItemName : "-");
                    row.CreateCell(++k).SetCellValue(item.Ver);
                    row.CreateCell(++k).SetCellValue(item.Lot);
                    row.CreateCell(++k).SetCellValue(item.Slot);
                    row.CreateCell(++k).SetCellValue(item.LotSlot);
                    row.CreateCell(++k).SetCellValue(item.Program);
                    row.CreateCell(++k).SetCellValue(item.Date);
                    row.CreateCell(++k).SetCellValue(item.Owner);
                    row.CreateCell(++k).SetCellValue(item.Remark);
                }

                using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
                {
                    workbook.Write(fileOut); // ファイルに書き込み
                }
                workbook.Close();
            });
        }

        /// &lt;summary&gt;
        /// 設定ファイルの内容を読み込む
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;設定ファイルのパス&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private static List&lt;DataItem&gt; LoadDataItems(string filePath)
        {
            using var fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(fs);
            ISheet sheet = workbook.GetSheetAt(0);

            // データ行を取得
            List&lt;DataItem&gt; Items = [];
            for (int i = 1; i &lt;= sheet.LastRowNum; i++)
            {
                var row = sheet.GetRow(i);
                if (row == null) continue;
                var dataItem = SetDataItem(row);
                Items.Add(dataItem);
            }
            workbook.Close();
            return Items;
        }

        /// &lt;summary&gt;
        /// エクセルファイルにDataItemのデータを書き込む
        /// &lt;/summary&gt;
        /// &lt;param name="row"&gt;エクセルの行データ&lt;/param&gt;
        /// &lt;param name="rowcnt"&gt;行番号&lt;/param&gt;
        /// &lt;param name="item"&gt;設定するDataItem&lt;/param&gt;
        private static void SetDataItemToExcel(IRow row, int rowcnt, DataItem item)
        {
            int col = 0;
            row.CreateCell(col).SetCellValue(rowcnt);
            row.CreateCell(++col).SetCellValue(item.DataName);
            row.CreateCell(++col).SetCellValue(item.Link);
            row.CreateCell(++col).SetCellValue(item.Product);
            row.CreateCell(++col).SetCellValue(item.Type);
            row.CreateCell(++col).SetCellValue(item.Ver);
            row.CreateCell(++col).SetCellValue(item.ItemName);
            row.CreateCell(++col).SetCellValue(item.Lot);
            row.CreateCell(++col).SetCellValue(item.Slot);
            row.CreateCell(++col).SetCellValue(item.LotSlot);
            row.CreateCell(++col).SetCellValue(item.Program);
            row.CreateCell(++col).SetCellValue(item.Date);
            row.CreateCell(++col).SetCellValue(item.Owner);
            row.CreateCell(++col).SetCellValue(item.Remark);
        }

        /// &lt;summary&gt;
        /// データアイテムが同じものかチェックする
        /// &lt;/summary&gt;
        /// &lt;param name="item"&gt;DataItem&lt;/param&gt;
        /// &lt;param name="deleteItems"&gt;削除対象のDataItemのリスト&lt;/param&gt;
        /// &lt;returns&gt;データアイテムが同じものであればtrueを返す&lt;/returns&gt;
        private static bool MatchDataItem(DataItem item, List&lt;DataItem&gt; deleteItems)
        {
            bool isMatch = false;

            foreach (DataItem deleteItem in deleteItems)
            {
                if (item.DataName == deleteItem.DataName && item.Link == deleteItem.Link && item.ItemName == deleteItem.ItemName)
                {
                    isMatch = true;
                    break;
                }
            }
            return isMatch;
        }
        #endregion
    }
}
            </code></pre>

            <p>
                MainViewModel.ServerCheck.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using NPOI.SS.UserModel;
using NPOI.XSSF.UserModel;
using System.Collections.ObjectModel;
using System.IO;
using System.Windows;
using System.Windows.Input;

namespace DataManager
{
    public partial class MainViewModel : ObservableObject
    {
        #region "変数定義"
        private const int KEYWORDS_COL = 10;
        private const int EXTENSIONS_COL = 11;

        [ObservableProperty]
        private string researchFolder = string.Empty;
        partial void OnResearchFolderChanged(string value) =&gt; ResearchStartCommand.NotifyCanExecuteChanged();

        [ObservableProperty]
        private string resultFolder = string.Empty;

        [ObservableProperty]
        private string resultFileName = string.Empty;

        [ObservableProperty]
        private ObservableCollection&lt;ResearchHistory&gt; researchHistoryLists = [];

        [ObservableProperty]
        private ResearchGroupingTypes selectedResearchGroupingType = ResearchGroupingTypes.TopFolders;

        [ObservableProperty]
        private string researchNewKeyWord = string.Empty;
        partial void OnResearchNewKeyWordChanged(string value) =&gt; AddResearchGroupingKeyWordCommand.NotifyCanExecuteChanged();

        [ObservableProperty]
        private UniqueObservableCollection&lt;string&gt; groupingKeyWords = [];

        [ObservableProperty]
        private string selectedGroupingKeyWord = null!;

        [ObservableProperty]
        private int selectedGroupingKeyWordIndex;

        [ObservableProperty]
        private ResearchFileTypes selectedResearchFileType = ResearchFileTypes.None;

        [ObservableProperty]
        private string researchNewExtension = string.Empty;
        partial void OnResearchNewExtensionChanged(string value) =&gt; AddResearchFileExtensionCommand.NotifyCanExecuteChanged();

        [ObservableProperty]
        private UniqueObservableCollection&lt;string&gt; researchExtensions = [];

        [ObservableProperty]
        private string selectedResearchExtension = null!;

        [ObservableProperty]
        private int selectedResearchExtensionIndex;

        [ObservableProperty]
        private bool isSizeLimited;

        [ObservableProperty]
        private string limitedSizeValue = string.Empty;

        [ObservableProperty]
        private ObservableCollection&lt;string&gt; researchResults = [];

        [ObservableProperty]
        private ObservableCollection&lt;string&gt; researchNormalResults = [];

        [ObservableProperty]
        private string selectedResearchResult = string.Empty;
        partial void OnSelectedResearchResultChanged(string value)
        {
            if (File.Exists(ResultFolder + "\\" + value))
            {
                XSSFWorkbook workbook;
                using (FileStream fs = new(ResultFolder + "\\" + value, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(fs);
                }
                
                researchResultFiles = [];   //調査結果ファイルから読み出して格納
                ResearchGroups = [];    //ComboBox
                for (int i = 1; i &lt; workbook.NumberOfSheets; i++)
                {   // i = 0は"summary"のため除外
                    ISheet sheet = workbook.GetSheetAt(i);
                    IRow titleRow = sheet.GetRow(0);
                    string _group = titleRow.GetCell(1).StringCellValue;
                    ResearchGroups.Add(_group);
                    researchResultFiles[_group] = [];
                    int lastRowNum = sheet.LastRowNum;
                    for (int j = 2; j &lt;= lastRowNum; j++)
                    {
                        IRow row = sheet.GetRow(j);
                        int col = 0;
                        ResearchFileInfo fileInformation = new()
                        {
                            No = (int)row.GetCell(col).NumericCellValue,
                            FolderName = row.GetCell(++col).StringCellValue,
                            FileName = row.GetCell(++col).StringCellValue,
                            Size = row.GetCell(++col).NumericCellValue,
                            LastModified = row.GetCell(++col).StringCellValue,
                            CreatedDate = row.GetCell(++col).StringCellValue,
                            Group = row.GetCell(++col).StringCellValue
                        };

                        researchResultFiles[_group].Add(fileInformation);
                    }
                }
                if (ResearchGroups.Count &gt; 0) SelectedResearchGroup = ResearchGroups[0];
                workbook.Close();
            }
        }

        [ObservableProperty]
        private ObservableCollection&lt;string&gt; researchGroups = [];

        [ObservableProperty]
        private string selectedResearchGroup = string.Empty;
        partial void OnSelectedResearchGroupChanged(string value)
        {
            try
            {   // マウスカーソルを砂時計に変更
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;
                DisplayResearchResultFiles = [];
                if (!String.IsNullOrEmpty(value))
                {
                    foreach (var item in researchResultFiles[value]) DisplayResearchResultFiles.Add(item);
                }
            }
            finally
            {   // 処理が完了したらマウスカーソルを元に戻す
                Mouse.OverrideCursor = null;    
            }
        }

        [ObservableProperty]
        [NotifyCanExecuteChangedFor(nameof(SelectResearchFolderCommand))]
        [NotifyCanExecuteChangedFor(nameof(SelectResearchResultFolderCommand))]
        [NotifyCanExecuteChangedFor(nameof(AddResearchGroupingKeyWordCommand))]
        [NotifyCanExecuteChangedFor(nameof(RemoveResearchGroupingKeyWordCommand))]
        [NotifyCanExecuteChangedFor(nameof(AddResearchFileExtensionCommand))]
        [NotifyCanExecuteChangedFor(nameof(RemoveResearchFileExtensionCommand))]
        [NotifyCanExecuteChangedFor(nameof(CheckDiffCommand))]
        [NotifyCanExecuteChangedFor(nameof(DeleteHistoryCommand))]
        private bool isFolderResearching;

        [ObservableProperty]
        private int folderResearchStatus;

        [ObservableProperty]
        private ObservableCollection&lt;ResearchFileInfo&gt; displayResearchResultFiles = [];

        private Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; researchResultFiles = [];

        [ObservableProperty]
        [NotifyCanExecuteChangedFor(nameof(SelectResearchFolderCommand))]
        [NotifyCanExecuteChangedFor(nameof(SelectResearchResultFolderCommand))]
        [NotifyCanExecuteChangedFor(nameof(ResearchStartCommand))]
        [NotifyCanExecuteChangedFor(nameof(AddResearchGroupingKeyWordCommand))]
        [NotifyCanExecuteChangedFor(nameof(RemoveResearchGroupingKeyWordCommand))]
        [NotifyCanExecuteChangedFor(nameof(AddResearchFileExtensionCommand))]
        [NotifyCanExecuteChangedFor(nameof(RemoveResearchFileExtensionCommand))]
        [NotifyCanExecuteChangedFor(nameof(DeleteHistoryCommand))]
        private bool isDiffChecking;

        [ObservableProperty]
        private int diffCheckStatus;

        [ObservableProperty]
        [NotifyCanExecuteChangedFor(nameof(SelectResearchFolderCommand))]
        [NotifyCanExecuteChangedFor(nameof(SelectResearchResultFolderCommand))]
        [NotifyCanExecuteChangedFor(nameof(ResearchStartCommand))]
        [NotifyCanExecuteChangedFor(nameof(AddResearchGroupingKeyWordCommand))]
        [NotifyCanExecuteChangedFor(nameof(RemoveResearchGroupingKeyWordCommand))]
        [NotifyCanExecuteChangedFor(nameof(AddResearchFileExtensionCommand))]
        [NotifyCanExecuteChangedFor(nameof(RemoveResearchFileExtensionCommand))]
        [NotifyCanExecuteChangedFor(nameof(CheckDiffCommand))]
        private bool isHistoryDeleting;

        [ObservableProperty]
        private int historyDeleteStatus;

        [ObservableProperty]
        private ResearchHistory selectedHistory = null!;
        partial void OnSelectedHistoryChanged(ResearchHistory value)
        {
            DeleteHistoryCommand.NotifyCanExecuteChanged();
            if (SelectedHistory == null) return;
            ResearchGroupingTypes[] researchGroupingTypes = (ResearchGroupingTypes[])Enum.GetValues(typeof(ResearchGroupingTypes));
            ResearchFileTypes[] researchFileTypes = (ResearchFileTypes[])Enum.GetValues(typeof(ResearchFileTypes));
            SelectedResearchGroupingType = researchGroupingTypes[SelectedHistory.ResearchGrouping];
            SelectedResearchFileType = researchFileTypes[SelectedHistory.ResearchDataType];
            IsSizeLimited = SelectedHistory.SizeLimited == 0 ? false : true;
            LimitedSizeValue = SelectedHistory.LimitedSizeValue;
            GroupingKeyWords = SelectedHistory.GroupingKeyWords;
            ResearchExtensions = SelectedHistory.ResearchExtensions;
            SelectedResearchResult = value.ResearchResultName;
        }

        [ObservableProperty]
        private string selectedFirstResult = null!;
        partial void OnSelectedFirstResultChanged(string value) =&gt;  CheckDiffCommand.NotifyCanExecuteChanged();

        [ObservableProperty]
        private string selectedSecondResult = null!;
        partial void OnSelectedSecondResultChanged(string value) =&gt; CheckDiffCommand.NotifyCanExecuteChanged();

        [ObservableProperty]
        private double researchProgress;
        #endregion

        #region "コマンド定義"
        /// &lt;summary&gt;
        /// 調査対象のフォルダを選択する
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanSelectResearchFolder))]
        private void SelectResearchFolder()
        {
            using var dialog = new FolderBrowserDialog();
            if (dialog.ShowDialog() == DialogResult.OK)
            {
                ResearchFolder = dialog.SelectedPath;
            }
        }
        private bool CanSelectResearchFolder()
        {
            return !IsFolderResearching && !IsDiffChecking && !IsHistoryDeleting;
        }

        /// &lt;summary&gt;
        /// 結果フォルダの指定をするコマンド
        /// 結果フォルダ内にある調査履歴のファイルも参照し、2つのListView、2つのComboBoxも更新する(履歴のファイルが無い場合は新規作成)
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanResearchResultFolder))]
        private void SelectResearchResultFolder()
        {
            using var dialog = new FolderBrowserDialog();
            if (dialog.ShowDialog() == DialogResult.OK)
            {
                ResultFolder = dialog.SelectedPath;
                try
                {   // マウスカーソルを砂時計に変更
                    Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;
                    string historyFilePath = ResultFolder + "\\_history.xlsx";
                    SetResultHistory(historyFilePath);
                }
                finally
                {   // 処理が完了したらマウスカーソルを元に戻す
                    Mouse.OverrideCursor = null;
                }
            }
        }
        private bool CanResearchResultFolder()
        {
            return !IsFolderResearching && !IsDiffChecking && !IsHistoryDeleting;
        }

        /// &lt;summary&gt;
        /// 調査開始コマンド
        /// &lt;/summary&gt;
        /// &lt;returns&gt;非同期タスク&lt;/returns&gt;
        [RelayCommand(CanExecute = nameof(CanResearchStart))]
        private async Task ResearchStartAsync()
        {
            try
            {
                IsFolderResearching = true;
                FolderResearchStatus = -1;
                await ResearchFolderData();
            }
            finally
            {
                IsFolderResearching = false;
                FolderResearchStatus = 0;
            }
        }
        private bool CanResearchStart()
        {
            return !IsDiffChecking && !IsHistoryDeleting && Directory.Exists(ResearchFolder);
        }

        /// &lt;summary&gt;
        /// 履歴削除コマンド
        /// &lt;/summary&gt;
        /// &lt;returns&gt;非同期タスク&lt;/returns&gt;
        [RelayCommand(CanExecute = nameof(CanDeleteHistory))]
        private async Task DeleteHistoryAsync()
        {
            try
            {
                IsHistoryDeleting = true;
                HistoryDeleteStatus = -1;
                await DeleteSelectedHistory();
            }
            finally
            {
                IsHistoryDeleting = false;
                HistoryDeleteStatus = 0;
            }
        }
        private bool CanDeleteHistory()
        {
            return !IsFolderResearching && !IsDiffChecking && SelectedHistory != null;
        }

        /// &lt;summary&gt;
        /// 分類キーワードを追加するコマンド
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanAddResearchGroupingKeyWord))]
        private void AddResearchGroupingKeyWord()
        {
            if (!string.IsNullOrWhiteSpace(ResearchNewKeyWord))
            {
                GroupingKeyWords.Add(ResearchNewKeyWord);
                ResearchNewKeyWord = string.Empty;
            }
        }
        private bool CanAddResearchGroupingKeyWord()
        {
            return !string.IsNullOrWhiteSpace(ResearchNewKeyWord) && !IsFolderResearching && !IsDiffChecking && !IsHistoryDeleting;
        }

        /// &lt;summary&gt;
        /// 分類キーワードを削除するコマンド
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveResearchGroupingKeyWord))]
        private void RemoveResearchGroupingKeyWord()
        {
            if (SelectedGroupingKeyWord != null)
            {
                int _index = SelectedGroupingKeyWordIndex;
                GroupingKeyWords.Remove(SelectedGroupingKeyWord);
                SelectedGroupingKeyWord = null!;
                if (GroupingKeyWords.Count == 0) return;
                if (_index == 0) SelectedGroupingKeyWordIndex = 0;
                else SelectedGroupingKeyWordIndex = _index - 1;
            }
        }
        private bool CanRemoveResearchGroupingKeyWord()
        {
            return SelectedGroupingKeyWord != null && !IsFolderResearching && !IsDiffChecking && !IsHistoryDeleting;
        }

        /// &lt;summary&gt;
        /// 調査するファイルの拡張子を追加するコマンド
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanAddResearchFileExtension))]
        private void AddResearchFileExtension()
        {
            if (!string.IsNullOrWhiteSpace(ResearchNewExtension))
            {
                ResearchExtensions.Add(ResearchNewExtension);
                ResearchNewExtension = string.Empty;
            }
        }
        private bool CanAddResearchFileExtension()
        {
            return !string.IsNullOrWhiteSpace(ResearchNewExtension) && !IsFolderResearching && !IsDiffChecking && !IsHistoryDeleting;
        }

        /// &lt;summary&gt;
        /// 調査するファイルの拡張子を削除するコマンド
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveResearchFileExtension))]
        private void RemoveResearchFileExtension()
        {
            if (SelectedResearchExtension != null)
            {
                int _index = SelectedResearchExtensionIndex;
                ResearchExtensions.Remove(SelectedResearchExtension);
                SelectedResearchExtension = null!;
                if (ResearchExtensions.Count == 0) return;
                if (_index == 0) SelectedResearchExtensionIndex = 0;
                else SelectedResearchExtensionIndex = _index - 1;
            }
        }
        private bool CanRemoveResearchFileExtension()
        {
            return SelectedResearchExtension != null && !IsFolderResearching && !IsDiffChecking && !IsHistoryDeleting;
        }

        /// &lt;summary&gt;
        /// 調査結果の差分をチェックするコマンド
        /// &lt;/summary&gt;
        /// &lt;returns&gt;非同期タスク&lt;/returns&gt;
        [RelayCommand(CanExecute = nameof(CanCheckDiff))]
        private async Task CheckDiffAsync()
        {
            try
            {
                IsDiffChecking = true;
                DiffCheckStatus = -1;
                await CheckDiffResults();
            }
            finally
            {
                IsDiffChecking = false;
                DiffCheckStatus = 0;
            }
        }
        private bool CanCheckDiff()
        {
            return File.Exists(ResultFolder + "\\" + SelectedFirstResult) && File.Exists(ResultFolder + "\\" + SelectedSecondResult)
                    && SelectedFirstResult != SelectedSecondResult && !IsFolderResearching && !IsHistoryDeleting ;
        }
        #endregion

        #region "メソッド定義"
        /// &lt;summary&gt;
        /// 指定したフォルダ下のファイルを調査する(非同期)
        /// &lt;/summary&gt;
        /// &lt;returns&gt;非同期タスク&lt;/returns&gt;
        private async Task ResearchFolderData()
        {
            bool isResultFolderSet = true;
            var _prog = new Progress&lt;double&gt;(value =&gt; ResearchProgress = value);
            List&lt;ResearchHistory&gt; historyList = await Task.Run(() =&gt;
            {
                DateTime now = DateTime.Now;
                if (!Directory.Exists(ResultFolder))
                {
                    isResultFolderSet = false;
                    string temporaryPath = Path.GetDirectoryName(executeFilePath) + "\\temp\\" + userName + "\\ServerCheck";
                    if (!Directory.Exists(temporaryPath)) Directory.CreateDirectory(temporaryPath);
                    ResultFolder = temporaryPath;
                }

                researchResultFiles = GetServerFiles(ResearchFolder, _prog);   //時間がかかる

                string saveFilePath = ResultFolder + "\\" + (String.IsNullOrEmpty(ResultFileName) ? "調査結果" : ResultFileName) + "_" + now.ToString("yyyyMMddHHmmss") + ".xlsx";
                SaveResearchResult(saveFilePath);

                string historyFilePath = ResultFolder + "\\_history.xlsx";
                ResearchHistory _history = new()
                {
                    No = 1,
                    ResearchResultName = Path.GetFileName(saveFilePath),
                    ResearchResultType = "normal",
                    ResearchDate = now.ToString("yyyy/MM/dd HH:mm"),
                    ResearchFolder = ResearchFolder,
                    ResearchResultLink = saveFilePath,
                    ResearchGrouping = (int)SelectedResearchGroupingType,
                    ResearchDataType = (int)SelectedResearchFileType,
                    SizeLimited = IsSizeLimited ? 1 : 0,
                    LimitedSizeValue = LimitedSizeValue,
                    GroupingKeyWords = GroupingKeyWords,
                    ResearchExtensions = ResearchExtensions
                };

                return SaveResearchHistory(historyFilePath, _history);
            });

            //researchResultFilesをバインディングデータに割り当て
            try
            {   // マウスカーソルを砂時計に変更
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;
                ResearchHistoryLists = [];
                ResearchResults = [];
                ResearchNormalResults = [];
                foreach (var history in historyList)
                {
                    ResearchHistoryLists.Add(history);
                    ResearchResults.Add(history.ResearchResultName);
                    if (history.ResearchResultType == "normal") ResearchNormalResults.Add(history.ResearchResultName);
                }
                SelectedResearchResult = ResearchResults[0];
            }
            finally
            {   // 処理が完了したらマウスカーソルを元に戻す
                Mouse.OverrideCursor = null;
            }

            if (!isResultFolderSet) 
            {
                System.Windows.MessageBox.Show("結果フォルダを自動で割り当てました。");
            }
        }

        /// &lt;summary&gt;
        /// 指定したフォルダ下のファイル情報を指定形式に格納する
        /// &lt;/summary&gt;
        /// &lt;param name="rootPath"&gt;指定したフォルダのパス&lt;/param&gt;
        /// &lt;returns&gt;ファイル情報&lt;/returns&gt;
        private Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; GetServerFiles(string rootPath, IProgress&lt;double&gt; progress)
        {
            Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; results = [];
            int fileFullCnt = Directory.GetFiles(rootPath, "*", SearchOption.AllDirectories).Length;
            int fileCnt = 0;
            foreach (string filePath in Directory.GetFiles(rootPath, "*", SearchOption.AllDirectories))
            {
                FileInfo fileInfo = new(filePath);
                if (fileInfo.DirectoryName == null)
                {
                    fileCnt++;
                    progress.Report(100.0 * fileCnt / fileFullCnt);
                    continue;   //後段の警告対策
                }

                //容量制限がある場合、条件を満たさない場合はスキップ
                if (IsSizeLimited && double.TryParse(LimitedSizeValue, out double _limit) && (fileInfo.Length / 1024.0 / 1024.0 &lt; _limit))
                {
                    fileCnt++;
                    progress.Report(100.0 * fileCnt / fileFullCnt);
                    continue;
                }

                //拡張子指定がある場合、条件を満たさない場合はスキップ
                if (SelectedResearchFileType == ResearchFileTypes.Extension)
                {
                    bool isMatch = false;
                    foreach (var ext in ResearchExtensions)
                    {
                        if (fileInfo.Extension.Contains(ext)) isMatch = true;
                    }
                    if (!isMatch)
                    {
                        fileCnt++;
                        progress.Report(100.0 * fileCnt / fileFullCnt);
                        continue;
                    }
                }

                //分類グループチェック
                string _group = "-";
                switch (SelectedResearchGroupingType)
                {
                    case ResearchGroupingTypes.TopFolders:
                        List&lt;string&gt; groups = GetTopLevelFolders(ResearchFolder);
                        _group = GetGroup(fileInfo.DirectoryName, rootPath, groups);
                        break;

                    case ResearchGroupingTypes.KeyWords:
                        _group = GetGroup(filePath, GroupingKeyWords);
                        break;

                    default:
                        break;
                }

                //キーワード分類の場合、該当なしの場合はスキップ
                if (SelectedResearchGroupingType == ResearchGroupingTypes.KeyWords && _group == "-")
                {
                    fileCnt++;
                    progress.Report(100.0 * fileCnt / fileFullCnt);
                    continue;
                }

                if (!results.ContainsKey(_group)) results[_group] = [];
                ResearchFileInfo fileInformation = new()
                {
                    No = results[_group].Count + 1,
                    FolderName = fileInfo.DirectoryName,
                    FileName = fileInfo.Name,
                    Size = fileInfo.Length / 1024.0 / 1024.0,
                    LastModified = fileInfo.LastWriteTime.ToString("yyyy/MM/dd HH:mm"),
                    CreatedDate = fileInfo.CreationTime.ToString("yyyy/MM/dd HH:mm"),
                    Group = _group
                    //LastModifiedBy = GetLastModifiedBy(filePath, fileInfo.LastWriteTime)
                };
                results[_group].Add(fileInformation);
                fileCnt++;
                progress.Report(100.0 * fileCnt / fileFullCnt);
            }
            return results;
        }

        /// &lt;summary&gt;
        /// 調査するフォルダのパス直下のフォルダをリストアップする
        /// &lt;/summary&gt;
        /// &lt;param name="rootPath"&gt;調査するフォルダのパス&lt;/param&gt;
        /// &lt;returns&gt;調査するフォルダのパス直下のフォルダリスト&lt;/returns&gt;
        static List&lt;string&gt; GetTopLevelFolders(string rootPath)
        {
            List&lt;string&gt; folders = [];
            try
            {   // 最上位階層のフォルダを取得
                foreach (string directory in Directory.GetDirectories(rootPath)) folders.Add(Path.GetFileName(directory));
            }
            catch (Exception ex)
            {
                System.Windows.MessageBox.Show($"エラーが発生しました: {ex.Message}");
            }
            return folders;
        }

        /// &lt;summary&gt;
        /// ファイルの分類をチェックする(最上位フォルダでの分類)
        /// &lt;/summary&gt;
        /// &lt;param name="fileStoredFolderPath"&gt;ファイルが保存されているフォルダ名&lt;/param&gt;
        /// &lt;param name="rootPath"&gt;指定した調査フォルダ&lt;/param&gt;
        /// &lt;param name="groups"&gt;分類のリスト&lt;/param&gt;
        /// &lt;returns&gt;分類情報&lt;/returns&gt;
        private static string GetGroup(string fileStoredFolderPath, string rootPath, List&lt;string&gt; groups)
        {
            string _group = rootPath;
            foreach (var gr in groups)
            {
                if (fileStoredFolderPath.Contains(rootPath + "\\" + gr))
                {
                    _group = gr;
                    break;
                }
            }
            return _group;
        }

        /// &lt;summary&gt;
        /// ファイルの分類をチェックする(キーワードでの分類)
        /// &lt;/summary&gt;
        /// &lt;param name="fileName"&gt;ファイルが保存されているフォルダ名&lt;/param&gt;
        /// &lt;param name="groups"&gt;分類のリスト&lt;/param&gt;
        /// &lt;returns&gt;分類情報&lt;/returns&gt;
        private static string GetGroup(string fileName, UniqueObservableCollection&lt;string&gt; groups)
        {
            string _group = "-";
            foreach (var gr in groups)
            {
                if (fileName.Contains(gr))
                {
                    _group = gr;
                    break;
                }
            }
            return _group;
        }

        /// &lt;summary&gt;
        /// リサーチ結果を保存する
        /// &lt;/summary&gt;
        /// &lt;param name="path"&gt;リーサーチ結果の保存パス&lt;/param&gt;
        private void SaveResearchResult(string path)
        {
            XSSFWorkbook workbook = new();

            //最初のシートに調査サマリ情報を記載
            ISheet summarySheet = workbook.CreateSheet("summary");
            int summaryCnt = 0;
            IRow summaryRow = summarySheet.CreateRow(summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査タイプ:");
            summaryRow.CreateCell(1).SetCellValue("normal");
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査フォルダ:");
            summaryRow.CreateCell(1).SetCellValue(ResearchFolder);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類方法:");
            summaryRow.CreateCell(1).SetCellValue((int)SelectedResearchGroupingType);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("データ指定:");
            summaryRow.CreateCell(1).SetCellValue((int)SelectedResearchFileType);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量制限:");
            summaryRow.CreateCell(1).SetCellValue(IsSizeLimited ? 1 : 0);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量値:");
            summaryRow.CreateCell(1).SetCellValue(LimitedSizeValue);

            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類キーワード:");
            string _keywords = "";
            foreach (var item in GroupingKeyWords)
            {
                if (_keywords == "") _keywords = item;
                else _keywords += "," + item;
            }
            summaryRow.CreateCell(1).SetCellValue(_keywords);

            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("指定拡張子:");
            string _extensions = "";
            foreach (var item in ResearchExtensions)
            {
                if (_extensions == "") _extensions = item;
                else _extensions += "," + item;
            }
            summaryRow.CreateCell(1).SetCellValue(_extensions);

            // summary用のカスタム書式を作成
            ICellStyle fileCellStyle = workbook.CreateCellStyle();
            IDataFormat fileFormat = workbook.CreateDataFormat();
            fileCellStyle.DataFormat = fileFormat.GetFormat("0 \"Files\"");
            ICellStyle sizeCellStyle = workbook.CreateCellStyle();
            IDataFormat sizeFormat = workbook.CreateDataFormat();
            sizeCellStyle.DataFormat = sizeFormat.GetFormat("0.0 \"MB\"");

            int groupCnt = 0;
            foreach (var kvp in researchResultFiles)
            {
                ISheet sheet = workbook.CreateSheet("分類" + (groupCnt + 1));
                IRow titleRow = sheet.CreateRow(0);    // ヘッダー行を作成
                titleRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                titleRow.CreateCell(1).SetCellValue(kvp.Key);

                IRow headerRow = sheet.CreateRow(1);    // ヘッダー行を作成
                int i = 0;
                foreach (var header in Vals.researchResultHeaders)
                {
                    headerRow.CreateCell(i).SetCellValue(header);
                    i++;
                }

                int j = 2;
                double totalSize = 0.0;
                foreach (var result in kvp.Value)
                {
                    IRow row = sheet.CreateRow(j);
                    int col = 0;
                    row.CreateCell(col).SetCellValue(result.No);
                    row.CreateCell(++col).SetCellValue(result.FolderName);
                    row.CreateCell(++col).SetCellValue(result.FileName);
                    row.CreateCell(++col).SetCellValue(result.Size);
                    row.CreateCell(++col).SetCellValue(result.LastModified);
                    row.CreateCell(++col).SetCellValue(result.CreatedDate);
                    row.CreateCell(++col).SetCellValue(result.Group);
                    j++;
                    totalSize += result.Size;
                }

                //summaryシートへの記載
                summaryRow = summarySheet.CreateRow(++summaryCnt);
                summaryRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                summaryRow.CreateCell(1).SetCellValue(kvp.Key);
                ICell cell = summaryRow.CreateCell(2);
                cell.SetCellValue(j - 2);
                cell.CellStyle = fileCellStyle;
                cell = summaryRow.CreateCell(3);
                cell.SetCellValue(totalSize);
                cell.CellStyle = sizeCellStyle;

                groupCnt++;
            }

            for (int i = 0; i &lt; 4; i++)
            {
                summarySheet.AutoSizeColumn(i);
                double currentWidth = summarySheet.GetColumnWidth(i);
                double newWidth = currentWidth * 1.6;   // 列の幅を1.6倍に設定し直す
                summarySheet.SetColumnWidth(i, newWidth);
            }

            using var fs = new FileStream(path, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }

        //static string GetLastModifiedBy(string filePath, DateTime lastWriteTime)
        //{
        //    string userName = "不明";
        //    try
        //    {
        //        EventLog securityLog = new("Security");
        //        foreach (EventLogEntry entry in securityLog.Entries)
        //        {
        //            if (entry.InstanceId == 4663 && entry.TimeGenerated &gt;= lastWriteTime.AddSeconds(-5) && entry.TimeGenerated &lt;= lastWriteTime.AddSeconds(5))
        //            {
        //                string message = entry.Message;
        //                if (message.Contains(filePath))
        //                {
        //                    int startIndex = message.IndexOf("アカウント名:") + 6;
        //                    int endIndex = message.IndexOf("アカウント ドメイン:") - 1;
        //                    if (startIndex &gt; 6 && endIndex &gt; startIndex)
        //                    {
        //                        userName = message[startIndex..endIndex].Trim();
        //                    }
        //                    break;
        //                }
        //            }
        //        }
        //    }
        //    catch (Exception ex)
        //    {
        //        MessageBox.Show($"更新者情報の取得中にエラーが発生しました: {ex.Message}");
        //    }
        //    return userName;
        //}

        /// &lt;summary&gt;
        /// 調査履歴のファイルを保存する(既存ファイルが無い場合は新規作成)
        /// &lt;/summary&gt;
        /// &lt;param name="path"&gt;調査履歴のファイルパス&lt;/param&gt;
        /// &lt;param name="history"&gt;最新の調査履歴情報&lt;/param&gt;
        /// &lt;returns&gt;ResearchHistoryのリスト&lt;/returns&gt;
        private static List&lt;ResearchHistory&gt; SaveResearchHistory(string path, ResearchHistory history)
        {
            List&lt;ResearchHistory&gt; result = [];
            if (!File.Exists(path))
            {
                XSSFWorkbook workbook = new();
                ISheet sheet = workbook.CreateSheet("history");
                IRow headerRow = sheet.CreateRow(0);    // ヘッダー行を作成
                int i = 0;
                foreach (var header in Vals.researchHistoryHeaders)
                {
                    headerRow.CreateCell(i).SetCellValue(header);
                    i++;
                }

                IRow row = sheet.CreateRow(1);          //データ1行目
                int col = 0;
                row.CreateCell(col).SetCellValue(history.No);
                row.CreateCell(++col).SetCellValue(history.ResearchResultName);
                row.CreateCell(++col).SetCellValue(history.ResearchResultType);
                row.CreateCell(++col).SetCellValue(history.ResearchDate);
                row.CreateCell(++col).SetCellValue(history.ResearchFolder);
                row.CreateCell(++col).SetCellValue(history.ResearchResultLink);
                row.CreateCell(++col).SetCellValue(history.ResearchGrouping);
                row.CreateCell(++col).SetCellValue(history.ResearchDataType);
                row.CreateCell(++col).SetCellValue(history.SizeLimited);
                row.CreateCell(++col).SetCellValue(history.LimitedSizeValue);

                string _keywords = "";
                foreach (var item in history.GroupingKeyWords)
                {
                    if (_keywords == "") _keywords = item;
                    else _keywords += "," + item;
                }
                row.CreateCell(++col).SetCellValue(_keywords);

                string _extensions = "";
                foreach (var item in history.ResearchExtensions)
                {
                    if (_extensions == "") _extensions = item;
                    else _extensions += "," + item;
                }
                row.CreateCell(++col).SetCellValue(_extensions);

                using var fs = new FileStream(path, FileMode.Create, FileAccess.Write);
                workbook.Write(fs);
                workbook.Close();
                result.Add(history);
            }
            else
            {
                XSSFWorkbook workbook;
                using (FileStream fs = new(path, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(fs);
                }

                ISheet sheet = workbook.GetSheetAt(0);      // 最初のシートを取得
                int lastRowNum = sheet.LastRowNum;
                IRow row = sheet.CreateRow(lastRowNum + 1); //データ行末尾
                int col = 0;
                row.CreateCell(col).SetCellValue(lastRowNum + history.No);
                row.CreateCell(++col).SetCellValue(history.ResearchResultName);
                row.CreateCell(++col).SetCellValue(history.ResearchResultType);
                row.CreateCell(++col).SetCellValue(history.ResearchDate);
                row.CreateCell(++col).SetCellValue(history.ResearchFolder);
                row.CreateCell(++col).SetCellValue(history.ResearchResultLink);
                row.CreateCell(++col).SetCellValue(history.ResearchGrouping);
                row.CreateCell(++col).SetCellValue(history.ResearchDataType);
                row.CreateCell(++col).SetCellValue(history.SizeLimited);
                row.CreateCell(++col).SetCellValue(history.LimitedSizeValue);

                string _keywords = "";
                foreach (var item in history.GroupingKeyWords)
                {
                    if (_keywords == "") _keywords = item;
                    else _keywords += "," + item;
                }
                row.CreateCell(++col).SetCellValue(_keywords);

                string _extensions = "";
                foreach (var item in history.ResearchExtensions)
                {
                    if (_extensions == "") _extensions = item;
                    else _extensions += "," + item;
                }
                row.CreateCell(++col).SetCellValue(_extensions);

                for (int j = 1; j &lt;= lastRowNum + 1; j++)
                {
                    row = sheet.GetRow(j);
                    List&lt;string&gt; lists = [.. row.GetCell(KEYWORDS_COL).StringCellValue.Split(',')];
                    UniqueObservableCollection&lt;string&gt; _keywordLists = [];
                    //foreach (string list in lists) _keywordLists.Add(list);
                    foreach (string list in lists)
                    {
                        if (!String.IsNullOrEmpty(list)) _keywordLists.Add(list);
                    }
                    lists = [.. row.GetCell(EXTENSIONS_COL).StringCellValue.Split(',')];
                    UniqueObservableCollection&lt;string&gt; _extensionLists = [];
                    //foreach (string list in lists) _extensionLists.Add(list);
                    foreach (string list in lists)
                    {
                        if (!String.IsNullOrEmpty(list)) _extensionLists.Add(list);
                    }

                    col = 0;
                    ResearchHistory _history = new()
                    {
                        No = (int)row.GetCell(col).NumericCellValue,
                        ResearchResultName = row.GetCell(++col).StringCellValue,
                        ResearchResultType = row.GetCell(++col).StringCellValue,
                        ResearchDate = row.GetCell(++col).StringCellValue,
                        ResearchFolder = row.GetCell(++col).StringCellValue,
                        ResearchResultLink = row.GetCell(++col).StringCellValue,
                        ResearchGrouping = (int)row.GetCell(++col).NumericCellValue,
                        ResearchDataType = (int)row.GetCell(++col).NumericCellValue,
                        SizeLimited = (int)row.GetCell(++col).NumericCellValue,
                        LimitedSizeValue = row.GetCell(++col).StringCellValue,
                        GroupingKeyWords = _keywordLists,
                        ResearchExtensions = _extensionLists
                    };
                    result.Add(_history);
                }

                using (FileStream fsOut = new(path, FileMode.Create, FileAccess.Write))
                {
                    workbook.Write(fsOut); // ファイルに書き込み
                }
                workbook.Close();
            }
            return result;
        }

        private static List&lt;ResearchHistory&gt; SaveResearchHistory(string path, List&lt;ResearchHistory&gt; historys)
        {
            List&lt;ResearchHistory&gt; result = [];
            if (File.Exists(path))
            {
                XSSFWorkbook workbook;
                using (FileStream fs = new(path, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(fs);
                }

                ISheet sheet = workbook.GetSheetAt(0);      // 最初のシートを取得
                int lastRowNum = sheet.LastRowNum;
                int rowCnt = 0;
                foreach (var history in historys)
                {
                    rowCnt++;
                    IRow row = sheet.CreateRow(lastRowNum + rowCnt); //データ行末尾
                    int col = 0;
                    row.CreateCell(col).SetCellValue(lastRowNum + rowCnt);
                    row.CreateCell(++col).SetCellValue(history.ResearchResultName);
                    row.CreateCell(++col).SetCellValue(history.ResearchResultType);
                    row.CreateCell(++col).SetCellValue(history.ResearchDate);
                    row.CreateCell(++col).SetCellValue(history.ResearchFolder);
                    row.CreateCell(++col).SetCellValue(history.ResearchResultLink);
                    row.CreateCell(++col).SetCellValue(history.ResearchGrouping);
                    row.CreateCell(++col).SetCellValue(history.ResearchDataType);
                    row.CreateCell(++col).SetCellValue(history.SizeLimited);
                    row.CreateCell(++col).SetCellValue(history.LimitedSizeValue);

                    string _keywords = "";
                    foreach (var item in history.GroupingKeyWords)
                    {
                        if (_keywords == "") _keywords = item;
                        else _keywords += "," + item;
                    }
                    row.CreateCell(++col).SetCellValue(_keywords);

                    string _extensions = "";
                    foreach (var item in history.ResearchExtensions)
                    {
                        if (_extensions == "") _extensions = item;
                        else _extensions += "," + item;
                    }
                    row.CreateCell(++col).SetCellValue(_extensions);
                }

                for (int j = 1; j &lt;= lastRowNum + rowCnt; j++)
                {
                    IRow row = sheet.GetRow(j);
                    List&lt;string&gt; lists = [.. row.GetCell(KEYWORDS_COL).StringCellValue.Split(',')];
                    UniqueObservableCollection&lt;string&gt; _keywordLists = [];
                    foreach (string list in lists) _keywordLists.Add(list);
                    lists = [.. row.GetCell(EXTENSIONS_COL).StringCellValue.Split(',')];
                    UniqueObservableCollection&lt;string&gt; _extensionLists = [];
                    foreach (string list in lists) _extensionLists.Add(list);

                    int col = 0;
                    ResearchHistory _history = new()
                    {
                        No = (int)row.GetCell(col).NumericCellValue,
                        ResearchResultName = row.GetCell(++col).StringCellValue,
                        ResearchResultType = row.GetCell(++col).StringCellValue,
                        ResearchDate = row.GetCell(++col).StringCellValue,
                        ResearchFolder = row.GetCell(++col).StringCellValue,
                        ResearchResultLink = row.GetCell(++col).StringCellValue,
                        ResearchGrouping = (int)row.GetCell(++col).NumericCellValue,
                        ResearchDataType = (int)row.GetCell(++col).NumericCellValue,
                        SizeLimited = (int)row.GetCell(++col).NumericCellValue,
                        LimitedSizeValue = row.GetCell(++col).StringCellValue,
                        GroupingKeyWords = _keywordLists,
                        ResearchExtensions = _extensionLists
                    };
                    result.Add(_history);
                }

                using (FileStream fsOut = new(path, FileMode.Create, FileAccess.Write))
                {
                    workbook.Write(fsOut); // ファイルに書き込み
                }
                workbook.Close();
            }
            return result;
        }

        /// &lt;summary&gt;
        /// 履歴ファイルの結果をGridViewに設定する
        /// &lt;/summary&gt;
        /// &lt;param name="historyFilePath"&gt;履歴ファイルのパス&lt;/param&gt;
        private void SetResultHistory(string historyFilePath)
        {
            ResearchHistoryLists = [];
            ResearchResults = [];
            ResearchNormalResults = [];
            if (File.Exists(historyFilePath))
            {
                XSSFWorkbook workbook;
                using (FileStream fs = new(historyFilePath, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(fs);
                }
                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
                int lastRowNum = sheet.LastRowNum;
                for (int j = 1; j &lt;= lastRowNum; j++)
                {
                    IRow row = sheet.GetRow(j);
                    ResearchResults.Add(row.GetCell(1).StringCellValue);
                    if (row.GetCell(2).StringCellValue == "normal") ResearchNormalResults.Add(row.GetCell(1).StringCellValue);

                    List&lt;string&gt; lists = [.. row.GetCell(KEYWORDS_COL).StringCellValue.Split(',')];
                    UniqueObservableCollection&lt;string&gt; _keywordLists = [];
                    foreach (string list in lists) _keywordLists.Add(list);
                    lists = [.. row.GetCell(EXTENSIONS_COL).StringCellValue.Split(',')];
                    UniqueObservableCollection&lt;string&gt; _extensionLists = [];
                    foreach (string list in lists) _extensionLists.Add(list);

                    int col = 0;
                    ResearchHistory _history = new()
                    {
                        No = (int)row.GetCell(col).NumericCellValue,
                        ResearchResultName = row.GetCell(++col).StringCellValue,
                        ResearchResultType = row.GetCell(++col).StringCellValue,
                        ResearchDate = row.GetCell(++col).StringCellValue,
                        ResearchFolder = row.GetCell(++col).StringCellValue,
                        ResearchResultLink = row.GetCell(++col).StringCellValue,
                        ResearchGrouping = (int)row.GetCell(++col).NumericCellValue,
                        ResearchDataType = (int)row.GetCell(++col).NumericCellValue,
                        SizeLimited = (int)row.GetCell(++col).NumericCellValue,
                        LimitedSizeValue = row.GetCell(++col).StringCellValue,
                        GroupingKeyWords = _keywordLists,
                        ResearchExtensions = _extensionLists
                    };
                    ResearchHistoryLists.Add(_history);
                }
                workbook.Close();
                SelectedResearchResult = ResearchResults[0];
            }
        }

        /// &lt;summary&gt;
        /// 履歴を削除するメソッド
        /// &lt;/summary&gt;
        /// &lt;returns&gt;非同期タスク&lt;/returns&gt;
        private async Task DeleteSelectedHistory()
        {
            // 削除確認ダイアログを表示
            int rowIndexToDelete = SelectedHistory.No;
            MessageBoxResult result = System.Windows.MessageBox.Show($"No {rowIndexToDelete} の調査履歴を削除してよろしいですか？", "削除確認", MessageBoxButton.YesNo, MessageBoxImage.Question);
            if (result == MessageBoxResult.No) return;

            string historyFilePath = ResultFolder + "\\_history.xlsx";
            string filePathToDelete = SelectedHistory.ResearchResultLink;
            await Task.Run(() =&gt;
            {
                XSSFWorkbook workbook;
                using (FileStream fs = new(historyFilePath, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(fs);
                }
                ISheet sheet = workbook.GetSheetAt(0); // 1番目のシートを取得
                RemoveRow(sheet, rowIndexToDelete); // 行を削除
                UpdateRowNumbers(sheet);            // 行番号を修正
                using (FileStream fsout = new(historyFilePath, FileMode.Create, FileAccess.Write))
                {
                    workbook.Write(fsout); // ファイルに書き込み
                }
                workbook.Close();

                if(File.Exists(filePathToDelete)) File.Delete(filePathToDelete);
            });
            SetResultHistory(historyFilePath);
        }
        
        /// &lt;summary&gt;
        /// エクセルの行を削除する
        /// &lt;/summary&gt;
        /// &lt;param name="sheet"&gt;エクセルシート&lt;/param&gt;
        /// &lt;param name="rowIndex"&gt;行インデックス&lt;/param&gt;
        static void RemoveRow(ISheet sheet, int rowIndex)
        {
            int lastRowNum = sheet.LastRowNum;

            if (rowIndex &gt;= 0 && rowIndex &lt; lastRowNum)
            {
                sheet.ShiftRows(rowIndex + 1, lastRowNum, -1);
            }
            else if (rowIndex == lastRowNum)
            {
                IRow removingRow = sheet.GetRow(rowIndex);
                if (removingRow != null)
                {
                    sheet.RemoveRow(removingRow);
                }
            }
        }

        /// &lt;summary&gt;
        /// 行番号を振り直す
        /// &lt;/summary&gt;
        /// &lt;param name="sheet"&gt;エクセルシート&lt;/param&gt;
        static void UpdateRowNumbers(ISheet sheet)
        {
            for (int rowIndex = 1; rowIndex &lt;= sheet.LastRowNum; rowIndex++)
            {
                IRow row = sheet.GetRow(rowIndex);
                if (row != null)
                {
                    ICell cell = row.GetCell(0);
                    cell ??= row.CreateCell(0);
                    cell.SetCellValue(rowIndex);
                }
            }
        }

        /// &lt;summary&gt;
        /// 結果の差分をチェックする
        /// &lt;/summary&gt;
        /// &lt;returns&gt;非同期タスク&lt;/returns&gt;
        private async Task CheckDiffResults()
        {
            FileInfo firstFileInfo = new(ResultFolder + "\\" + SelectedFirstResult);
            FileInfo secondFileInfo = new(ResultFolder + "\\" + SelectedSecondResult);
            int result = DateTime.Compare(firstFileInfo.CreationTime, secondFileInfo.CreationTime);
            string oldResult = result &lt;= 0 ? SelectedFirstResult : SelectedSecondResult;
            string newResult = result &lt;= 0 ? SelectedSecondResult : SelectedFirstResult;
            string oldResultPath = ResultFolder + "\\" + oldResult;
            string newResultPath = ResultFolder + "\\" + newResult;
            bool hasError = true;

            List&lt;ResearchHistory&gt; historyList = await Task.Run(() =&gt; 
            {
                var (oldResultFiles, oldHistory) = ReadResearchResult(oldResultPath);
                var (newResultFiles, newHistory) = ReadResearchResult(newResultPath);
                List&lt;ResearchHistory&gt; results = [];

                if (!oldHistory.Equals(newHistory))
                {
                    hasError = false;
                    return results;
                }

                //TODO: 差分チェック
                DateTime now = DateTime.Now;
                string[] saveFilePath = new string[4];

                //old =&gt; newで削除されたデータ
                saveFilePath[0] = ResultFolder + "\\" + (String.IsNullOrEmpty(ResultFileName) ? "差分チェック結果(削除)" : ResultFileName) + "_" + now.ToString("yyyyMMddHHmmss") + ".xlsx";
                CheckDeletedData(saveFilePath[0], oldHistory, oldResultFiles, newResultFiles);

                //old =&gt; newで変更がないデータ
                saveFilePath[1] = ResultFolder + "\\" + (String.IsNullOrEmpty(ResultFileName) ? "差分チェック結果(変更無)" : ResultFileName) + "_" + now.ToString("yyyyMMddHHmmss") + ".xlsx";
                CheckUnchangedData(saveFilePath[1], oldHistory, oldResultFiles, newResultFiles);

                //old =&gt; newで変更があったデータ
                saveFilePath[2] = ResultFolder + "\\" + (String.IsNullOrEmpty(ResultFileName) ? "差分チェック結果(変更有)" : ResultFileName) + "_" + now.ToString("yyyyMMddHHmmss") + ".xlsx";
                CheckModifiedData(saveFilePath[2], oldHistory, oldResultFiles, newResultFiles);

                //old =&gt; newで新規追加されたデータ
                saveFilePath[3] = ResultFolder + "\\" + (String.IsNullOrEmpty(ResultFileName) ? "差分チェック結果(新規)" : ResultFileName) + "_" + now.ToString("yyyyMMddHHmmss") + ".xlsx";
                CheckAdditionalData(saveFilePath[3], oldHistory, oldResultFiles, newResultFiles);

                string historyFilePath = ResultFolder + "\\_history.xlsx";

                List&lt;ResearchHistory&gt; additionalHistory = [];
                foreach (var path in saveFilePath)
                {
                    ResearchHistory _history = new()
                    {
                        No = 1,
                        ResearchResultName = Path.GetFileName(path),
                        ResearchResultType = "diff",
                        ResearchDate = now.ToString("yyyy/MM/dd HH:mm"),
                        ResearchFolder = ResearchFolder,
                        ResearchResultLink = path
                    };
                    additionalHistory.Add(_history);
                }
                results = SaveResearchHistory(historyFilePath, additionalHistory);
                return results;
            });

            if (!hasError) 
            {
                System.Windows.MessageBox.Show("同じ設定の結果でないと差分チェックできません！");
                return;
            }

            try
            {   // マウスカーソルを砂時計に変更
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;
                ResearchHistoryLists = [];
                ResearchResults = [];
                ResearchNormalResults = [];
                foreach (var history in historyList)
                {
                    ResearchHistoryLists.Add(history);
                    ResearchResults.Add(history.ResearchResultName);
                    if (history.ResearchResultType == "normal") ResearchNormalResults.Add(history.ResearchResultName);
                }
                SelectedResearchResult = ResearchResults[0];
            }
            finally
            {   // 処理が完了したらマウスカーソルを元に戻す
                Mouse.OverrideCursor = null;
            }
        }

        /// &lt;summary&gt;
        /// 調査結果をリストに格納する
        /// &lt;/summary&gt;
        /// &lt;param name="resultPath"&gt;調査結果のパス&lt;/param&gt;
        /// &lt;returns&gt;調査結果のリストを返す&lt;/returns&gt;
        private static (Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt;, ResearchDiffInfo) ReadResearchResult(string resultPath)
        {
            Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; results = [];   //調査結果ファイルから読み出して格納
            ResearchDiffInfo _diffInfo;
            XSSFWorkbook workbook;
            using (FileStream fs = new(resultPath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(fs);
            }

            ISheet summarySheet = workbook.GetSheetAt(0);
            //int summaryCnt = 0;
            //IRow summaryRow = summarySheet.GetRow(summaryCnt);

            _diffInfo = new ResearchDiffInfo
            {
                ResearchFolder = summarySheet.GetRow(1).GetCell(1).StringCellValue,
                ResearchGrouping = (int)summarySheet.GetRow(2).GetCell(1).NumericCellValue,
                ResearchDataType = (int)summarySheet.GetRow(3).GetCell(1).NumericCellValue,
                SizeLimited = (int)summarySheet.GetRow(4).GetCell(1).NumericCellValue,
                LimitedSizeValue = summarySheet.GetRow(5).GetCell(1).StringCellValue,
                GroupingKeyWords = summarySheet.GetRow(6).GetCell(1).StringCellValue,
                ResearchExtensions = summarySheet.GetRow(7).GetCell(1).StringCellValue
            };

            for (int i = 1; i &lt; workbook.NumberOfSheets; i++)
            {   // i = 0は"summary"のため除外
                ISheet sheet = workbook.GetSheetAt(i);
                IRow titleRow = sheet.GetRow(0);
                string _group = titleRow.GetCell(1).StringCellValue;
                results[_group] = [];
                int lastRowNum = sheet.LastRowNum;
                for (int j = 2; j &lt;= lastRowNum; j++)
                {
                    IRow row = sheet.GetRow(j);
                    int col = 0;
                    ResearchFileInfo fileInformation = new()
                    {
                        No = (int)row.GetCell(col).NumericCellValue,
                        FolderName = row.GetCell(++col).StringCellValue,
                        FileName = row.GetCell(++col).StringCellValue,
                        Size = row.GetCell(++col).NumericCellValue,
                        LastModified = row.GetCell(++col).StringCellValue,
                        CreatedDate = row.GetCell(++col).StringCellValue,
                        Group = row.GetCell(++col).StringCellValue
                    };
                    results[_group].Add(fileInformation);
                }
            }
            workbook.Close();

            return (results, _diffInfo);
        }
        
        private static void CheckDeletedData(string saveFilePath, ResearchDiffInfo diffInfo, Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; oldResultFiles, Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; newResultFiles)
        {
            XSSFWorkbook workbook = new();

            //最初のシートに調査サマリ情報を記載
            ISheet summarySheet = workbook.CreateSheet("summary");
            int summaryCnt = 0;
            IRow summaryRow = summarySheet.CreateRow(summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査タイプ:");
            summaryRow.CreateCell(1).SetCellValue("diff(削除)");
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査フォルダ:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchFolder);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類方法:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchGrouping);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("データ指定:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchDataType);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量制限:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.SizeLimited);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量値:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.LimitedSizeValue);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類キーワード:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.GroupingKeyWords);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("指定拡張子:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchExtensions);

            // summary用のカスタム書式を作成
            ICellStyle fileCellStyle = workbook.CreateCellStyle();
            IDataFormat fileFormat = workbook.CreateDataFormat();
            fileCellStyle.DataFormat = fileFormat.GetFormat("0 \"Files\"");
            ICellStyle sizeCellStyle = workbook.CreateCellStyle();
            IDataFormat sizeFormat = workbook.CreateDataFormat();
            sizeCellStyle.DataFormat = sizeFormat.GetFormat("0.0 \"MB\"");

            int groupCnt = 0;
            foreach (var kvp in oldResultFiles)
            {
                ISheet sheet = workbook.CreateSheet("分類" + (groupCnt + 1));
                IRow titleRow = sheet.CreateRow(0);    // ヘッダー行を作成
                titleRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                titleRow.CreateCell(1).SetCellValue(kvp.Key);

                IRow headerRow = sheet.CreateRow(1);    // ヘッダー行を作成
                int i = 0;
                foreach (var header in Vals.researchResultHeaders)
                {
                    headerRow.CreateCell(i).SetCellValue(header);
                    i++;
                }

                int j = 2;
                double totalSize = 0.0;

                if (!newResultFiles.TryGetValue(kvp.Key, out List&lt;ResearchFileInfo&gt;? newValue))
                {
                    foreach (var result in kvp.Value)
                    {
                        IRow row = sheet.CreateRow(j);
                        int col = 0;
                        row.CreateCell(col).SetCellValue(result.No);
                        row.CreateCell(++col).SetCellValue(result.FolderName);
                        row.CreateCell(++col).SetCellValue(result.FileName);
                        row.CreateCell(++col).SetCellValue(result.Size);
                        row.CreateCell(++col).SetCellValue(result.LastModified);
                        row.CreateCell(++col).SetCellValue(result.CreatedDate);
                        row.CreateCell(++col).SetCellValue(result.Group);
                        j++;
                        totalSize += result.Size;
                    }
                }
                else
                {
                    foreach (var result in kvp.Value)
                    {
                        if (!newValue.Any(item =&gt; item.FileName == result.FileName))
                        {
                            IRow row = sheet.CreateRow(j);
                            int col = 0;
                            row.CreateCell(col).SetCellValue(result.No);
                            row.CreateCell(++col).SetCellValue(result.FolderName);
                            row.CreateCell(++col).SetCellValue(result.FileName);
                            row.CreateCell(++col).SetCellValue(result.Size);
                            row.CreateCell(++col).SetCellValue(result.LastModified);
                            row.CreateCell(++col).SetCellValue(result.CreatedDate);
                            row.CreateCell(++col).SetCellValue(result.Group);
                            j++;
                            totalSize += result.Size;
                        }
                    }
                }

                //summaryシートへの記載
                summaryRow = summarySheet.CreateRow(++summaryCnt);
                summaryRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                summaryRow.CreateCell(1).SetCellValue(kvp.Key);
                ICell cell = summaryRow.CreateCell(2);
                cell.SetCellValue(j - 2);
                cell.CellStyle = fileCellStyle;
                cell = summaryRow.CreateCell(3);
                cell.SetCellValue(totalSize);
                cell.CellStyle = sizeCellStyle;

                groupCnt++;
            }

            for (int i = 0; i &lt; 4; i++)
            {
                summarySheet.AutoSizeColumn(i);
                double currentWidth = summarySheet.GetColumnWidth(i);
                double newWidth = currentWidth * 1.6;   // 列の幅を1.6倍に設定し直す
                summarySheet.SetColumnWidth(i, newWidth);
            }

            using var fs = new FileStream(saveFilePath, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }

        private static void CheckUnchangedData(string saveFilePath, ResearchDiffInfo diffInfo, Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; oldResultFiles, Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; newResultFiles)
        {
            XSSFWorkbook workbook = new();

            //最初のシートに調査サマリ情報を記載
            ISheet summarySheet = workbook.CreateSheet("summary");
            int summaryCnt = 0;
            IRow summaryRow = summarySheet.CreateRow(summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査タイプ:");
            summaryRow.CreateCell(1).SetCellValue("diff(削除)");
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査フォルダ:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchFolder);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類方法:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchGrouping);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("データ指定:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchDataType);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量制限:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.SizeLimited);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量値:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.LimitedSizeValue);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類キーワード:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.GroupingKeyWords);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("指定拡張子:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchExtensions);

            // summary用のカスタム書式を作成
            ICellStyle fileCellStyle = workbook.CreateCellStyle();
            IDataFormat fileFormat = workbook.CreateDataFormat();
            fileCellStyle.DataFormat = fileFormat.GetFormat("0 \"Files\"");
            ICellStyle sizeCellStyle = workbook.CreateCellStyle();
            IDataFormat sizeFormat = workbook.CreateDataFormat();
            sizeCellStyle.DataFormat = sizeFormat.GetFormat("0.0 \"MB\"");

            int groupCnt = 0;
            foreach (var kvp in oldResultFiles)
            {
                if (!newResultFiles.TryGetValue(kvp.Key, out List&lt;ResearchFileInfo&gt;? newValue)) continue;

                ISheet sheet = workbook.CreateSheet("分類" + (groupCnt + 1));
                IRow titleRow = sheet.CreateRow(0);    // ヘッダー行を作成
                titleRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                titleRow.CreateCell(1).SetCellValue(kvp.Key);

                IRow headerRow = sheet.CreateRow(1);    // ヘッダー行を作成
                int i = 0;
                foreach (var header in Vals.researchResultHeaders)
                {
                    headerRow.CreateCell(i).SetCellValue(header);
                    i++;
                }

                int j = 2;
                double totalSize = 0.0;

                foreach (var result in kvp.Value)
                {
                    if (newValue.Contains(result))
                    {
                        IRow row = sheet.CreateRow(j);
                        int col = 0;
                        row.CreateCell(col).SetCellValue(result.No);
                        row.CreateCell(++col).SetCellValue(result.FolderName);
                        row.CreateCell(++col).SetCellValue(result.FileName);
                        row.CreateCell(++col).SetCellValue(result.Size);
                        row.CreateCell(++col).SetCellValue(result.LastModified);
                        row.CreateCell(++col).SetCellValue(result.CreatedDate);
                        row.CreateCell(++col).SetCellValue(result.Group);
                        j++;
                        totalSize += result.Size;
                    }
                }

                //summaryシートへの記載
                summaryRow = summarySheet.CreateRow(++summaryCnt);
                summaryRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                summaryRow.CreateCell(1).SetCellValue(kvp.Key);
                ICell cell = summaryRow.CreateCell(2);
                cell.SetCellValue(j - 2);
                cell.CellStyle = fileCellStyle;
                cell = summaryRow.CreateCell(3);
                cell.SetCellValue(totalSize);
                cell.CellStyle = sizeCellStyle;

                groupCnt++;
            }

            for (int i = 0; i &lt; 4; i++)
            {
                summarySheet.AutoSizeColumn(i);
                double currentWidth = summarySheet.GetColumnWidth(i);
                double newWidth = currentWidth * 1.6;   // 列の幅を1.6倍に設定し直す
                summarySheet.SetColumnWidth(i, newWidth);
            }

            using var fs = new FileStream(saveFilePath, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }

        private static void CheckModifiedData(string saveFilePath, ResearchDiffInfo diffInfo, Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; oldResultFiles, Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; newResultFiles)
        {
            XSSFWorkbook workbook = new();

            //最初のシートに調査サマリ情報を記載
            ISheet summarySheet = workbook.CreateSheet("summary");
            int summaryCnt = 0;
            IRow summaryRow = summarySheet.CreateRow(summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査タイプ:");
            summaryRow.CreateCell(1).SetCellValue("diff(削除)");
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査フォルダ:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchFolder);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類方法:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchGrouping);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("データ指定:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchDataType);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量制限:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.SizeLimited);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量値:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.LimitedSizeValue);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類キーワード:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.GroupingKeyWords);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("指定拡張子:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchExtensions);

            // summary用のカスタム書式を作成
            ICellStyle fileCellStyle = workbook.CreateCellStyle();
            IDataFormat fileFormat = workbook.CreateDataFormat();
            fileCellStyle.DataFormat = fileFormat.GetFormat("0 \"Files\"");
            ICellStyle sizeCellStyle = workbook.CreateCellStyle();
            IDataFormat sizeFormat = workbook.CreateDataFormat();
            sizeCellStyle.DataFormat = sizeFormat.GetFormat("0.0 \"MB\"");

            int groupCnt = 0;
            foreach (var kvp in oldResultFiles)
            {
                if (!newResultFiles.TryGetValue(kvp.Key, out List&lt;ResearchFileInfo&gt;? newValue)) continue;

                ISheet sheet = workbook.CreateSheet("分類" + (groupCnt + 1));
                IRow titleRow = sheet.CreateRow(0);    // ヘッダー行を作成
                titleRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                titleRow.CreateCell(1).SetCellValue(kvp.Key);

                IRow headerRow = sheet.CreateRow(1);    // ヘッダー行を作成
                int i = 0;
                foreach (var header in Vals.researchResultHeaders)
                {
                    headerRow.CreateCell(i).SetCellValue(header);
                    i++;
                }

                int j = 2;
                double totalSize = 0.0;

                foreach (var result in kvp.Value)
                {
                    if (newValue.Any(item =&gt; result.EqualsExcludingLastModified(item)))
                    {
                        IRow row = sheet.CreateRow(j);
                        int col = 0;
                        row.CreateCell(col).SetCellValue(result.No);
                        row.CreateCell(++col).SetCellValue(result.FolderName);
                        row.CreateCell(++col).SetCellValue(result.FileName);
                        row.CreateCell(++col).SetCellValue(result.Size);
                        row.CreateCell(++col).SetCellValue(result.LastModified);
                        row.CreateCell(++col).SetCellValue(result.CreatedDate);
                        row.CreateCell(++col).SetCellValue(result.Group);
                        j++;
                        totalSize += result.Size;
                    }
                }

                //summaryシートへの記載
                summaryRow = summarySheet.CreateRow(++summaryCnt);
                summaryRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                summaryRow.CreateCell(1).SetCellValue(kvp.Key);
                ICell cell = summaryRow.CreateCell(2);
                cell.SetCellValue(j - 2);
                cell.CellStyle = fileCellStyle;
                cell = summaryRow.CreateCell(3);
                cell.SetCellValue(totalSize);
                cell.CellStyle = sizeCellStyle;

                groupCnt++;
            }

            for (int i = 0; i &lt; 4; i++)
            {
                summarySheet.AutoSizeColumn(i);
                double currentWidth = summarySheet.GetColumnWidth(i);
                double newWidth = currentWidth * 1.6;   // 列の幅を1.6倍に設定し直す
                summarySheet.SetColumnWidth(i, newWidth);
            }

            using var fs = new FileStream(saveFilePath, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }

        private static void CheckAdditionalData(string saveFilePath, ResearchDiffInfo diffInfo, Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; oldResultFiles, Dictionary&lt;string, List&lt;ResearchFileInfo&gt;&gt; newResultFiles)
        {
            XSSFWorkbook workbook = new();

            //最初のシートに調査サマリ情報を記載
            ISheet summarySheet = workbook.CreateSheet("summary");
            int summaryCnt = 0;
            IRow summaryRow = summarySheet.CreateRow(summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査タイプ:");
            summaryRow.CreateCell(1).SetCellValue("diff(削除)");
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("調査フォルダ:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchFolder);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類方法:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchGrouping);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("データ指定:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchDataType);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量制限:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.SizeLimited);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("容量値:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.LimitedSizeValue);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("分類キーワード:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.GroupingKeyWords);
            summaryRow = summarySheet.CreateRow(++summaryCnt);
            summaryRow.CreateCell(0).SetCellValue("指定拡張子:");
            summaryRow.CreateCell(1).SetCellValue(diffInfo.ResearchExtensions);

            // summary用のカスタム書式を作成
            ICellStyle fileCellStyle = workbook.CreateCellStyle();
            IDataFormat fileFormat = workbook.CreateDataFormat();
            fileCellStyle.DataFormat = fileFormat.GetFormat("0 \"Files\"");
            ICellStyle sizeCellStyle = workbook.CreateCellStyle();
            IDataFormat sizeFormat = workbook.CreateDataFormat();
            sizeCellStyle.DataFormat = sizeFormat.GetFormat("0.0 \"MB\"");

            int groupCnt = 0;
            foreach (var kvp in newResultFiles)
            {
                ISheet sheet = workbook.CreateSheet("分類" + (groupCnt + 1));
                IRow titleRow = sheet.CreateRow(0);    // ヘッダー行を作成
                titleRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                titleRow.CreateCell(1).SetCellValue(kvp.Key);

                IRow headerRow = sheet.CreateRow(1);    // ヘッダー行を作成
                int i = 0;
                foreach (var header in Vals.researchResultHeaders)
                {
                    headerRow.CreateCell(i).SetCellValue(header);
                    i++;
                }

                int j = 2;
                double totalSize = 0.0;

                if (!oldResultFiles.TryGetValue(kvp.Key, out List&lt;ResearchFileInfo&gt;? oldValue))
                {
                    foreach (var result in kvp.Value)
                    {
                        IRow row = sheet.CreateRow(j);
                        int col = 0;
                        row.CreateCell(col).SetCellValue(result.No);
                        row.CreateCell(++col).SetCellValue(result.FolderName);
                        row.CreateCell(++col).SetCellValue(result.FileName);
                        row.CreateCell(++col).SetCellValue(result.Size);
                        row.CreateCell(++col).SetCellValue(result.LastModified);
                        row.CreateCell(++col).SetCellValue(result.CreatedDate);
                        row.CreateCell(++col).SetCellValue(result.Group);
                        j++;
                        totalSize += result.Size;
                    }
                }
                else
                {
                    foreach (var result in kvp.Value)
                    {
                        if (!oldValue.Any(item =&gt; item.FileName == result.FileName))
                        {
                            IRow row = sheet.CreateRow(j);
                            int col = 0;
                            row.CreateCell(col).SetCellValue(result.No);
                            row.CreateCell(++col).SetCellValue(result.FolderName);
                            row.CreateCell(++col).SetCellValue(result.FileName);
                            row.CreateCell(++col).SetCellValue(result.Size);
                            row.CreateCell(++col).SetCellValue(result.LastModified);
                            row.CreateCell(++col).SetCellValue(result.CreatedDate);
                            row.CreateCell(++col).SetCellValue(result.Group);
                            j++;
                            totalSize += result.Size;
                        }
                    }
                }

                //summaryシートへの記載
                summaryRow = summarySheet.CreateRow(++summaryCnt);
                summaryRow.CreateCell(0).SetCellValue("分類" + (groupCnt + 1) + ":");
                summaryRow.CreateCell(1).SetCellValue(kvp.Key);
                ICell cell = summaryRow.CreateCell(2);
                cell.SetCellValue(j - 2);
                cell.CellStyle = fileCellStyle;
                cell = summaryRow.CreateCell(3);
                cell.SetCellValue(totalSize);
                cell.CellStyle = sizeCellStyle;

                groupCnt++;
            }

            for (int i = 0; i &lt; 4; i++)
            {
                summarySheet.AutoSizeColumn(i);
                double currentWidth = summarySheet.GetColumnWidth(i);
                double newWidth = currentWidth * 1.6;   // 列の幅を1.6倍に設定し直す
                summarySheet.SetColumnWidth(i, newWidth);
            }

            using var fs = new FileStream(saveFilePath, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }
        #endregion
    }

    public enum ResearchGroupingTypes
    {
        TopFolders,
        KeyWords,
        None
    }

    public enum ResearchFileTypes
    {
        None,
        Extension
    }
}
            </code></pre>

            <p>
                MainWindow.xaml
            </p>
            <pre><code class="prettyprint">
                &lt;Window x:Class="DataManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DataManager"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Style="{StaticResource MaterialDesignWindow}"
        Title="DataManager" Height="750" Width="1100"
        MinHeight="750" MinWidth="1100"&gt;
    
    &lt;Window.DataContext&gt;
        &lt;local:MainViewModel /&gt;
    &lt;/Window.DataContext&gt;

    &lt;Window.Resources&gt;
        &lt;!-- ListView内のプログレスバー用のカスタムスタイル --&gt;
        &lt;Style x:Key="CustomProgressBarStyle" TargetType="ProgressBar" BasedOn="{StaticResource MaterialDesignLinearProgressBar}"&gt;
            &lt;Setter Property="Foreground" Value="LightGreen"/&gt;
            &lt;Setter Property="Background" Value="Green"/&gt;
            &lt;Setter Property="BorderBrush" Value="Transparent"/&gt;
            &lt;Setter Property="Width" Value="70"/&gt;
            &lt;Setter Property="Height" Value="25"/&gt;
            &lt;Setter Property="Margin" Value="-5 -5 -5 -5"/&gt;
            &lt;Setter Property="Padding" Value="0 0 0 0"/&gt;
        &lt;/Style&gt;

        &lt;Storyboard x:Key="FlipAnimation" Completed="FlipAnimation_Completed"&gt;
            &lt;DoubleAnimation Storyboard.TargetName="flipperClassic" 
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)" 
                             From="0" To="180" Duration="0:0:0.3" /&gt;
        &lt;/Storyboard&gt;
    &lt;/Window.Resources&gt;

    &lt;Grid&gt;
        &lt;!-- 行の定義 --&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="Auto" /&gt;
            &lt;RowDefinition Height="*" /&gt;
        &lt;/Grid.RowDefinitions&gt;

        &lt;Menu Grid.Row="0" Grid.ColumnSpan="2" Margin="0,0,0,24"&gt;
            &lt;MenuItem Header="ファイル(_F)" Height="24"&gt;
                &lt;MenuItem Header="設定を開く" /&gt;
                &lt;MenuItem Header="設定を保存する" /&gt;
                &lt;!--You can set the highlighted color with:materialDesign:MenuItemAssist.HighlightedBackground="Fuchsia"--&gt;
                &lt;!--&lt;MenuItem Header="Save" Icon="{materialDesign:PackIcon Kind=ContentSave}" /&gt;
                &lt;MenuItem Header="Save As.." /&gt;--&gt;
                &lt;!--&lt;MenuItem Header="Exit" Icon="{materialDesign:PackIcon Kind=ExitToApp}" InputGestureText="Ctrl+E" /&gt;--&gt;
                &lt;Separator /&gt;
                &lt;MenuItem Header="終了" /&gt;
                &lt;!--&lt;MenuItem Header="Excellent" IsCheckable="True" IsChecked="True" /&gt;
                &lt;MenuItem Header="Rubbish" IsCheckable="True" /&gt;
                &lt;MenuItem Header="Dig Deeper" InputGestureText="Ctrl+D"&gt;
                    &lt;MenuItem Header="Enlightenment?" IsCheckable="True" /&gt;
                    &lt;MenuItem Header="Disappointment" IsCheckable="True" /&gt;
                &lt;/MenuItem&gt;
                &lt;MenuItem Header="Look Deeper" InputGestureText="Ctrl+D"&gt;
                    &lt;MenuItem Header="Plain" /&gt;
                    &lt;MenuItem Header="Ice Cream" /&gt;
                &lt;/MenuItem&gt;--&gt;
            &lt;/MenuItem&gt;
            &lt;MenuItem Header="ヘルプ(_H)" Height="24"&gt;
                &lt;MenuItem Header="バージョン情報(_V)" /&gt;
                &lt;MenuItem Header="使い方(_U)" /&gt;
                &lt;!--&lt;MenuItem Command="Cut" Header="_Cut" Icon="{materialDesign:PackIcon Kind=ContentCut}" /&gt;
                &lt;MenuItem Command="Copy" Header="_Copy" Icon="{materialDesign:PackIcon Kind=ContentCopy}" /&gt;
                &lt;MenuItem Command="Paste" Header="_Paste" Icon="{materialDesign:PackIcon Kind=ContentPaste}" /&gt;--&gt;
            &lt;/MenuItem&gt;
        &lt;/Menu&gt;

        &lt;materialDesign:Card Grid.ColumnSpan="2" Margin="0,24,0,0" Grid.RowSpan="2"&gt;
            &lt;TabControl VerticalContentAlignment="Top" materialDesign:ColorZoneAssist.Mode="PrimaryMid" 
                        Style="{StaticResource MaterialDesignNavigationRailTabControl}"
                        SelectedIndex="{Binding TabIndex}"&gt;
                &lt;!--Home--&gt;
                &lt;TabItem&gt;
                    &lt;TabItem.Header&gt;
                        &lt;StackPanel Width="auto" Height="auto"&gt;
                            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="Home" /&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="Home" /&gt;
                        &lt;/StackPanel&gt;
                    &lt;/TabItem.Header&gt;

                    &lt;materialDesign:Transitioner AutoApplyTransitionOrigins="True" SelectedIndex="{Binding SlideIndex}"&gt;
                        &lt;materialDesign:Transitioner.InputBindings&gt;
                            &lt;KeyBinding Key="Left" Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}"/&gt;
                            &lt;KeyBinding Key="Right" Command="{x:Static materialDesign:Transitioner.MoveNextCommand}"/&gt;
                        &lt;/materialDesign:Transitioner.InputBindings&gt;

                        &lt;!--スタート画面--&gt;
                        &lt;materialDesign:TransitionerSlide&gt;
                            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
                            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
                            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
                            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;
                            
                            &lt;Grid&gt;
                                &lt;Grid&gt;
                                    &lt;Grid.RowDefinitions&gt;
                                        &lt;RowDefinition Height="auto" /&gt;
                                        &lt;RowDefinition Height="auto" /&gt;
                                        &lt;RowDefinition Height="*" /&gt;
                                        &lt;RowDefinition Height="*" /&gt;
                                        &lt;RowDefinition Height="auto" /&gt;
                                    &lt;/Grid.RowDefinitions&gt;

                                    &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                                        &lt;TextBlock HorizontalAlignment="Center" Text="スタート" FontSize="16" TextWrapping="Wrap"/&gt;
                                    &lt;/materialDesign:Card&gt;

                                    &lt;!--モード切り替え--&gt;
                                    &lt;StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                                        &lt;materialDesign:FlipperClassic x:Name="flipperClassic" IsFlipped="{Binding IsFlipped, Mode=TwoWay}"
                                                                       ToolTip="簡易モードとデータ管理モードの切り替え"&gt;
                                            &lt;materialDesign:FlipperClassic.FrontContent&gt;
                                                &lt;Button Width="184" Margin="8" Background="MistyRose"
                                                        BorderBrush="Firebrick" BorderThickness="1"
                                                        materialDesign:ButtonAssist.CornerRadius="8"
                                                        Command="{x:Static materialDesign:FlipperClassic.FlipCommand}"
                                                        Content="簡易モード"
                                                        Style="{StaticResource MaterialDesignFlatButton}"/&gt;
                                            &lt;/materialDesign:FlipperClassic.FrontContent&gt;
                                            &lt;materialDesign:FlipperClassic.BackContent&gt;
                                                &lt;Button Width="184" Margin="8" Background="Honeydew"
                                                        BorderBrush="DarkGreen" BorderThickness="1"
                                                        materialDesign:ButtonAssist.CornerRadius="8"
                                                        Command="{x:Static materialDesign:FlipperClassic.FlipCommand}"
                                                        Content="データ管理モード"
                                                        Style="{StaticResource MaterialDesignFlatButton}"/&gt;
                                            &lt;/materialDesign:FlipperClassic.BackContent&gt;
                                        &lt;/materialDesign:FlipperClassic&gt;
                                    &lt;/StackPanel&gt;

                                    &lt;!--通常使用モードのボタン群--&gt;
                                    &lt;materialDesign:Card Grid.Row="2" Background="MistyRose" BorderBrush="Firebrick" BorderThickness="1" 
                                         Margin="4 4 4 4" IsEnabled="{Binding IsDataManegementCardEnabled, Converter={StaticResource InvertBooleanConverter}}"&gt;
                                        &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectLogToExcelTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="FileExcelOutline" /&gt;
                                                    &lt;TextBlock Text="ログエクセル変換" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectDataConvertTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="FileArrowLeftRightOutline" /&gt;
                                                    &lt;TextBlock Text="データ変換" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectDecompressTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ArrowSplitHorizontal" /&gt;
                                                    &lt;TextBlock Text="解凍" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectCompressTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical" HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ArrowCollapseVertical" /&gt;
                                                    &lt;TextBlock Text="圧縮" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectSeverCheckTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical" HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ServerNetwork" /&gt;
                                                    &lt;TextBlock Text="サーバーデータチェック" FontSize="18"  HorizontalAlignment="Center" TextAlignment="Center" TextWrapping="Wrap"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                        &lt;/StackPanel&gt;
                                    &lt;/materialDesign:Card&gt;

                                    &lt;!--データ管理モードのボタン群--&gt;
                                    &lt;materialDesign:Card Grid.Row="3" Background="Honeydew" BorderBrush="DarkGreen" BorderThickness="1"
                                         Margin="4 4 4 4" IsEnabled="{Binding IsDataManegementCardEnabled}"&gt;
                                        &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectLogToExcelTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="FileExcelOutline" /&gt;
                                                    &lt;TextBlock Text="ログエクセル変換" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectDataConvertTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="FileArrowLeftRightOutline" /&gt;
                                                    &lt;TextBlock Text="データ変換" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectDataManegementTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="Database" /&gt;
                                                    &lt;TextBlock Text="データ管理" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectDataExtractTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical" HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ChartBar" /&gt;
                                                    &lt;TextBlock Text="データ抽出" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                                    Command="{Binding SelectSeverCheckTabCommand}"&gt;
                                                &lt;StackPanel Orientation="Vertical" HorizontalAlignment="Center"&gt;
                                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ServerNetwork" /&gt;
                                                    &lt;TextBlock Text="サーバーデータチェック" FontSize="18"  HorizontalAlignment="Center" TextAlignment="Center" TextWrapping="Wrap"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Button&gt;
                                        &lt;/StackPanel&gt;
                                    &lt;/materialDesign:Card&gt;

                                    &lt;!--切り替えボタン群--&gt;
                                    &lt;StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Center" IsEnabled="{Binding IsDataManegementCardEnabled}"&gt;
                                        &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}" IsEnabled="False"&gt;
                                            &lt;materialDesign:PackIcon Kind="ArrowLeftThick" Width="30" Height="30"/&gt;
                                        &lt;/Button&gt;
                                        &lt;Button Margin="4 4 4 8" Command="{Binding SelectFirstSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}" IsEnabled="False"&gt;
                                            &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                                        &lt;/Button&gt;
                                        &lt;Button Margin="4 4 4 8" Command="{Binding SelectUserSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                            &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                                        &lt;/Button&gt;
                                        &lt;Button Margin="4 4 4 8" Command="{Binding SelectSaveSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                            &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                                        &lt;/Button&gt;
                                        &lt;Button Margin="4 4 4 8" Command="{Binding SelectFTPSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                            &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                                        &lt;/Button&gt;
                                        &lt;Button Margin="4 4 4 8" Command="{Binding SelectScheduleSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                            &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                                        &lt;/Button&gt;
                                        &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MoveNextCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                            &lt;materialDesign:PackIcon Kind="ArrowRightThick" Width="30" Height="30"/&gt;
                                        &lt;/Button&gt;
                                    &lt;/StackPanel&gt;
                                &lt;/Grid&gt;
                            &lt;/Grid&gt;
                        &lt;/materialDesign:TransitionerSlide&gt;

                        &lt;!--ユーザー設定画面--&gt;
                        &lt;materialDesign:TransitionerSlide&gt;
                            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
                            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
                            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
                            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;

                            &lt;Grid&gt;
                                &lt;Grid.RowDefinitions&gt;
                                    &lt;RowDefinition Height="auto" /&gt;
                                    &lt;RowDefinition Height="*" /&gt;
                                    &lt;RowDefinition Height="auto" /&gt;
                                &lt;/Grid.RowDefinitions&gt;

                                &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                                    &lt;TextBlock HorizontalAlignment="Center" Text="ユーザー設定" FontSize="16" TextWrapping="Wrap"/&gt;
                                &lt;/materialDesign:Card&gt;

                                &lt;!-- 中央のグリッド --&gt;
                                &lt;Grid Grid.Row="1"&gt;
                                    &lt;ScrollViewer VerticalScrollBarVisibility="Auto"&gt;
                                        &lt;StackPanel Orientation="Vertical"&gt;
                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item1" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item2" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item3" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item4" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item5" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;
                                        &lt;/StackPanel&gt;
                                    &lt;/ScrollViewer&gt;
                                &lt;/Grid&gt;

                                &lt;StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="ArrowLeftThick" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectFirstSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectUserSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}" IsEnabled="False"&gt;
                                        &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectSaveSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectFTPSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectScheduleSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MoveNextCommand}"  Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="ArrowRightThick" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Grid&gt;
                        &lt;/materialDesign:TransitionerSlide&gt;

                        &lt;!--保存先設定--&gt;
                        &lt;materialDesign:TransitionerSlide&gt;
                            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
                            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
                            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
                            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;

                            &lt;Grid&gt;
                                &lt;Grid.RowDefinitions&gt;
                                    &lt;RowDefinition Height="auto" /&gt;
                                    &lt;RowDefinition Height="*" /&gt;
                                    &lt;RowDefinition Height="auto" /&gt;
                                &lt;/Grid.RowDefinitions&gt;

                                &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                                    &lt;TextBlock HorizontalAlignment="Center" Text="保存先設定" FontSize="16" TextWrapping="Wrap"/&gt;
                                &lt;/materialDesign:Card&gt;

                                &lt;!-- 中央のグリッド --&gt;
                                &lt;Grid Grid.Row="1"&gt;
                                    &lt;ScrollViewer VerticalScrollBarVisibility="Auto"&gt;
                                        &lt;StackPanel Orientation="Vertical"&gt;
                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item1" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item2" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item3" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item4" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item5" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;
                                        &lt;/StackPanel&gt;
                                    &lt;/ScrollViewer&gt;
                                &lt;/Grid&gt;

                                &lt;StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="SkipPrevious" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectFirstSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectUserSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectSaveSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}" IsEnabled="False"&gt;
                                        &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectFTPSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectScheduleSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MoveNextCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="SkipNext" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Grid&gt;
                        &lt;/materialDesign:TransitionerSlide&gt;

                        &lt;!--FTP設定--&gt;
                        &lt;materialDesign:TransitionerSlide&gt;
                            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
                            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
                            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
                            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;

                            &lt;Grid&gt;
                                &lt;Grid.RowDefinitions&gt;
                                    &lt;RowDefinition Height="auto" /&gt;
                                    &lt;RowDefinition Height="*" /&gt;
                                    &lt;RowDefinition Height="auto" /&gt;
                                &lt;/Grid.RowDefinitions&gt;

                                &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                                    &lt;TextBlock HorizontalAlignment="Center" Text="FTP設定" FontSize="16" TextWrapping="Wrap"/&gt;
                                &lt;/materialDesign:Card&gt;

                                &lt;!-- 中央のグリッド --&gt;
                                &lt;Grid Grid.Row="1"&gt;
                                    &lt;ScrollViewer VerticalScrollBarVisibility="Auto"&gt;
                                        &lt;StackPanel Orientation="Vertical"&gt;
                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item1" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item2" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item3" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item4" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item5" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;
                                        &lt;/StackPanel&gt;
                                    &lt;/ScrollViewer&gt;
                                &lt;/Grid&gt;

                                &lt;StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="SkipPrevious" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectFirstSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectUserSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectSaveSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectFTPSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}" IsEnabled="False"&gt;
                                        &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectScheduleSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MoveNextCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="SkipNext" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Grid&gt;
                        &lt;/materialDesign:TransitionerSlide&gt;

                        &lt;!--スケジューラー設定--&gt;
                        &lt;materialDesign:TransitionerSlide&gt;
                            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
                            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
                            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
                            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                                &lt;materialDesign:CircleWipe /&gt;
                                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
                            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;
                            &lt;Grid&gt;
                                &lt;Grid.RowDefinitions&gt;
                                    &lt;RowDefinition Height="auto" /&gt;
                                    &lt;RowDefinition Height="*" /&gt;
                                    &lt;RowDefinition Height="auto" /&gt;
                                &lt;/Grid.RowDefinitions&gt;

                                &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                                    &lt;TextBlock HorizontalAlignment="Center" Text="スケジューラー設定" FontSize="16" TextWrapping="Wrap"/&gt;
                                &lt;/materialDesign:Card&gt;

                                &lt;!-- 中央のグリッド --&gt;
                                &lt;Grid Grid.Row="1"&gt;
                                    &lt;ScrollViewer VerticalScrollBarVisibility="Auto"&gt;
                                        &lt;StackPanel Orientation="Vertical"&gt;
                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item1" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item2" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item3" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item4" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;

                                            &lt;Border BorderBrush="Gray" BorderThickness="0,0.5,0,0.5" Margin="5" /&gt;

                                            &lt;Grid&gt;
                                                &lt;Grid.ColumnDefinitions&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="auto"/&gt;
                                                    &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;/Grid.ColumnDefinitions&gt;
                                                &lt;TextBlock Grid.Column="0" Text="Item5" Width="150" TextAlignment="Center" Margin="10" FontWeight="Bold" FontSize="20"/&gt;
                                                &lt;Border Grid.Column="1" BorderBrush="Gray" BorderThickness="0.25,0,0.25,0" Margin="5" /&gt;
                                                &lt;StackPanel Grid.Column="2"&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                    &lt;TextBlock Text="test" TextAlignment="Center" Margin="10"/&gt;
                                                &lt;/StackPanel&gt;
                                            &lt;/Grid&gt;
                                        &lt;/StackPanel&gt;
                                    &lt;/ScrollViewer&gt;
                                &lt;/Grid&gt;

                                &lt;StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="SkipPrevious" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectFirstSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectUserSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectSaveSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectFTPSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}"&gt;
                                        &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{Binding SelectScheduleSlideCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}" IsEnabled="False" &gt;
                                        &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                    &lt;Button Margin="4 4 4 8" Command="{x:Static materialDesign:Transitioner.MoveNextCommand}" Style="{StaticResource MaterialDesignFloatingActionLightButton}" IsEnabled="False"&gt;
                                        &lt;materialDesign:PackIcon Kind="SkipNext" Width="30" Height="30"/&gt;
                                    &lt;/Button&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Grid&gt;
                        &lt;/materialDesign:TransitionerSlide&gt;
                    &lt;/materialDesign:Transitioner&gt;

                &lt;/TabItem&gt;

                &lt;!--ログ--&gt;
                &lt;TabItem&gt;
                    &lt;TabItem.Header&gt;
                        &lt;StackPanel Width="auto" Height="auto"&gt;
                            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="FileExcelOutline" /&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="ログ" /&gt;
                        &lt;/StackPanel&gt;
                    &lt;/TabItem.Header&gt;

                    &lt;Grid&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto" /&gt;
                            &lt;RowDefinition Height="auto" /&gt;
                            &lt;RowDefinition Height="*" /&gt;
                            &lt;RowDefinition Height="*" /&gt;
                            &lt;RowDefinition Height="auto" /&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="エクセルログ変換" FontSize="16" TextWrapping="Wrap"/&gt;
                        &lt;/materialDesign:Card&gt;
                    &lt;/Grid&gt;
                &lt;/TabItem&gt;

                &lt;!--変換--&gt;
                &lt;TabItem&gt;
                    &lt;TabItem.Header&gt;
                        &lt;StackPanel Width="auto" Height="auto"&gt;
                            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="FileArrowLeftRightOutline" /&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="変換" /&gt;
                        &lt;/StackPanel&gt;
                    &lt;/TabItem.Header&gt;
                    &lt;StackPanel Margin="16"&gt;
                        &lt;TextBlock Margin="0,0,0,8" Style="{StaticResource MaterialDesignHeadline5TextBlock}" Text="さまざまなデータを指定の形式に変換" /&gt;

                    &lt;/StackPanel&gt;
                &lt;/TabItem&gt;

                &lt;!--管理--&gt;
                &lt;TabItem&gt;
                    &lt;TabItem.Header&gt;
                        &lt;StackPanel Width="auto" Height="auto"&gt;
                            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="Database" /&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="管理" /&gt;
                        &lt;/StackPanel&gt;
                    &lt;/TabItem.Header&gt;

                    &lt;local:ManegementTab /&gt;
                    &lt;!--&lt;Grid&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="データ管理" FontSize="16" TextWrapping="Wrap"/&gt;
                        &lt;/materialDesign:Card&gt;

                        &lt;Grid Grid.Row="1"&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="*"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;

                            &lt;Grid Grid.Column="0"&gt;
                                &lt;Grid.RowDefinitions&gt;
                                    &lt;RowDefinition Height="auto"/&gt;
                                    &lt;RowDefinition Height="*"/&gt;
                                    &lt;RowDefinition Height="auto"/&gt;
                                &lt;/Grid.RowDefinitions&gt;

                                &lt;ListBox x:Name="RadioButtonGroupChoiceChipPrimaryOutline"
                                         Style="{StaticResource MaterialDesignChoiceChipPrimaryOutlineListBox}"
                                         ItemsSource="{Binding Modes}" SelectedItem="{Binding SelectedMode}"
                                         Margin="4 4 4 4" IsEnabled="{Binding IsDataManegementEnabled}"&gt;
                                    &lt;ListBox.ItemTemplate&gt;
                                        &lt;DataTemplate&gt;
                                            &lt;TextBlock Text="{Binding}" /&gt;
                                        &lt;/DataTemplate&gt;
                                    &lt;/ListBox.ItemTemplate&gt;
                                &lt;/ListBox&gt;

                                &lt;Grid Grid.Row="1"&gt;
                                    &lt;Grid.ColumnDefinitions&gt;
                                        &lt;ColumnDefinition Width="auto"/&gt;
                                        &lt;ColumnDefinition Width="auto"/&gt;
                                        &lt;ColumnDefinition Width="auto"/&gt;
                                        &lt;ColumnDefinition Width="auto"/&gt;
                                        &lt;ColumnDefinition Width="auto"/&gt;
                                    &lt;/Grid.ColumnDefinitions&gt;

                                    &lt;Grid Grid.Column="0"&gt;
                                        &lt;Grid.RowDefinitions&gt;
                                            &lt;RowDefinition Height="auto"/&gt;
                                            &lt;RowDefinition Height="auto"/&gt;
                                            &lt;RowDefinition Height="*"/&gt;
                                            &lt;RowDefinition Height="auto"/&gt;
                                        &lt;/Grid.RowDefinitions&gt;

                                        &lt;TextBlock Text="Product" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                                            &lt;Button Command="{Binding AddProductCommand}" HorizontalAlignment="Center" 
                                                    Width="90" Margin="2 4 2 4" Content="Add" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                            &lt;TextBox Height="29"  Margin="6 2 6 2" Text="{Binding NewProductText, UpdateSourceTrigger=PropertyChanged}"
                                                     Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="ProductTextBox_KeyDown"
                                                     IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                        &lt;/StackPanel&gt;

                                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                                                 BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                                                 ItemsSource="{Binding Products}" SelectedItem="{Binding SelectedProduct}" 
                                                 SelectedIndex="{Binding SelectedProductIndex}" Style="{StaticResource MaterialDesignListBox}"
                                                 ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                                            &lt;ListBox.ItemTemplate&gt;
                                                &lt;DataTemplate&gt;
                                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                                &lt;/DataTemplate&gt;
                                            &lt;/ListBox.ItemTemplate&gt;
                                        &lt;/ListBox&gt;

                                        &lt;Button Grid.Row="3" Command="{Binding RemoveProductCommand}" HorizontalAlignment="Center" 
                                                Width="90" Margin="2 2 2 8" Content="Del" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                    &lt;/Grid&gt;

                                    &lt;Grid Grid.Column="1"&gt;
                                        &lt;Grid.RowDefinitions&gt;
                                            &lt;RowDefinition Height="auto"/&gt;
                                            &lt;RowDefinition Height="auto"/&gt;
                                            &lt;RowDefinition Height="*"/&gt;
                                            &lt;RowDefinition Height="auto"/&gt;
                                        &lt;/Grid.RowDefinitions&gt;

                                        &lt;TextBlock Text="Type" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                                            &lt;Button Command="{Binding AddTypeCommand}" HorizontalAlignment="Center" 
                                                    Width="90" Margin="2 4 2 4" Content="Add" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                            &lt;TextBox Height="29" Margin="6 2 6 2" Text="{Binding NewTypeText, UpdateSourceTrigger=PropertyChanged}"
                                                     Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="TypeTextBox_KeyDown"
                                                     IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                        &lt;/StackPanel&gt;

                                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                                                 BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                                                 ItemsSource="{Binding Types}" SelectedItem="{Binding SelectedType}" 
                                                 SelectedIndex="{Binding SelectedTypeIndex}" Style="{StaticResource MaterialDesignListBox}"
                                                 ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                                            &lt;ListBox.ItemTemplate&gt;
                                                &lt;DataTemplate&gt;
                                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                                &lt;/DataTemplate&gt;
                                            &lt;/ListBox.ItemTemplate&gt;
                                        &lt;/ListBox&gt;

                                        &lt;Button Grid.Row="3" Command="{Binding RemoveTypeCommand}" HorizontalAlignment="Center" 
                                                Width="90" Margin="2 2 2 8" Content="Del" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                    &lt;/Grid&gt;

                                    &lt;Grid Grid.Column="2"&gt;
                                        &lt;Grid.RowDefinitions&gt;
                                            &lt;RowDefinition Height="auto"/&gt;
                                            &lt;RowDefinition Height="auto"/&gt;
                                            &lt;RowDefinition Height="*"/&gt;
                                            &lt;RowDefinition Height="auto"/&gt;
                                        &lt;/Grid.RowDefinitions&gt;

                                        &lt;TextBlock Text="Ver" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                                            &lt;Button Command="{Binding AddVerCommand}" HorizontalAlignment="Center" 
                                                    Width="90" Margin="2 4 2 4" Content="Add" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                            &lt;TextBox Height="29" Margin="6 2 6 2" Text="{Binding NewVerText, UpdateSourceTrigger=PropertyChanged}"
                                                     Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="VerTextBox_KeyDown"
                                                     IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                        &lt;/StackPanel&gt;

                                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                                                 BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                                                 ItemsSource="{Binding Vers}" SelectedItem="{Binding SelectedVer}" 
                                                 SelectedIndex="{Binding SelectedVerIndex}" Style="{StaticResource MaterialDesignListBox}" ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                                            &lt;ListBox.ItemTemplate&gt;
                                                &lt;DataTemplate&gt;
                                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                                &lt;/DataTemplate&gt;
                                            &lt;/ListBox.ItemTemplate&gt;
                                        &lt;/ListBox&gt;

                                        &lt;Button Grid.Row="3" Command="{Binding RemoveVerCommand}" HorizontalAlignment="Center" 
                                                Width="90" Margin="2 2 2 8" Content="Del" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                    &lt;/Grid&gt;
                                &lt;/Grid&gt;
                            &lt;/Grid&gt;

                            &lt;Grid Grid.Column="1"&gt;
                                &lt;Grid.RowDefinitions&gt;
                                    &lt;RowDefinition Height="auto"/&gt;
                                    &lt;RowDefinition Height="*"/&gt;
                                &lt;/Grid.RowDefinitions&gt;

                                &lt;StackPanel Orientation="Horizontal"&gt;
                                    &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                                        &lt;TextBlock Text="DataList" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" VerticalAlignment="Top"/&gt;
                                        &lt;Button Command="{Binding AddDataListCommand}" HorizontalAlignment="Center" 
                                                Width="90" Margin="6 4 2 2" Content="Add" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                        &lt;Button Command="{Binding EditDataListCommand}" HorizontalAlignment="Center" 
                                                Width="90" Margin="6 2 2 4" Content="Edit" IsEnabled="{Binding IsDataManegementEnabled}" 
                                                materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsDataListEditing}"
                                                materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsDataListEditing}"
                                                materialDesign:ButtonProgressAssist.Value="{Binding EditDataListStatus}"/&gt;
                                        &lt;Button Command="{Binding RemoveDataListCommand}" HorizontalAlignment="Center" 
                                                Width="90" Margin="6 2 2 4" Content="Del" IsEnabled="{Binding IsDataManegementEnabled}" 
                                                materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsDataListRemoving}"
                                                materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsDataListRemoving}"
                                                materialDesign:ButtonProgressAssist.Value="{Binding RemoveDataListStatus}"/&gt;
                                    &lt;/StackPanel&gt;

                                    &lt;GroupBox Height="136" Width="300" Margin="4 8 4 4" Padding="0"
                                              Header="Infomation" IsEnabled="{Binding IsDataManegementEnabled}"
                                              materialDesign:GroupBoxAssist.HeaderPadding="4"
                                              Style="{StaticResource MaterialDesignGroupBox}"&gt;
                                        &lt;ScrollViewer Padding="4" materialDesign:ScrollViewerAssist.PaddingMode="Content"&gt;
                                            &lt;StackPanel&gt;
                                                &lt;TextBlock Margin="4" TextWrapping="Wrap" Text="{Binding DataItemInfo}" /&gt;
                                            &lt;/StackPanel&gt;
                                        &lt;/ScrollViewer&gt;
                                    &lt;/GroupBox&gt;

                                    &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                                        &lt;Grid&gt;
                                            &lt;Grid.ColumnDefinitions&gt;
                                                &lt;ColumnDefinition Width="*"/&gt;
                                                &lt;ColumnDefinition Width="*"/&gt;
                                            &lt;/Grid.ColumnDefinitions&gt;
                                            &lt;Button Grid.Column="0" Margin="6 0 0 0" Padding="4 0 4 0"
                                                    HorizontalAlignment="Left" VerticalAlignment="Bottom"
                                                    Command="{Binding ApplyFilterCommand}" Content="Filtering"
                                                    Style="{StaticResource MaterialDesignFlatButton}" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                            &lt;Button Grid.Column="1" Margin="0 0 8 0" Padding="4 0 4 0"
                                                    HorizontalAlignment="Right" VerticalAlignment="Bottom"
                                                    Command="{Binding ClearFilterCommand}" Content="Clear"
                                                    Style="{StaticResource MaterialDesignFlatButton}" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                                        &lt;/Grid&gt;

                                        &lt;ComboBox Margin="4 4 4 4" Width="150" Height="40"
                                                  materialDesign:HintAssist.Hint="Header" IsEnabled="{Binding IsDataManegementEnabled}"
                                                  Style="{StaticResource MaterialDesignFilledComboBox}"
                                                  ItemsSource="{Binding Headers}" SelectedItem="{Binding SelectedHeaderKey}"&gt;
                                            &lt;ComboBox.ItemTemplate&gt;
                                                &lt;DataTemplate&gt;
                                                    &lt;TextBlock Text="{Binding}" /&gt;
                                                &lt;/DataTemplate&gt;
                                            &lt;/ComboBox.ItemTemplate&gt;
                                        &lt;/ComboBox&gt;
                                        &lt;TextBox Margin="4 4 4 4" Width="150" Height="40" VerticalAlignment="Top"
                                                 Padding="8 -8 0 -8" IsEnabled="{Binding IsDataManegementEnabled}"
                                                 materialDesign:HintAssist.Hint="Filter" KeyDown="FilterTextBox_KeyDown"
                                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                                 Text="{Binding FilterValue, UpdateSourceTrigger=PropertyChanged}"/&gt;
                                    &lt;/StackPanel&gt;
                                &lt;/StackPanel&gt;

                                &lt;Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" Margin="4 1 4 4"&gt;
                                    &lt;DataGrid VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.VirtualizationMode="Recycling" 
                                              EnableRowVirtualization="True" EnableColumnVirtualization="True"
                                              CanUserAddRows="False" AutoGenerateColumns="False" IsEnabled="{Binding IsDataManegementEnabled}"
                                              ItemsSource="{Binding DataItems, Mode=TwoWay}" SelectionMode="Extended"
                                              SelectedItem="{Binding SelectedDataItem}" SelectionChanged="DataItem_SelectionChanged"
                                              AllowDrop="True" Drop="DataGrid_Drop" CellEditEnding="DataGrid_CellEditEnding"&gt;
                                        &lt;DataGrid.RowStyle&gt;
                                            &lt;Style TargetType="{x:Type DataGridRow}" BasedOn="{StaticResource {x:Type DataGridRow}}"&gt;
                                                &lt;Setter Property="IsSelected" Value="{Binding IsSelected,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/&gt;
                                            &lt;/Style&gt;
                                        &lt;/DataGrid.RowStyle&gt;
                                        &lt;DataGrid.Columns&gt;
                                            --&gt;&lt;!--*** No ***--&gt;&lt;!--
                                            &lt;DataGridTextColumn Header="No" Binding="{Binding No}" IsReadOnly="True"/&gt;
                                            --&gt;&lt;!--*** DataName ***--&gt;&lt;!--
                                            &lt;DataGridTextColumn Header="DataName" Binding="{Binding DataName}" IsReadOnly="True"/&gt;
                                            --&gt;&lt;!--*** Link ***--&gt;&lt;!--
                                            &lt;DataGridTemplateColumn Header="Link" IsReadOnly="True" Width="100"&gt;
                                                &lt;DataGridTemplateColumn.CellTemplate&gt;
                                                    &lt;DataTemplate&gt;
                                                        &lt;TextBlock&gt; 
                                                            &lt;Hyperlink NavigateUri="{Binding Link}" RequestNavigate="Hyperlink_RequestNavigate"&gt; 
                                                                &lt;TextBlock Text="{Binding Link}"/&gt; 
                                                            &lt;/Hyperlink&gt; 
                                                        &lt;/TextBlock&gt;
                                                    &lt;/DataTemplate&gt;
                                                &lt;/DataGridTemplateColumn.CellTemplate&gt;
                                            &lt;/DataGridTemplateColumn&gt;
                                            --&gt;&lt;!--*** Product ***--&gt;&lt;!--
                                            &lt;materialDesign:DataGridTextColumn
                                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                                Header="Product"&gt;
                                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                                    &lt;Binding Path="Product"&gt;
                                                        &lt;Binding.ValidationRules&gt;
                                                            &lt;local:NotEmptyValidationRule /&gt;
                                                        &lt;/Binding.ValidationRules&gt;
                                                    &lt;/Binding&gt;
                                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                                            &lt;/materialDesign:DataGridTextColumn&gt;
                                            --&gt;&lt;!--*** Type ***--&gt;&lt;!--
                                            &lt;materialDesign:DataGridTextColumn
                                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                                Header="Type"&gt;
                                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                                    &lt;Binding Path="Type"&gt;
                                                        &lt;Binding.ValidationRules&gt;
                                                            &lt;local:NotEmptyValidationRule /&gt;
                                                        &lt;/Binding.ValidationRules&gt;
                                                    &lt;/Binding&gt;
                                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                                            &lt;/materialDesign:DataGridTextColumn&gt;
                                            --&gt;&lt;!--*** Ver ***--&gt;&lt;!--
                                            &lt;materialDesign:DataGridTextColumn
                                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                                Header="Ver"&gt;
                                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                                    &lt;Binding Path="Ver"&gt;
                                                        &lt;Binding.ValidationRules&gt;
                                                            &lt;local:NotEmptyValidationRule /&gt;
                                                        &lt;/Binding.ValidationRules&gt;
                                                    &lt;/Binding&gt;
                                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                                            &lt;/materialDesign:DataGridTextColumn&gt;
                                            --&gt;&lt;!--*** Lot ***--&gt;&lt;!--
                                            &lt;materialDesign:DataGridTextColumn
                                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                                Header="Lot"&gt;
                                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                                    &lt;Binding Path="Lot"&gt;
                                                        &lt;Binding.ValidationRules&gt;
                                                            &lt;local:NotEmptyValidationRule /&gt;
                                                        &lt;/Binding.ValidationRules&gt;
                                                    &lt;/Binding&gt;
                                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                                            &lt;/materialDesign:DataGridTextColumn&gt;
                                            --&gt;&lt;!--*** Slot ***--&gt;&lt;!--
                                            &lt;materialDesign:DataGridTextColumn
                                            EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                            ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                            Header="Slot"&gt;
                                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                                    &lt;Binding Path="Slot"&gt;
                                                        &lt;Binding.ValidationRules&gt;
                                                            &lt;local:NotEmptyValidationRule /&gt;
                                                        &lt;/Binding.ValidationRules&gt;
                                                    &lt;/Binding&gt;
                                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                                            &lt;/materialDesign:DataGridTextColumn&gt;
                                            --&gt;&lt;!--*** LotSlot ***--&gt;&lt;!--
                                            &lt;materialDesign:DataGridTextColumn
                                            EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                            ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                            Header="LotSlot" IsReadOnly="True"&gt;
                                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                                    &lt;Binding Path="LotSlot"&gt;
                                                        &lt;Binding.ValidationRules&gt;
                                                            &lt;local:NotEmptyValidationRule /&gt;
                                                        &lt;/Binding.ValidationRules&gt;
                                                    &lt;/Binding&gt;
                                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                                            &lt;/materialDesign:DataGridTextColumn&gt;
                                            --&gt;&lt;!--*** Program ***--&gt;&lt;!--
                                            &lt;materialDesign:DataGridTextColumn
                                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                                Header="Program"&gt;
                                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                                    &lt;Binding Path="Program"&gt;
                                                        &lt;Binding.ValidationRules&gt;
                                                            &lt;local:NotEmptyValidationRule /&gt;
                                                        &lt;/Binding.ValidationRules&gt;
                                                    &lt;/Binding&gt;
                                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                                            &lt;/materialDesign:DataGridTextColumn&gt;
                                            --&gt;&lt;!--*** Remark ***--&gt;&lt;!--
                                            &lt;materialDesign:DataGridTextColumn
                                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                                Header="Remark"&gt;
                                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                                    &lt;Binding Path="Remark"&gt;
                                                        &lt;Binding.ValidationRules&gt;
                                                            &lt;local:NotEmptyValidationRule /&gt;
                                                        &lt;/Binding.ValidationRules&gt;
                                                    &lt;/Binding&gt;
                                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                                            &lt;/materialDesign:DataGridTextColumn&gt;
                                        &lt;/DataGrid.Columns&gt;
                                    &lt;/DataGrid&gt;

                                    --&gt;&lt;!--&lt;DataGrid ItemsSource="{Binding DataItems}" AutoGenerateColumns="False" CanUserAddRows="False"&gt;
                                        &lt;DataGrid.Columns&gt;
                                            &lt;DataGridTextColumn Header="No" Binding="{Binding No}" IsReadOnly="True"/&gt;
                                            &lt;DataGridTextColumn Header="DataName" Binding="{Binding DataName}" IsReadOnly="True"/&gt;
                                            &lt;DataGridTemplateColumn Header="Link" IsReadOnly="True" Width="100"&gt;
                                                &lt;DataGridTemplateColumn.CellTemplate&gt;
                                                    &lt;DataTemplate&gt;
                                                        &lt;TextBlock&gt; 
                                                            &lt;Hyperlink NavigateUri="{Binding Link}" RequestNavigate="Hyperlink_RequestNavigate"&gt; 
                                                                &lt;TextBlock Text="{Binding Link}"/&gt; 
                                                            &lt;/Hyperlink&gt; 
                                                        &lt;/TextBlock&gt;
                                                    &lt;/DataTemplate&gt;
                                                &lt;/DataGridTemplateColumn.CellTemplate&gt;
                                            &lt;/DataGridTemplateColumn&gt;

                                            --&gt;
                                    &lt;!--可変列をバインディングする--&gt;
                                    &lt;!--&lt;DataGridTemplateColumn Header="Dynamic Columns"&gt;
                                                &lt;DataGridTemplateColumn.CellTemplate&gt;
                                                    &lt;DataTemplate&gt;
                                                        &lt;ItemsControl ItemsSource="{Binding VariableColumns}"&gt;
                                                            &lt;ItemsControl.ItemTemplate&gt;
                                                                &lt;DataTemplate&gt;
                                                                    &lt;TextBox Text="{Binding}" Margin="2"/&gt;
                                                                &lt;/DataTemplate&gt;
                                                            &lt;/ItemsControl.ItemTemplate&gt;
                                                        &lt;/ItemsControl&gt;
                                                    &lt;/DataTemplate&gt;
                                                &lt;/DataGridTemplateColumn.CellTemplate&gt;
                                            &lt;/DataGridTemplateColumn&gt;--&gt;
                                    &lt;!--
                                        &lt;/DataGrid.Columns&gt;
                                    &lt;/DataGrid&gt;--&gt;&lt;!--

                                &lt;/Border&gt;
                            &lt;/Grid&gt;

                            &lt;Grid Grid.Column="2"&gt;
                                &lt;Expander ExpandDirection="Right" IsEnabled="{Binding IsDataManegementEnabled}"&gt;
                                    &lt;Expander.Header&gt;
                                        &lt;TextBlock RenderTransformOrigin=".5,.5" Text="データ選択"&gt;
                                            &lt;TextBlock.LayoutTransform&gt;
                                                &lt;RotateTransform Angle="-90" /&gt;
                                            &lt;/TextBlock.LayoutTransform&gt;
                                        &lt;/TextBlock&gt;
                                    &lt;/Expander.Header&gt;
                                    &lt;StackPanel Margin="8,8,8,8" Orientation="Vertical" TextBlock.Foreground="{DynamicResource MaterialDesignBody}"&gt;
                                        &lt;TextBlock Text="準備中" /&gt;
                                    &lt;/StackPanel&gt;
                                &lt;/Expander&gt;
                            &lt;/Grid&gt;
                        &lt;/Grid&gt;
                    &lt;/Grid&gt;--&gt;
                &lt;/TabItem&gt;

                &lt;!--抽出--&gt;
                &lt;TabItem&gt;
                    &lt;TabItem.Header&gt;
                        &lt;StackPanel Width="auto" Height="auto"&gt;
                            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="ChartBar" /&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="抽出" /&gt;
                        &lt;/StackPanel&gt;
                    &lt;/TabItem.Header&gt;
                    &lt;StackPanel Margin="16"&gt;
                        &lt;TextBlock Margin="0,0,0,8" Style="{StaticResource MaterialDesignHeadline5TextBlock}" Text="logデータのエクセル変換" /&gt;

                    &lt;/StackPanel&gt;
                &lt;/TabItem&gt;

                &lt;!--解凍--&gt;
                &lt;TabItem&gt;
                    &lt;TabItem.Header&gt;
                        &lt;StackPanel Width="auto" Height="auto"&gt;
                            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="ArrowSplitHorizontal" /&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="解凍" /&gt;
                        &lt;/StackPanel&gt;
                    &lt;/TabItem.Header&gt;
                    &lt;Grid&gt;
                        &lt;!-- 行の定義 --&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="Auto" /&gt;
                            &lt;RowDefinition Height="Auto" /&gt;
                            &lt;RowDefinition Height="Auto" /&gt;
                            &lt;RowDefinition Height="Auto" /&gt;
                            &lt;RowDefinition Height="*" /&gt;
                            &lt;RowDefinition Height="Auto" /&gt;
                        &lt;/Grid.RowDefinitions&gt;
                        
                        &lt;TextBlock Grid.Row="0" Margin="0,0,0,8" Style="{StaticResource MaterialDesignHeadline5TextBlock}" Text="解凍" /&gt;
                        &lt;Grid  Grid.Row="1" Margin="0,0,0,0" &gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="Auto" /&gt;
                                &lt;ColumnDefinition Width="Auto" /&gt;
                                &lt;ColumnDefinition Width="*" /&gt;
                                &lt;ColumnDefinition Width="Auto" /&gt;
                                &lt;ColumnDefinition Width="Auto" /&gt;
                                &lt;ColumnDefinition Width="Auto" /&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;Button 
                                Grid.Column="0"
                                Width="120"
                                Margin="8,0,4,0" 
                                Content="フォルダ指定" 
                                Command="{Binding SelectFolderCommand}" /&gt;
                            &lt;Button 
                                Grid.Column="3"
                                Width="120"
                                Margin="4,0,4,0" 
                                Content="リストクリア" /&gt;
                            &lt;Button 
                                Grid.Column="4"
                                Width="120"
                                Margin="4,0,8,0" 
                                Content="解凍する"
                                Command="{Binding DecompressFilesCommand}"
                                materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsProcessing}"
                                materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsProcessing}"
                                materialDesign:ButtonProgressAssist.Value="{Binding ProgressValue}"
                                IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                                Style="{StaticResource MaterialDesignRaisedButton}" /&gt;
                            &lt;Button 
                                Grid.Column="5"
                                Width="120"
                                Margin="4,0,4,0" 
                                Content="圧縮する" 
                                Command="{Binding CompressFilesCommand}"/&gt;
                        &lt;/Grid&gt;

                        &lt;CheckBox Grid.Row="2" Content="解凍するときに新たにフォルダを作成する" Margin="8 8 8 8" IsChecked="{Binding IsFolderMake}"/&gt;

                        &lt;TextBlock Grid.Row="3" Margin="0,0,0,8" Text="{Binding ProcessStatus}" Foreground="Red" /&gt;

                        &lt;ListView 
                            Grid.Row="4" 
                            ItemsSource="{Binding Files}" 
                            ScrollViewer.HorizontalScrollBarVisibility="Auto" 
                            ScrollViewer.VerticalScrollBarVisibility="Auto" &gt;
                            &lt;ListView.View&gt;
                                &lt;GridView&gt;
                                    &lt;GridViewColumn DisplayMemberBinding="{Binding Index}" Header="No" /&gt;
                                    &lt;GridViewColumn DisplayMemberBinding="{Binding Status}" Header="Status" /&gt;
                                    &lt;GridViewColumn Header="進捗"&gt;
                                        &lt;GridViewColumn.CellTemplate&gt;
                                            &lt;DataTemplate&gt;
                                                &lt;Grid&gt;
                                                    &lt;ProgressBar Value="{Binding Prog}" Maximum="100" Style="{StaticResource CustomProgressBarStyle}"/&gt;
                                                    &lt;TextBlock Text="{Binding Prog, StringFormat={}{0}%}" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="Black" /&gt;
                                                &lt;/Grid&gt;
                                            &lt;/DataTemplate&gt;
                                        &lt;/GridViewColumn.CellTemplate&gt;
                                    &lt;/GridViewColumn&gt;
                                    &lt;GridViewColumn DisplayMemberBinding="{Binding FolderName}" Header="FolderName" /&gt;
                                    &lt;GridViewColumn DisplayMemberBinding="{Binding FileName}" Header="FileName" /&gt;
                                    &lt;!--&lt;GridViewColumn Header="Options"&gt;
                                        &lt;GridViewColumn.CellTemplate&gt;
                                            &lt;DataTemplate&gt;
                                                &lt;ComboBox Width="100"&gt;
                                                    &lt;ComboBoxItem Content="Test" /&gt;
                                                    &lt;ComboBoxItem Content="Test2" /&gt;
                                                    &lt;ComboBoxItem Content="Test3" /&gt;
                                                &lt;/ComboBox&gt;
                                            &lt;/DataTemplate&gt;
                                        &lt;/GridViewColumn.CellTemplate&gt;
                                    &lt;/GridViewColumn&gt;--&gt;
                                &lt;/GridView&gt;
                            &lt;/ListView.View&gt;
                        &lt;/ListView&gt;

                        &lt;ProgressBar Grid.Row="5" Height="10" Value="0" /&gt;
                    &lt;/Grid&gt;
                &lt;/TabItem&gt;

                &lt;!--圧縮--&gt;
                &lt;TabItem&gt;
                    &lt;TabItem.Header&gt;
                        &lt;StackPanel Margin="10" Width="auto" Height="auto"&gt;
                            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="ArrowCollapseVertical" /&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="圧縮" /&gt;
                        &lt;/StackPanel&gt;
                    &lt;/TabItem.Header&gt;
                    &lt;StackPanel Margin="16" Width="200"&gt;
                        &lt;StackPanel Margin="10"&gt;
                            &lt;TextBox Margin="4 4 4 4" Text="{Binding NewItemText, UpdateSourceTrigger=PropertyChanged}" 
                                     Style="{StaticResource MaterialDesignTextBox}" KeyDown="TextBox_KeyDown"
                                     Background="White"/&gt;
                            &lt;Button Margin="4 4 4 4" Content="追加" Command="{Binding AddItemCommand}" 
                                    Style="{StaticResource MaterialDesignRaisedButton}" /&gt;
                            &lt;ListBox BorderBrush="LightGray" BorderThickness="1" Margin="4 4 4 4" Height="300" 
                                     ItemsSource="{Binding Items}" SelectedItem="{Binding SelectedItem}" 
                                     Style="{StaticResource MaterialDesignListBox}"&gt;
                                &lt;ListBox.ItemTemplate&gt;
                                    &lt;DataTemplate&gt;
                                        &lt;TextBlock Text="{Binding}" /&gt;
                                    &lt;/DataTemplate&gt;
                                &lt;/ListBox.ItemTemplate&gt;
                            &lt;/ListBox&gt;
                            &lt;Button Margin="4 4 4 4" Content="削除" Command="{Binding RemoveItemCommand}" 
                                    Style="{StaticResource MaterialDesignRaisedButton}" /&gt;
                        &lt;/StackPanel&gt;
                    &lt;/StackPanel&gt;
                &lt;/TabItem&gt;

                &lt;!--サーバーチェック--&gt;
                &lt;TabItem&gt;
                    &lt;TabItem.Header&gt;
                        &lt;StackPanel Margin="10" Width="auto" Height="auto"&gt;
                            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="ServerNetwork" /&gt;
                            &lt;TextBlock HorizontalAlignment="Center" Text="チェック" /&gt;
                        &lt;/StackPanel&gt;
                    &lt;/TabItem.Header&gt;

                    &lt;local:ServerCheckTab /&gt;

                &lt;/TabItem&gt;
            &lt;/TabControl&gt;
        &lt;/materialDesign:Card&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
            </code></pre>

            <p>
                MajorModel.cs
            </p>
            <pre><code class="prettyprint">
                namespace DataManager
{
    class MajorModel
    {
        public string Product { get; set; } = string.Empty;
        public int ProductDeletableNum { get; set; }
        public string Type { get; set; } = string.Empty;
        public int TypeDeletableNum { get; set; }
        public string ItemName { get; set; } = string.Empty;
        public int ItemNameDeletableNum { get; set; }
        public int DataTypeNum { get; set; }
    }
}
            </code></pre>

            <p>
                ManegementTab.xaml
            </p>
            <pre><code class="prettyprint">
                &lt;UserControl x:Class="DataManager.ManegementTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" 
             xmlns:local="clr-namespace:DataManager"
             mc:Ignorable="d" &gt;
    &lt;UserControl.Resources&gt;
        &lt;Style TargetType="DataGridRow"&gt;
            &lt;Style.Triggers&gt;
                &lt;Trigger Property="IsSelected" Value="True"&gt;
                    &lt;Setter Property="Background" Value="LightSkyBlue" /&gt;
                &lt;/Trigger&gt;
                &lt;Trigger Property="IsMouseOver" Value="True"&gt;
                    &lt;Setter Property="Background" Value="LightPink" /&gt;
                &lt;/Trigger&gt;
                &lt;DataTrigger Binding="{Binding IsRegistered}" Value="True"&gt;
                    &lt;Setter Property="Background" Value="Gray" /&gt;
                &lt;/DataTrigger&gt;
            &lt;/Style.Triggers&gt;
        &lt;/Style&gt;

        &lt;!--&lt;Style TargetType="DataGridCell"&gt;
            &lt;Setter Property="BorderBrush" Value="LightGray" /&gt;
            &lt;Setter Property="BorderThickness" Value="0,0,1,0" /&gt;
            --&gt;&lt;!-- 右側に罫線を引く --&gt;&lt;!--
        &lt;/Style&gt;--&gt;
    &lt;/UserControl.Resources&gt;

    &lt;Grid&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="*"/&gt;
        &lt;/Grid.RowDefinitions&gt;

        &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
            &lt;TextBlock HorizontalAlignment="Center" Text="データ管理" FontSize="16" TextWrapping="Wrap"/&gt;
        &lt;/materialDesign:Card&gt;

        &lt;Grid Grid.Row="1"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="*"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;

            &lt;Grid Grid.Column="0"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                    &lt;RowDefinition Height="*"/&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                &lt;/Grid.RowDefinitions&gt;

                &lt;ListBox x:Name="RadioButtonGroupChoiceChipPrimaryOutline"
                     Style="{StaticResource MaterialDesignChoiceChipPrimaryOutlineListBox}"
                     ItemsSource="{Binding Modes}" SelectedItem="{Binding SelectedMode}"
                     Margin="4 4 4 4" IsEnabled="{Binding IsDataManegementEnabled}"&gt;
                    &lt;ListBox.ItemTemplate&gt;
                        &lt;DataTemplate&gt;
                            &lt;TextBlock Text="{Binding}" /&gt;
                        &lt;/DataTemplate&gt;
                    &lt;/ListBox.ItemTemplate&gt;
                &lt;/ListBox&gt;

                &lt;Grid Grid.Row="1"&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;

                    &lt;Grid Grid.Column="0"&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;TextBlock Grid.Row="0" Text="品種名" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                            &lt;Button Content="追加" Command="{Binding AddProductCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 4 2 4" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;TextBox Height="29"  Margin="6 2 6 2" Text="{Binding NewProductText, UpdateSourceTrigger=PropertyChanged}"
                                 Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="ProductTextBox_KeyDown"
                                 IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/StackPanel&gt;

                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                             BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                             ItemsSource="{Binding Products}" SelectedItem="{Binding SelectedProduct}" 
                             SelectedIndex="{Binding SelectedProductIndex}" Style="{StaticResource MaterialDesignListBox}"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                            &lt;ListBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ListBox.ItemTemplate&gt;
                        &lt;/ListBox&gt;

                        &lt;Button Grid.Row="3" Content="コピー" Command="{Binding CopyProductCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;Button Grid.Row="4" Content="変更" Command="{Binding RenameProductCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;Button Grid.Row="5" Content="削除" Command="{Binding RemoveProductCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                    &lt;/Grid&gt;

                    &lt;Grid Grid.Column="1"&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;TextBlock Grid.Row="0" Text="種類" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                            &lt;Button Content="追加" Command="{Binding AddTypeCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 4 2 4" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;TextBox Height="29" Margin="6 2 6 2" Text="{Binding NewTypeText, UpdateSourceTrigger=PropertyChanged}"
                                 Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="TypeTextBox_KeyDown"
                                 IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/StackPanel&gt;

                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                             BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                             ItemsSource="{Binding Types}" SelectedItem="{Binding SelectedType}" 
                             SelectedIndex="{Binding SelectedTypeIndex}" Style="{StaticResource MaterialDesignListBox}"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                            &lt;ListBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ListBox.ItemTemplate&gt;
                        &lt;/ListBox&gt;

                        &lt;Button Grid.Row="3" Content="コピー" Command="{Binding CopyTypeCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;Button Grid.Row="4" Content="変更" Command="{Binding RenameTypeCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;Button Grid.Row="5" Content="削除" Command="{Binding RemoveTypeCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                    &lt;/Grid&gt;

                    &lt;Grid Grid.Column="2"&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;TextBlock Grid.Row="0" Text="項目名" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                            &lt;Button Content="追加" Command="{Binding AddItemNameCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 4 2 4" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;TextBox Height="29" Margin="6 2 6 2" Text="{Binding NewItemNameText, UpdateSourceTrigger=PropertyChanged}"
                                 Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="ItemNameTextBox_KeyDown"
                                 IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/StackPanel&gt;

                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                             BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                             ItemsSource="{Binding ItemNames}" SelectedItem="{Binding SelectedItemName}" 
                             SelectedIndex="{Binding SelectedItemNameIndex}" Style="{StaticResource MaterialDesignListBox}" ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                            &lt;ListBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ListBox.ItemTemplate&gt;
                        &lt;/ListBox&gt;

                        &lt;Button Grid.Row="3" Content="コピー" Command="{Binding CopyItemNameCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;Button Grid.Row="4" Content="変更" Command="{Binding RenameItemNameCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;Button Grid.Row="5" Content="削除" Command="{Binding RemoveItemNameCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                    &lt;/Grid&gt;
                &lt;/Grid&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="1"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                    &lt;RowDefinition Height="*"/&gt;
                &lt;/Grid.RowDefinitions&gt;

                &lt;StackPanel Orientation="Horizontal"&gt;
                    &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                        &lt;TextBlock Text="データリスト" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" VerticalAlignment="Top"/&gt;
                        &lt;Button Content="データ追加" Command="{Binding AddDataListCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="6 4 2 2" Padding="0" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;Button Content="データ編集" Command="{Binding EditDataListCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="6 2 2 4" Padding="0" IsEnabled="{Binding IsDataManegementEnabled}" 
                            materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsDataListEditing}"
                            materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsDataListEditing}"
                            materialDesign:ButtonProgressAssist.Value="{Binding EditDataListStatus}"/&gt;
                        &lt;Button Content="データ削除" Command="{Binding RemoveDataListCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="6 2 2 4" Padding="0" IsEnabled="{Binding IsDataManegementEnabled}" 
                            materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsDataListRemoving}"
                            materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsDataListRemoving}"
                            materialDesign:ButtonProgressAssist.Value="{Binding RemoveDataListStatus}"/&gt;
                    &lt;/StackPanel&gt;

                    &lt;GroupBox Height="136" Width="300" Margin="4 8 4 4" Padding="0"
                          Header="データの情報" IsEnabled="{Binding IsDataManegementEnabled}"
                          materialDesign:GroupBoxAssist.HeaderPadding="4"
                          Style="{StaticResource MaterialDesignGroupBox}"&gt;
                        &lt;ScrollViewer Padding="4" materialDesign:ScrollViewerAssist.PaddingMode="Content"&gt;
                            &lt;StackPanel&gt;
                                &lt;TextBlock Margin="4" TextWrapping="Wrap" Text="{Binding DataItemInfo}" /&gt;
                            &lt;/StackPanel&gt;
                        &lt;/ScrollViewer&gt;
                    &lt;/GroupBox&gt;

                    &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="*"/&gt;
                                &lt;ColumnDefinition Width="*"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;Button Grid.Column="0" Margin="6 0 0 0" Padding="4 0 4 0"
                                HorizontalAlignment="Left" VerticalAlignment="Bottom"
                                Command="{Binding ApplyFilterCommand}" Content="Filtering"
                                Style="{StaticResource MaterialDesignFlatButton}" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;Button Grid.Column="1" Margin="0 0 8 0" Padding="4 0 4 0"
                                HorizontalAlignment="Right" VerticalAlignment="Bottom"
                                Command="{Binding ClearFilterCommand}" Content="Clear"
                                Style="{StaticResource MaterialDesignFlatButton}" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/Grid&gt;

                        &lt;ComboBox Margin="4 4 4 4" Width="150" Height="40"
                              materialDesign:HintAssist.Hint="Headers" IsEnabled="{Binding IsDataManegementEnabled}"
                              Style="{StaticResource MaterialDesignFilledComboBox}"
                              ItemsSource="{Binding Headers}" SelectedItem="{Binding SelectedFilterHeader}"&gt;
                            &lt;ComboBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding}" /&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ComboBox.ItemTemplate&gt;
                        &lt;/ComboBox&gt;
                        &lt;TextBox Margin="4 4 4 4" Width="150" Height="40" VerticalAlignment="Top"
                             Padding="8 -8 0 -8" IsEnabled="{Binding IsDataManegementEnabled}"
                             materialDesign:HintAssist.Hint="Filter" KeyDown="FilterTextBox_KeyDown"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Text="{Binding FilterValue, UpdateSourceTrigger=PropertyChanged}"/&gt;
                    &lt;/StackPanel&gt;
                &lt;/StackPanel&gt;

                &lt;Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" Margin="4 1 4 4"&gt;
                    &lt;DataGrid VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.VirtualizationMode="Recycling" 
                          EnableRowVirtualization="True" EnableColumnVirtualization="True"
                          CanUserAddRows="False" AutoGenerateColumns="False" IsEnabled="{Binding IsDataManegementEnabled}"
                          ItemsSource="{Binding DataItems, Mode=TwoWay}" SelectionMode="Extended"
                          SelectedItem="{Binding SelectedDataItem}" SelectionChanged="DataItem_SelectionChanged"
                          AllowDrop="True" Drop="DataGrid_Drop" CellEditEnding="DataGrid_CellEditEnding"&gt;
                        &lt;DataGrid.RowStyle&gt;
                            &lt;Style TargetType="{x:Type DataGridRow}" BasedOn="{StaticResource {x:Type DataGridRow}}"&gt;
                                &lt;Setter Property="IsSelected" Value="{Binding IsSelected,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/&gt;
                            &lt;/Style&gt;
                        &lt;/DataGrid.RowStyle&gt;
                        &lt;DataGrid.Columns&gt;
                            &lt;!--*** No ***--&gt;
                            &lt;DataGridTextColumn Header="No" Binding="{Binding No}" IsReadOnly="True"/&gt;
                            &lt;!--*** DataName ***--&gt;
                            &lt;DataGridTextColumn Header="DataName" Binding="{Binding DataName}" IsReadOnly="True"/&gt;
                            &lt;!--*** Link ***--&gt;
                            &lt;DataGridTemplateColumn Header="Link" IsReadOnly="True" Width="100"&gt;
                                &lt;DataGridTemplateColumn.CellTemplate&gt;
                                    &lt;DataTemplate&gt;
                                        &lt;TextBlock&gt; 
                                        &lt;Hyperlink NavigateUri="{Binding Link}" RequestNavigate="Hyperlink_RequestNavigate"&gt; 
                                            &lt;TextBlock Text="{Binding Link}"/&gt; 
                                        &lt;/Hyperlink&gt; 
                                    &lt;/TextBlock&gt;
                                    &lt;/DataTemplate&gt;
                                &lt;/DataGridTemplateColumn.CellTemplate&gt;
                            &lt;/DataGridTemplateColumn&gt;
                            &lt;!--*** Product ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Product" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Product"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Type ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Type" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Type"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** ItemName ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="ItemName" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="ItemName"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Ver ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Ver" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Ver"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Lot ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Lot" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Lot"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Slot ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Slot" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Slot"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** LotSlot ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="LotSlot" IsReadOnly="True" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="LotSlot"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Program ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Program" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Program"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Date ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Date" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Date"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Owner ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Owner" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Owner"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Remark ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Remark" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Remark"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                        &lt;/DataGrid.Columns&gt;
                    &lt;/DataGrid&gt;
                &lt;/Border&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="2"&gt;
                &lt;Expander ExpandDirection="Right" IsEnabled="{Binding IsDataManegementEnabled}"&gt;
                    &lt;Expander.Header&gt;
                        &lt;TextBlock RenderTransformOrigin=".5,.5" Text="データ選択"&gt;
                            &lt;TextBlock.LayoutTransform&gt;
                                &lt;RotateTransform Angle="-90" /&gt;
                            &lt;/TextBlock.LayoutTransform&gt;
                        &lt;/TextBlock&gt;
                    &lt;/Expander.Header&gt;

                    &lt;Grid&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right"&gt;
                            &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom" HorizontalAlignment="Left"&gt;
                                &lt;TextBlock Text="テスタログはリストから" Margin="0 0 2 4"/&gt;
                                &lt;TextBlock Text="選択してデータ抽出できます→" Margin="0 0 2 6"/&gt;
                            &lt;/StackPanel&gt;
                            &lt;Button Width="90" Height="90" Margin="8 8 12 4" Style="{StaticResource MaterialDesignRaisedLightButton}" Command="{Binding SelectDataExtractTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical" HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="50" Height="50" HorizontalAlignment="Center" Kind="ChartBar" /&gt;
                                    &lt;TextBlock Text="データ抽出" FontSize="14"  HorizontalAlignment="Center" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                        &lt;/StackPanel&gt;

                        &lt;Grid Grid.Row="1"&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="*"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;

                            &lt;StackPanel Grid.Column="0" Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center"&gt;
                                &lt;Button Width="40" Padding="0 0 0 0" Margin="4 4 4 4" Content="&gt;&gt;" Command="{Binding MoveAllFilesCommand}"/&gt;
                                &lt;Button Width="40" Padding="0 0 0 0" Margin="4 4 4 4" Content="&gt;" Command="{Binding MoveSelectedFilesCommand}"/&gt;
                                &lt;Button Width="40" Padding="0 0 0 0" Margin="4 4 4 4" Content="&lt;" Command="{Binding CancelSelectedFilesCommand}"/&gt;
                                &lt;Button Width="40" Padding="0 0 0 0" Margin="4 4 4 4" Content="&lt;&lt;" Command="{Binding CancelAllFilesCommand}"/&gt;
                            &lt;/StackPanel&gt;

                            &lt;!--&lt;ListBox Grid.Column="1" Background="White" Margin ="2 4 2 8" Width="200"
                                     BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                                     ItemsSource="{Binding TargetDataNames}" SelectedItem="{Binding SelectedTargetDataName}" SelectionMode="Extended" SelectionChanged="ListBox_SelectionChanged"
                                     SelectedIndex="{Binding SelectedTargetDataNameIndex}" Style="{StaticResource MaterialDesignListBox}" 
                                     ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto"&gt;
                                &lt;ListBox.ItemTemplate&gt;
                                    &lt;DataTemplate&gt;
                                        &lt;TextBlock Text="{Binding Name}" Margin="0 -2 8 -2"/&gt;
                                    &lt;/DataTemplate&gt;
                                &lt;/ListBox.ItemTemplate&gt;
                            &lt;/ListBox&gt;--&gt;

                            &lt;Border Grid.Column="1" BorderBrush="LightGray" BorderThickness="1" Margin="4 1 4 4"&gt;
                                &lt;DataGrid Margin ="2 4 2 8" VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.VirtualizationMode="Recycling" 
                                          EnableRowVirtualization="True" EnableColumnVirtualization="True" CanUserAddRows="False" AutoGenerateColumns="False"
                                          ItemsSource="{Binding TargetDataItems}" SelectionMode="Extended" SelectionChanged="TargetItem_SelectionChanged"
                                          ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto"&gt;
                                    &lt;DataGrid.Columns&gt;
                                        &lt;!--*** LotSlot ***--&gt;
                                        &lt;DataGridTextColumn Header="LotSlot" Binding="{Binding LotSlot}" IsReadOnly="True"/&gt;
                                        &lt;!--*** DataName ***--&gt;
                                        &lt;DataGridTextColumn Header="DataName" Width="95" Binding="{Binding DataName}" IsReadOnly="True"/&gt;
                                        &lt;!--*** Product ***--&gt;
                                        &lt;DataGridTextColumn Header="Product" Binding="{Binding Product}" IsReadOnly="True"/&gt;
                                        &lt;!--*** Type ***--&gt;
                                        &lt;DataGridTextColumn Header="Type" Width="95" Binding="{Binding Type}" IsReadOnly="True"/&gt;
                                        &lt;!--*** ItemName ***--&gt;
                                        &lt;DataGridTextColumn Header="ItemName" Width="95" Binding="{Binding ItemName}" IsReadOnly="True"/&gt;
                                        &lt;!--*** Ver ***--&gt;
                                        &lt;DataGridTextColumn Header="Ver" Binding="{Binding Ver}" IsReadOnly="True"/&gt;
                                    &lt;/DataGrid.Columns&gt;
                                &lt;/DataGrid&gt;
                            &lt;/Border&gt;
                            
                        &lt;/Grid&gt;
                    &lt;/Grid&gt;
                    
                &lt;/Expander&gt;
            &lt;/Grid&gt;
        &lt;/Grid&gt;
    &lt;/Grid&gt;
&lt;/UserControl&gt;
            </code></pre>

            <p>
                ManegementTab.xaml.cs
            </p>
            <pre><code class="prettyprint">
                using System.Diagnostics;

                private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)
{
    //System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(e.Uri.ToString()) { UseShellExecute = true });
    //e.Handled = true;

    var menu = new ContextMenu();
    var openItem = new MenuItem { Header = "ファイルを開く" };
    var openFolderItem = new MenuItem { Header = "フォルダを開く" };

    openItem.Click += (s, args) =>
    {
        Process.Start(new ProcessStartInfo(e.Uri.ToString()) { UseShellExecute = true });
    };

    openFolderItem.Click += (s, args) =>
    {
        string? folderPath = System.IO.Path.GetDirectoryName(e.Uri.LocalPath);
        if (folderPath == null)
        {
            e.Handled = true;
            return;
        }
        Process.Start(new ProcessStartInfo("explorer.exe", folderPath) { UseShellExecute = true });
    };

    menu.Items.Add(openItem);
    menu.Items.Add(openFolderItem);
    menu.IsOpen = true;

    e.Handled = true;
}

private void TargetItem_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    //var listBox = (System.Windows.Controls.ListBox)sender;
    //var viewModel = (MainViewModel)DataContext;

    //viewModel.SelectedTargetDataNames.Clear();
    //foreach (var selectedItem in listBox.SelectedItems)
    //{
    //    viewModel.SelectedTargetDataNames.Add((ExtractModel)selectedItem);
    //}

    if (DataContext is MainViewModel viewModel && sender is System.Windows.Controls.DataGrid dataGrid)
    {
        viewModel.SelectedTargetDataNames.Clear();
        foreach (var selectedItem in dataGrid.Items)
        {
            viewModel.SelectedTargetDataNames.Add((ExtractModel)selectedItem);
        }
    }
}
            </code></pre>

            <p>
                ResearchDiffInfo.cs
            </p>
            <pre><code class="prettyprint">
                namespace DataManager
{
    public class ResearchDiffInfo
    {
        public string ResearchFolder { get; set; } = string.Empty;
        public int ResearchGrouping { get; set; }
        public int ResearchDataType { get; set; }
        public int SizeLimited { get; set; }
        public string LimitedSizeValue { get; set; } = string.Empty;
        public string GroupingKeyWords { get; set; } = string.Empty;
        public string ResearchExtensions { get; set; } = string.Empty;

        public override bool Equals(object? obj)
        {
            if (obj == null || GetType() != obj.GetType())
            {
                return false;
            }

            ResearchDiffInfo other = (ResearchDiffInfo)obj;
            return ResearchFolder == other.ResearchFolder &&
                   ResearchGrouping == other.ResearchGrouping &&
                   ResearchDataType == other.ResearchDataType &&
                   SizeLimited == other.SizeLimited &&
                   LimitedSizeValue == other.LimitedSizeValue &&
                   GroupingKeyWords == other.GroupingKeyWords &&
                   ResearchExtensions == other.ResearchExtensions;
        }

        public override int GetHashCode()
        {
            return HashCode.Combine(ResearchFolder, ResearchGrouping, ResearchDataType, SizeLimited, LimitedSizeValue, GroupingKeyWords, ResearchExtensions);
        }
    }
}
            </code></pre>

            <p>
                ResearchFileInfo.cs
            </p>
            <pre><code class="prettyprint">
                namespace DataManager
{
    public class ResearchFileInfo
    {
        public int No { get; set; }
        public string FolderName { get; set; } = string.Empty;
        public string FileName { get; set; } = string.Empty;
        public double Size { get; set; }
        public string LastModified { get; set; } = string.Empty;
        public string CreatedDate { get; set; } = string.Empty;
        public string Group { get; set; } = string.Empty;
        //public string LastModifiedBy { get; set; } = string.Empty;

        public bool EqualsExcludingLastModified(ResearchFileInfo other)
        {
            return FolderName == other.FolderName && FileName == other.FileName && Size == other.Size
                   && CreatedDate == other.CreatedDate && Group == other.Group && LastModified != other.LastModified;
        }

        public override bool Equals(object? obj)
        {
            if (obj is ResearchFileInfo other)
            {
                return FolderName == other.FolderName && FileName == other.FileName && Size == other.Size 
                                    && LastModified == other.LastModified && CreatedDate == other.CreatedDate && Group == other.Group;
            }
            return false;
        }

        public override int GetHashCode()
        {
            return HashCode.Combine(FolderName, FileName, Size, LastModified, CreatedDate, Group);
        }
    }
}
            </code></pre>

            <p>
                ResearchHistory.cs
            </p>
            <pre><code class="prettyprint">
                namespace DataManager
{
    public class ResearchHistory
    {
        public int No { get; set; }
        public string ResearchResultName { get; set; } = string.Empty;
        public string ResearchResultType { get; set; } = string.Empty;
        public string ResearchDate { get; set; } = string.Empty;
        public string ResearchFolder { get; set; } = string.Empty;
        public string ResearchResultLink { get; set; } = string.Empty;
        public int ResearchGrouping { get; set; }
        public int ResearchDataType { get; set; }
        public int SizeLimited { get; set; }
        public string LimitedSizeValue { get; set; } = string.Empty;
        public UniqueObservableCollection<string> GroupingKeyWords { get; set; } = [];
        public UniqueObservableCollection<string> ResearchExtensions { get; set; } = [];
    }
}
            </code></pre>

            <p>
                ServerCheckTab.xaml
            </p>
            <pre><code class="prettyprint">
                &lt;UserControl x:Class="DataManager.ServerCheckTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" 
             xmlns:local="clr-namespace:DataManager"
             mc:Ignorable="d" &gt;
    &lt;UserControl.Resources&gt;
        &lt;local:EnumToBooleanConverter x:Key="EnumToBooleanConverter"/&gt;

        &lt;!-- GridViewColumnHeaderのスタイルを定義 --&gt;
        &lt;!--
        &lt;Style TargetType="GridViewColumnHeader"&gt;
            &lt;Setter Property="HorizontalContentAlignment" Value="Center"/&gt;
            &lt;Setter Property="BorderBrush" Value="DarkGray" /&gt;
            &lt;Setter Property="BorderThickness" Value="0,0,1,0" /&gt;
            --&gt;
        &lt;!-- 右側に罫線を引く --&gt;
        &lt;!--
        &lt;/Style&gt;
        --&gt;
        &lt;!-- DataTemplateに罫線を設定 --&gt;
        &lt;!--
        &lt;DataTemplate x:Key="CellTemplate"&gt;
            &lt;Border BorderBrush="DarkGray" BorderThickness="0,0,1,0"&gt;
                &lt;TextBlock Text="{Binding}" /&gt;
            &lt;/Border&gt;
        &lt;/DataTemplate&gt;--&gt;
    &lt;/UserControl.Resources&gt;
    &lt;Grid&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="*"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
        &lt;/Grid.RowDefinitions&gt;

        &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
            &lt;TextBlock HorizontalAlignment="Center" Text="サーバーデータチェック" FontSize="16" TextWrapping="Wrap"/&gt;
        &lt;/materialDesign:Card&gt;

        &lt;Grid Grid.Row="1"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="*" /&gt;
                &lt;ColumnDefinition Width="auto" /&gt;
                &lt;ColumnDefinition Width="auto" /&gt;
            &lt;/Grid.ColumnDefinitions&gt;

            &lt;Grid Grid.Column="0"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="Auto"/&gt;
                    &lt;RowDefinition Height="Auto"/&gt;
                    &lt;RowDefinition Height="Auto"/&gt;
                    &lt;RowDefinition Height="*"/&gt;
                    &lt;RowDefinition Height="Auto"/&gt;
                &lt;/Grid.RowDefinitions&gt;

                &lt;Grid  Grid.Row="0" Margin="0,8,0,0" &gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                        &lt;ColumnDefinition Width="*" /&gt;
                    &lt;/Grid.ColumnDefinitions&gt;
                    &lt;Button Grid.Column="0" Width="150" Margin="8,0,4,0" Content="調査フォルダ指定" Command="{Binding SelectResearchFolderCommand}" /&gt;
                    &lt;TextBox Grid.Column="1" Margin="4" Text="{Binding ResearchFolder}"/&gt;
                &lt;/Grid&gt;

                &lt;Grid  Grid.Row="1" Margin="0,8,0,0" &gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                        &lt;ColumnDefinition Width="*" /&gt;
                    &lt;/Grid.ColumnDefinitions&gt;

                    &lt;Button Grid.Column="0" Width="150" Margin="8,0,4,0" Content="結果フォルダ指定" Command="{Binding SelectResearchResultFolderCommand}" /&gt;
                    &lt;TextBox Grid.Column="1" Margin="4" Text="{Binding ResultFolder}"/&gt;
                &lt;/Grid&gt;

                &lt;Grid Grid.Row="2" Margin="0,8,0,0"&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                        &lt;ColumnDefinition Width="*" /&gt;
                    &lt;/Grid.ColumnDefinitions&gt;

                    &lt;Button Grid.Column="0" Width="150" Margin="8,0,4,0" Content="調査開始" Command="{Binding ResearchStartCommand}"
                            materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsFolderResearching}"
                            materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsFolderResearching}"
                            materialDesign:ButtonProgressAssist.Value="{Binding FolderResearchStatus}"/&gt;
                    &lt;TextBlock Grid.Column="1" Margin="8" Text="調査名:"/&gt;
                    &lt;TextBox Grid.Column="2" Margin="4,4,4,0" Width="150" Text="{Binding ResultFileName}" Height="25" VerticalAlignment="Top"/&gt;
                    &lt;StackPanel Grid.Column="3" Orientation="Horizontal" HorizontalAlignment="Right"&gt;
                        &lt;Button  Width="150" Margin="8,0,4,0" Content="履歴削除" Command="{Binding DeleteHistoryCommand}"
                                 materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsHistoryDeleting}"
                                 materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding  IsHistoryDeleting}"
                                 materialDesign:ButtonProgressAssist.Value="{Binding HistoryDeleteStatus}"/&gt;
                    &lt;/StackPanel&gt;

                &lt;/Grid&gt;

                &lt;!--&lt;ListView Grid.Row="3" ItemsSource="{Binding ResearchHistoryLists}" 
                          ScrollViewer.HorizontalScrollBarVisibility="Auto"  ScrollViewer.VerticalScrollBarVisibility="Auto" &gt;
                    &lt;ListView.View&gt;
                        &lt;GridView&gt;
                            &lt;GridViewColumn DisplayMemberBinding="{Binding No}" Header="No" /&gt;
                            &lt;GridViewColumn DisplayMemberBinding="{Binding ResearchDate}" Header="調査日時" /&gt;
                            &lt;GridViewColumn DisplayMemberBinding="{Binding ResearchFolder}" Header="調査フォルダ" /&gt;
                            &lt;GridViewColumn DisplayMemberBinding="{Binding ResearchResult}" Header="調査結果" /&gt;
                        &lt;/GridView&gt;
                    &lt;/ListView.View&gt;
                &lt;/ListView&gt;--&gt;

                &lt;DataGrid Grid.Row="3" AutoGenerateColumns="False" CanUserAddRows="False" HeadersVisibility="All" ItemsSource="{Binding ResearchHistoryLists}"
                          ScrollViewer.HorizontalScrollBarVisibility="Auto"  ScrollViewer.VerticalScrollBarVisibility="Auto" Height="240"
                          SelectedItem="{Binding SelectedHistory}"&gt;
                    &lt;DataGrid.Columns&gt;
                        &lt;DataGridTextColumn Header="No" Binding="{Binding No}" IsReadOnly="True"/&gt;
                        &lt;DataGridTextColumn Header="調査結果名" Binding="{Binding ResearchResultName}" IsReadOnly="True"/&gt;
                        &lt;DataGridTextColumn Header="調査タイプ" Binding="{Binding ResearchResultType}" IsReadOnly="True"/&gt;
                        &lt;DataGridTextColumn Header="調査日時" Binding="{Binding ResearchDate}" IsReadOnly="True"/&gt;
                        &lt;DataGridTextColumn Header="調査フォルダ" Binding="{Binding ResearchFolder}" IsReadOnly="True"/&gt;
                        &lt;DataGridTemplateColumn Header="調査結果リンク" IsReadOnly="True" Width="130"&gt;
                            &lt;DataGridTemplateColumn.CellTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock&gt; 
                                        &lt;Hyperlink NavigateUri="{Binding ResearchResultLink}" RequestNavigate="Hyperlink_RequestNavigate"&gt; 
                                            &lt;TextBlock Text="{Binding ResearchResultLink}"/&gt; 
                                        &lt;/Hyperlink&gt; 
                                    &lt;/TextBlock&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/DataGridTemplateColumn.CellTemplate&gt;
                        &lt;/DataGridTemplateColumn&gt;
                    &lt;/DataGrid.Columns&gt;
                &lt;/DataGrid&gt;

                &lt;Grid Grid.Row="4" Margin="0,8,0,0"&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                        &lt;ColumnDefinition Width="Auto" /&gt;
                    &lt;/Grid.ColumnDefinitions&gt;

                    &lt;Button Grid.Column="0" Width="150" Margin="8,0,4,0" Content="差分チェック" Command="{Binding CheckDiffCommand}"
                            materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsDiffChecking}"
                            materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsDiffChecking}"
                            materialDesign:ButtonProgressAssist.Value="{Binding DiffCheckStatus}"/&gt;
                    &lt;TextBlock Grid.Column="1" Margin="8" Text="①:"/&gt;
                    &lt;ComboBox Grid.Column="2" Margin="8,0,4,0" Width="200" HorizontalAlignment="Left" VerticalAlignment="Center" ItemsSource="{Binding ResearchNormalResults}" SelectedItem="{Binding SelectedFirstResult}"/&gt;
                    &lt;TextBlock Grid.Column="3" Margin="8" Text="②:"/&gt;
                    &lt;ComboBox Grid.Column="4" Margin="8,0,4,0" Width="200" HorizontalAlignment="Left" VerticalAlignment="Center" ItemsSource="{Binding ResearchNormalResults}" SelectedItem="{Binding SelectedSecondResult}"/&gt;
                &lt;/Grid&gt;
            &lt;/Grid&gt;

            &lt;Expander ExpandDirection="Right" Grid.Column="1"&gt;
                &lt;Expander.Header&gt;
                    &lt;TextBlock RenderTransformOrigin=".5,.5" Text="調査オプション"&gt;
                        &lt;TextBlock.LayoutTransform&gt;
                            &lt;RotateTransform Angle="-90" /&gt;
                        &lt;/TextBlock.LayoutTransform&gt;
                    &lt;/TextBlock&gt;
                &lt;/Expander.Header&gt;

                &lt;Grid&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto" /&gt;
                        &lt;ColumnDefinition Width="auto" /&gt;
                    &lt;/Grid.ColumnDefinitions&gt;

                    &lt;GroupBox Grid.Column="0" Margin="4" Width="170" Header="分類方法" VerticalAlignment="Top"&gt;
                        &lt;StackPanel Orientation="Vertical"&gt;
                            &lt;RadioButton Margin="0 2 2 4" Content="最上位フォルダで分類" GroupName="ResearchGrouping" IsChecked="{Binding SelectedResearchGroupingType, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static local:ResearchGroupingTypes.TopFolders}}"/&gt;
                            &lt;RadioButton Margin="0 4 2 2" Content="キーワードで分類" GroupName="ResearchGrouping" IsChecked="{Binding SelectedResearchGroupingType, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static local:ResearchGroupingTypes.KeyWords}}"/&gt;
                            &lt;StackPanel Margin="8 0 8 0" IsEnabled="{Binding SelectedResearchGroupingType, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static local:ResearchGroupingTypes.KeyWords}}"&gt;
                                &lt;TextBox Margin="4" Text="{Binding ResearchNewKeyWord, UpdateSourceTrigger=PropertyChanged}"  Style="{StaticResource MaterialDesignTextBox}" KeyDown="KeyWordTextBox_KeyDown" Background="White"/&gt;
                                &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                                    &lt;Button Margin="0 0 4 0" Content="追加" Command="{Binding AddResearchGroupingKeyWordCommand}" Style="{StaticResource MaterialDesignRaisedButton}" /&gt;
                                    &lt;Button Margin="4 0 0 0" Content="削除" Command="{Binding RemoveResearchGroupingKeyWordCommand}" Style="{StaticResource MaterialDesignRaisedButton}" /&gt;
                                &lt;/StackPanel&gt;
                                &lt;ListBox BorderBrush="LightGray" BorderThickness="1" Margin="4" Height="154" 
                                         ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Auto" 
                                         ItemsSource="{Binding GroupingKeyWords}" SelectedItem="{Binding SelectedGroupingKeyWord}" SelectedIndex="{Binding SelectedGroupingKeyWordIndex}" 
                                         SelectionChanged="GroupingKeyWords_SelectionChanged" Style="{StaticResource MaterialDesignListBox}"&gt;
                                    &lt;ListBox.ItemTemplate&gt;
                                        &lt;DataTemplate&gt;
                                            &lt;TextBlock Text="{Binding}" /&gt;
                                        &lt;/DataTemplate&gt;
                                    &lt;/ListBox.ItemTemplate&gt;
                                &lt;/ListBox&gt;
                            &lt;/StackPanel&gt;
                            &lt;RadioButton Margin="0 6 2 0" Content="分類なし" GroupName="ResearchGrouping" IsChecked="{Binding SelectedResearchGroupingType, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static local:ResearchGroupingTypes.None}}"/&gt;
                        &lt;/StackPanel&gt;
                    &lt;/GroupBox&gt;

                    &lt;GroupBox Grid.Column="1" Margin="4 4 8 4" Width="170" Header="データ指定" VerticalAlignment="Top"&gt;
                        &lt;StackPanel Orientation="Vertical"&gt;
                            &lt;RadioButton Margin="0 2 2 4" Content="指定しない" GroupName="ResearchDataType" IsChecked="{Binding SelectedResearchFileType, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static local:ResearchFileTypes.None}}"/&gt;
                            &lt;RadioButton Margin="0 4 2 2" Content="拡張子で指定" GroupName="ResearchDataType" IsChecked="{Binding SelectedResearchFileType, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static local:ResearchFileTypes.Extension}}"/&gt;
                            &lt;StackPanel Margin="8 0 8 0" IsEnabled="{Binding SelectedResearchFileType, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static local:ResearchFileTypes.Extension}}"&gt;
                                &lt;TextBox Margin="4" Text="{Binding ResearchNewExtension, UpdateSourceTrigger=PropertyChanged}"  Style="{StaticResource MaterialDesignTextBox}" KeyDown="ExtensionTextBox_KeyDown" Background="White"/&gt;
                                &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                                    &lt;Button Margin="0 0 4 0" Content="追加" Command="{Binding AddResearchFileExtensionCommand}" Style="{StaticResource MaterialDesignRaisedButton}" /&gt;
                                    &lt;Button Margin="4 0 0 0" Content="削除" Command="{Binding RemoveResearchFileExtensionCommand}" Style="{StaticResource MaterialDesignRaisedButton}" /&gt;
                                &lt;/StackPanel&gt;
                                &lt;ListBox BorderBrush="LightGray" BorderThickness="1" Margin="4" Height="120" 
                                         ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Auto" 
                                         ItemsSource="{Binding ResearchExtensions}" SelectedItem="{Binding SelectedResearchExtension}" SelectedIndex="{Binding SelectedResearchExtensionIndex}" 
                                         SelectionChanged="ResearchExtensions_SelectionChanged" Style="{StaticResource MaterialDesignListBox}"&gt;
                                    &lt;ListBox.ItemTemplate&gt;
                                        &lt;DataTemplate&gt;
                                            &lt;TextBlock Text="{Binding}" /&gt;
                                        &lt;/DataTemplate&gt;
                                    &lt;/ListBox.ItemTemplate&gt;
                                &lt;/ListBox&gt;
                            &lt;/StackPanel&gt;
                            &lt;CheckBox Content="容量指定" Margin="2 8 2 2" IsChecked="{Binding IsSizeLimited}"/&gt;
                            &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center"&gt;
                                &lt;TextBox Margin="2" Width="70" Text="{Binding LimitedSizeValue}"  Style="{StaticResource MaterialDesignTextBox}" Background="White" IsEnabled="{Binding IsSizeLimited}"/&gt;
                                &lt;TextBlock Margin="2" Text="MB以上" VerticalAlignment="Center"/&gt;
                            &lt;/StackPanel&gt;
                        &lt;/StackPanel&gt;
                    &lt;/GroupBox&gt;
                &lt;/Grid&gt;
            &lt;/Expander&gt;
        &lt;/Grid&gt;

        &lt;Separator Grid.Row="2" Margin="4 8 4 8"/&gt;

        &lt;Grid Grid.Row="3"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="Auto" /&gt;
                &lt;ColumnDefinition Width="Auto" /&gt;
                &lt;ColumnDefinition Width="Auto" /&gt;
                &lt;ColumnDefinition Width="Auto" /&gt;
            &lt;/Grid.ColumnDefinitions&gt;
            &lt;TextBlock Grid.Column="0" Margin="8,0,4,0" Text="調査結果名:" VerticalAlignment="Center"/&gt;
            &lt;ComboBox Grid.Column="1" Margin="8,0,4,0" Width="200" HorizontalAlignment="Left" VerticalAlignment="Center" ItemsSource="{Binding ResearchResults}" SelectedItem="{Binding SelectedResearchResult}"/&gt;
            &lt;TextBlock Grid.Column="2" Margin="16,0,4,0" Text="分類:" VerticalAlignment="Center"/&gt;
            &lt;ComboBox Grid.Column="3" Margin="8,0,4,0" Width="200" HorizontalAlignment="Left" VerticalAlignment="Center" ItemsSource="{Binding ResearchGroups}" SelectedItem="{Binding SelectedResearchGroup}"/&gt;
        &lt;/Grid&gt;

        &lt;!--&lt;ListView Grid.Row="3" ItemsSource="{Binding DisplayResearchResultFiles}" 
          ScrollViewer.HorizontalScrollBarVisibility="Auto" 
          ScrollViewer.VerticalScrollBarVisibility="Auto" &gt;
            &lt;ListView.View&gt;
                &lt;GridView&gt;
                    &lt;GridViewColumn DisplayMemberBinding="{Binding No}" Header="No" /&gt;
                    &lt;GridViewColumn DisplayMemberBinding="{Binding FolderName}" Header="フォルダ名" /&gt;
                    &lt;GridViewColumn DisplayMemberBinding="{Binding FileName}" Header="ファイル名" /&gt;
                    &lt;GridViewColumn DisplayMemberBinding="{Binding Size, StringFormat={}{0:0.0}}" Header="サイズ(MB)" /&gt;
                    &lt;GridViewColumn DisplayMemberBinding="{Binding LastModified}" Header="更新日時" /&gt;
                    &lt;GridViewColumn DisplayMemberBinding="{Binding CreatedDate}" Header="作成日時" /&gt;
                    &lt;GridViewColumn DisplayMemberBinding="{Binding Group}" Header="分類" /&gt;
                    --&gt;
        &lt;!--&lt;GridViewColumn DisplayMemberBinding="{Binding LastModifiedBy}" Header="更新者" /&gt;--&gt;
        &lt;!--
                &lt;/GridView&gt;
            &lt;/ListView.View&gt;
        &lt;/ListView&gt;--&gt;

        &lt;DataGrid Grid.Row="4" AutoGenerateColumns="False" CanUserAddRows="False" HeadersVisibility="All" ItemsSource="{Binding DisplayResearchResultFiles}"
          ScrollViewer.HorizontalScrollBarVisibility="Auto"  ScrollViewer.VerticalScrollBarVisibility="Auto"&gt;
            &lt;DataGrid.Columns&gt;
                &lt;DataGridTextColumn Header="No" Binding="{Binding No}" IsReadOnly="True"/&gt;
                &lt;DataGridTextColumn Header="フォルダ名" Binding="{Binding FolderName}" IsReadOnly="True"/&gt;
                &lt;DataGridTextColumn Header="ファイル名" Binding="{Binding FileName}" IsReadOnly="True"/&gt;
                &lt;DataGridTextColumn Header="サイズ(MB)" Binding="{Binding Size, StringFormat={}{0:0.0}}" IsReadOnly="True"/&gt;
                &lt;DataGridTextColumn Header="更新日時" Binding="{Binding LastModified}" IsReadOnly="True"/&gt;
                &lt;DataGridTextColumn Header="作成日時" Binding="{Binding CreatedDate}" IsReadOnly="True"/&gt;
                &lt;DataGridTextColumn Header="分類" Binding="{Binding Group}" IsReadOnly="True"/&gt;
            &lt;/DataGrid.Columns&gt;
        &lt;/DataGrid&gt;

        &lt;ProgressBar Grid.Row="5" Height="10" Value="{Binding ResearchProgress}" /&gt;
    &lt;/Grid&gt;
&lt;/UserControl&gt;
            </code></pre>

            <p>
                ServerCheckTab.xaml.cs
            </p>
            <pre><code class="prettyprint">
                using System.Diagnostics;
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Navigation;
using KeyEventArgs = System.Windows.Input.KeyEventArgs;

namespace DataManager
{
    /// &lt;summary&gt;
    /// ServerCheckTab.xaml の相互作用ロジック
    /// &lt;/summary&gt;
    public partial class ServerCheckTab : System.Windows.Controls.UserControl
    {
        public ServerCheckTab()
        {
            InitializeComponent();
        }

        private void KeyWordTextBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                if (DataContext is MainViewModel viewModel && viewModel.AddResearchGroupingKeyWordCommand.CanExecute(null))
                {
                    viewModel.AddResearchGroupingKeyWordCommand.Execute(null);
                }
            }
        }

        private void ExtensionTextBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                if (DataContext is MainViewModel viewModel && viewModel.AddResearchFileExtensionCommand.CanExecute(null))
                {
                    viewModel.AddResearchFileExtensionCommand.Execute(null);
                }
            }
        }

        private void GroupingKeyWords_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            if (DataContext is MainViewModel viewModel)
            {
                // コマンドの有効状態を更新
                viewModel.RemoveResearchGroupingKeyWordCommand.NotifyCanExecuteChanged();
            }
        }

        private void ResearchExtensions_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            if (DataContext is MainViewModel viewModel)
            {
                // コマンドの有効状態を更新
                viewModel.RemoveResearchFileExtensionCommand.NotifyCanExecuteChanged();
            }
        }

        private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)
        {
            //System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(e.Uri.ToString()) { UseShellExecute = true });
            //e.Handled = true;

            var menu = new ContextMenu();
            var openItem = new MenuItem { Header = "ファイルを開く" };
            var openFolderItem = new MenuItem { Header = "フォルダを開く" };

            openItem.Click += (s, args) =&gt;
            {
                Process.Start(new ProcessStartInfo(e.Uri.ToString()) { UseShellExecute = true });
            };

            openFolderItem.Click += (s, args) =&gt;
            {
                string? folderPath = System.IO.Path.GetDirectoryName(e.Uri.LocalPath);
                if (folderPath == null)
                {
                    e.Handled = true;
                    return;
                }
                Process.Start(new ProcessStartInfo("explorer.exe", folderPath) { UseShellExecute = true });
            };

            menu.Items.Add(openItem);
            menu.Items.Add(openFolderItem);
            menu.IsOpen = true;

            e.Handled = true;
        }
    }
}
            </code></pre>

            <p>
                UniqueObservableCollection.cs
            </p>
            <pre><code class="prettyprint">
                using System.Collections.ObjectModel;

namespace DataManager
{
    public class UniqueObservableCollection&lt;T&gt; : ObservableCollection&lt;T&gt;
    {
        private readonly HashSet&lt;T&gt; _hashSet = [];

        protected override void InsertItem(int index, T item)
        {
            if (_hashSet.Add(item))
            {
                base.InsertItem(index, item);
            }
        }

        protected override void SetItem(int index, T item)
        {
            if (_hashSet.Contains(this[index]))
            {
                _hashSet.Remove(this[index]);
            }

            if (_hashSet.Add(item))
            {
                base.SetItem(index, item);
            }
            else
            {
                _hashSet.Add(this[index]); // 元のアイテムを戻す
            }
        }

        protected override void RemoveItem(int index)
        {
            _hashSet.Remove(this[index]);
            base.RemoveItem(index);
        }

        protected override void ClearItems()
        {
            _hashSet.Clear();
            base.ClearItems();
        }
    }
}
            </code></pre>

            <p>
                Val.cs
            </p>
            <pre><code class="prettyprint">
                
        public static readonly List&lt;string&gt; dataTypes = ["-", "xlsx", "ori", "ohters"];

        public static readonly List&lt;string&gt; researchHistoryHeaders = ["No", "調査結果名", "調査タイプ", "調査日時", "調査フォルダ", "調査結果リンク", "分類方法", "データ指定", "容量指定", "容量", "キーワード", "拡張子"];
        public static readonly List&lt;string&gt; researchResultHeaders = ["No", "フォルダ名", "ファイル名", "サイズ(MB)", "更新日時", "作成日時", "分類"];
            </code></pre>
        </article>
    </div>

    <footer>
        <div class="wrapper">
            <p><small>&copy; 2022 大人の学び舎</small></p>
        </div>
    </footer>
</body>

</html>