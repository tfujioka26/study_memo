<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="python勉強中です。。">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>大人の学び舎 - python-study</title>

    <!-- CSS -->
    <link href="https://unpkg.com/ress/dist/ress.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <!-- <link href="vibrant-ink.css" rel="stylesheet"> -->
    <link href="prettify.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c" rel="stylesheet">
    <link rel="icon" type="image/png" href="favicon.png">

    <!-- javascript -->
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
</head>

<body>
    <div id="study" class="big-bg">
        <header class="page-header wrapper">
            <h1>
                <a href="index.html"><img class="logo" src="logo.png" alt="大人の学び舎ホーム"></a>
            </h1>
            <nav>
                <ul class="main-nav">
                    <li><a href="python_study_vol0.html">python</a></li>
                    <li><a href="csharp_study_vol0.html">C#</a></li>
                    <li><a href="excelvba_study_vol0.html">ExcelVBA</a></li>
                    <li><a href="statistics_study_vol0.html">統計</a></li>
                </ul>
            </nav>
        </header>

        <div class="wrapper">
            <h2 class="page-title">c#-study</h2>
        </div>
    </div>

    <div class="study-contents wrapper">
        <aside>
            <h3 class="sub-title">カテゴリー</h3>
            <ul class="sub-menu">
                <li><a href="python_study_vol0.html">基本操作</a></li>
                <li><a href="python_study_vol1.html">画像関連</a></li>
                <li><a href="python_study_vol2.html">********</a></li>
                <li><a href="python_study_vol3.html">********</a></li>
            </ul>

            <h3 class="sub-title-2nd">基本操作</h3>
            <ul class="sub-menu">
                <li><a href="#python-base-v0">ディレクトリ内のファイルをリストアップ</a></li>
                <li><a href="#">********</a></li>
                <li><a href="#">********</a></li>
                <li><a href="#">********</a></li>
            </ul>
        </aside>

        <article id="python-base-v0">
            <header class="post-info">
                <h2 class="post-title">ディレクトリ内のファイルをリストアップ</h2>
                <p class="post-date">1/3 <span>2022</span></p>
                <p class="post-cat">カテゴリー：example</p>
            </header>

            <p>
                AddViewModel.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using NPOI.SS.UserModel;
using NPOI.XSSF.UserModel;
using System.Collections.ObjectModel;
using System.IO;
using System.Windows;
using System.Windows.Interop;
using System.Windows.Media.Imaging;

namespace DataManager
{
    public partial class AddViewModel : ObservableObject
    {
        #region "変数定義"
        [ObservableProperty]
        private string selectedAddPath = string.Empty;

        [ObservableProperty]
        private bool isAddAllFiles; //フォルダ内のデータを全て読み込むか

        [ObservableProperty]
        private bool isAllFilesEnabled; //フォルダ内のデータを全て読み込むかのチェックボックスのイネーブル変数

        [ObservableProperty]
        private bool isAddSubFolder;    //サブフォルダを含めるか

        [ObservableProperty]
        private List&lt;string&gt; _products, _types, _itemNames, _vers = [],  _lots = [], _programs = [], _owners = [];

        [ObservableProperty]
        private List&lt;string&gt; _slots = ["-", "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", 
                                        "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25"];

        [ObservableProperty]
        private string productText = string.Empty;
        partial void OnProductTextChanged(string value)
        {
            if (IsDataItemChanging) return; //DataItemを切り替える時はスキップする

            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            if (NewDataItems.Count &gt; 1) //複数ファイルの場合は、設定を変えた場合、即時反映させる
            {
                if (IsBulkSetting)  //一括設定の場合は、全てのアイテムの設定を変更する
                {
                    foreach (var item in NewDataItems) item.Product = tmpValue;
                }
                else //一括設定でない場合、選択中のアイテムのみの設定を変更する
                {
                    var item = NewDataItems[SelectedDataItemIndex];
                    item.Product = tmpValue;
                }
            }

            var _product = _dataListBoxItems.Keys.FirstOrDefault(item =&gt; item.Name == tmpValue);
            if (_product != null)   //productが既存アイテムの場合
            {
                Types = _dataListBoxItems[_product].Keys.Select(item =&gt; item.Name).ToList();
                foreach (var newType in newTypes) Types.Add(newType);   //このウインドウで新たに設定したTypeをリストに追加
            }
            else //productが新規アイテムの場合
            {
                if (!Products.Contains(tmpValue)) Products.Add(tmpValue);   //***新規Productの場合追加***
                Types = Vals.initialTypes;  //productが新規アイテムの場合はデフォルトのアイテムをリストに設定
                foreach (var newType in newTypes) Types.Add(newType);   //このウインドウで新たに設定したTypeをリストに追加
            }
            ItemNames = Vals.initialItemNames;    //Typeが確定しないとItemNamesが確定しないのでイニシャルの値を格納
            foreach (var newItemName in newItemNames) ItemNames.Add(newItemName);   //このウインドウで新たに設定したItemNameをリストに追加

            string filePath = _folderPath + "\\" + tmpValue + "_" + (!string.IsNullOrEmpty(TypeText) ? TypeText : "-")
                                + "_" + (!string.IsNullOrEmpty(ItemNameText) ? ItemNameText : "all") + ".xlsx";
            SetComboBox(filePath);  //Products, Types, ItemNames 以外のComboBoxのリストを更新
        }

        [ObservableProperty]
        private string typeText = string.Empty;
        partial void OnTypeTextChanged(string value)
        {
            if (IsDataItemChanging) return; //DataItemを切り替える時はスキップする

            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            if (NewDataItems.Count &gt; 1) //複数ファイルの場合は、設定を変えた場合、即時反映させる
            {
                if (IsBulkSetting)  //一括設定の場合は、全てのアイテムの設定を変更する
                {
                    foreach (var item in NewDataItems) item.Type = tmpValue;
                }
                else //一括設定でない場合、選択中のアイテムのみの設定を変更する
                {
                    var item = NewDataItems[SelectedDataItemIndex];
                    item.Type = tmpValue;
                }
            }

            string tmpProduct = !string.IsNullOrEmpty(ProductText) ? ProductText : "-";
            var _product = _dataListBoxItems.Keys.FirstOrDefault(item =&gt; item.Name == tmpProduct);
            if (_product != null)   //productが既存アイテムの場合
            {
                var _type = _dataListBoxItems[_product].Keys.FirstOrDefault(item =&gt; item.Name == tmpValue);
                if (_type != null)   //typeが既存アイテムの場合
                {
                    ItemNames = _dataListBoxItems[_product][_type].Select(item =&gt; item.Name).ToList();
                    foreach (var newItemName in newItemNames) ItemNames.Add(newItemName);   //このウインドウで新たに設定したItemNameをリストに追加
                }
                else //typeが新規アイテムの場合
                {
                    if (!newTypes.Contains(tmpValue))
                    {   //***新規のType場合、Types,newTypes追加***
                        Types.Add(tmpValue);
                        newTypes.Add(tmpValue);   
                    }
                    ItemNames = Vals.initialItemNames;
                    foreach (var newItemName in newItemNames) ItemNames.Add(newItemName);   //このウインドウで新たに設定したItemNameをリストに追加
                }
            }
            else //productが新規アイテムの場合
            {
                if (!newTypes.Contains(tmpValue))
                {   //***新規のType場合、Types,newTypes追加***
                    Types.Add(tmpValue);
                    newTypes.Add(tmpValue);
                }
                ItemNames = Vals.initialItemNames;
                foreach (var newItemName in newItemNames) ItemNames.Add(newItemName);
            }

            string filePath = _folderPath + "\\" + tmpProduct + "_" + tmpValue + "_" + (!string.IsNullOrEmpty(ItemNameText) ? ItemNameText : "all") + ".xlsx";
            SetComboBox(filePath);  //Products, Types, ItemNames 以外のComboBoxのリストを更新
        }

        [ObservableProperty]
        private string itemNameText = string.Empty;
        partial void OnItemNameTextChanged(string value)
        {
            if (IsDataItemChanging) return; //DataItemを切り替える時はスキップする

            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            if (NewDataItems.Count &gt; 1) //複数ファイルの場合は、設定を変えた場合、即時反映させる
            {
                if (IsBulkSetting)  //一括設定の場合は、全てのアイテムの設定を変更する
                {
                    foreach (var item in NewDataItems) item.ItemName = tmpValue;
                }
                else //一括設定でない場合、選択中のアイテムのみの設定を変更する
                {
                    var item = NewDataItems[SelectedDataItemIndex];
                    item.ItemName = tmpValue;
                }
            }

            string tmpProduct = !string.IsNullOrEmpty(ProductText) ? ProductText : "-";
            var _product = _dataListBoxItems.Keys.FirstOrDefault(item =&gt; item.Name == tmpProduct);
            if (_product != null)   //productが既存アイテムの場合
            {
                string tmpType = !string.IsNullOrEmpty(TypeText) ? TypeText : "-";
                var _type = _dataListBoxItems[_product].Keys.FirstOrDefault(item =&gt; item.Name == tmpType);
                if (_type != null)  //typeが既存アイテムの場合
                {
                    var _itemName = _dataListBoxItems[_product][_type].FirstOrDefault(item =&gt; item.Name == tmpValue);
                    if (_itemName == null) //itemNameが新規アイテムの場合
                    {   
                        if (!newItemNames.Contains(tmpValue))
                        {   //***新規のItemName場合、ItemNames,newItemNames追加***
                            ItemNames.Add(tmpValue);
                            newItemNames.Add(tmpValue);
                        }
                    }
                }
                else //typeが新規アイテムの場合
                {
                    if (!newItemNames.Contains(tmpValue))
                    {   //***新規のItemName場合、ItemNames,newItemNames追加***
                        ItemNames.Add(tmpValue);
                        newItemNames.Add(tmpValue);
                    }
                }
            }
            else //productが新規アイテムの場合
            {
                if (!newItemNames.Contains(tmpValue))
                {   //***新規のItemName場合、ItemNames,newItemNames追加***
                    ItemNames.Add(tmpValue);
                    newItemNames.Add(tmpValue);
                }
            }

            string filePath = _folderPath + "\\" + (!string.IsNullOrEmpty(ProductText) ? ProductText : "-") + "_" 
                                + (!string.IsNullOrEmpty(TypeText) ? TypeText : "-") + "_" + tmpValue + ".xlsx";
            SetComboBox(filePath);  //Products, Types, ItemNames 以外のComboBoxのリストを更新
        }

        [ObservableProperty]
        private string verText = string.Empty;
        partial void OnVerTextChanged(string value)
        {
            if (IsDataItemChanging) return; //DataItemを切り替える時はスキップする

            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            if (NewDataItems.Count &gt; 1)
            {
                if (IsBulkSetting)  //一括設定の場合は、全てのアイテムの設定を変更する
                {
                    foreach (var item in NewDataItems)
                    {
                        item.Ver = tmpValue;
                    }
                }
                else //一括設定でない場合、選択中のアイテムのみの設定を変更する
                {
                    var item = NewDataItems[SelectedDataItemIndex];
                    item.Ver = tmpValue;
                }
            }

            if (!Vers.Contains(tmpValue))
            {
                Vers.Add(tmpValue);
                newVers.Add(tmpValue);
            }
        }

        [ObservableProperty]
        private string lotText = string.Empty;
        partial void OnLotTextChanged(string value)
        {
            if (IsDataItemChanging) return; //DataItemを切り替える時はスキップする

            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            if (NewDataItems.Count &gt; 1)
            {
                if (IsBulkSetting)  //一括設定の場合は、全てのアイテムの設定を変更する
                {
                    foreach (var item in NewDataItems)
                    {
                        item.Lot = tmpValue;
                        string tmpValue2 = !string.IsNullOrEmpty(item.Slot) ? value : "-";
                        item.LotSlot = tmpValue + "-" + tmpValue2;
                    }
                }
                else //一括設定でない場合、選択中のアイテムのみの設定を変更する
                {
                    var item = NewDataItems[SelectedDataItemIndex];
                    item.Lot = tmpValue;
                    string tmpValue2 = !string.IsNullOrEmpty(item.Slot) ? value : "-";
                    item.LotSlot = tmpValue + "-" + tmpValue2;
                }
            }

            if (!Lots.Contains(tmpValue))
            {
                Lots.Add(tmpValue);
                newLots.Add(tmpValue);
            }
        }

        [ObservableProperty]
        private string slotText = string.Empty;
        partial void OnSlotTextChanged(string value)
        {
            if (IsDataItemChanging) return; //DataItemを切り替える時はスキップする

            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            if (NewDataItems.Count &gt; 1)
            {
                if (IsBulkSetting)
                {
                    foreach (var item in NewDataItems)
                    {
                        item.Slot = tmpValue;
                        string tmpValue2 = !string.IsNullOrEmpty(item.Lot) ? value : "-";
                        item.LotSlot = tmpValue2 + "-" + tmpValue;
                    }
                }
                else
                {
                    var item = NewDataItems[SelectedDataItemIndex];
                    item.Slot = tmpValue;
                    string tmpValue2 = !string.IsNullOrEmpty(item.Lot) ? value : "-";
                    item.LotSlot = tmpValue2 + "-" + tmpValue;
                }
            }
            //Slot情報数は変わらないので、newの処理はなし
        }

        [ObservableProperty]
        private string programText = string.Empty;
        partial void OnProgramTextChanged(string value)
        {
            if (IsDataItemChanging) return; //DataItemを切り替える時はスキップする

            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            if (NewDataItems.Count &gt; 1)
            {
                if (IsBulkSetting)
                {
                    foreach (var item in NewDataItems) item.Program = tmpValue;
                }
                else
                {
                    var item = NewDataItems[SelectedDataItemIndex];
                    item.Program = tmpValue;
                }
            }

            if (!newPrograms.Contains(tmpValue))
            {
                Programs.Add(tmpValue);
                newPrograms.Add(tmpValue);
            }
        }

        [ObservableProperty]
        private string dateText = string.Empty;

        [ObservableProperty]
        private string ownerText = string.Empty;
        partial void OnOwnerTextChanged(string value)
        {
            if (IsDataItemChanging) return; //DataItemを切り替える時はスキップする

            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            if (NewDataItems.Count &gt; 1)
            {
                if (IsBulkSetting)
                {
                    foreach (var item in NewDataItems) item.Owner = tmpValue;
                }
                else
                {
                    var item = NewDataItems[SelectedDataItemIndex];
                    item.Owner = tmpValue;
                }
            }

            if (!newOwners.Contains(tmpValue))
            {
                Owners.Add(tmpValue);
                newOwners.Add(tmpValue);
            }
        }

        [ObservableProperty]
        private string remarkText = string.Empty;
        partial void OnRemarkTextChanged(string value)
        {
            if (IsDataItemChanging) return; //DataItemを切り替える時はスキップする

            string tmpValue = !string.IsNullOrEmpty(value) ? value : string.Empty;
            if (NewDataItems.Count &gt; 1)
            {
                if (IsBulkSetting) 
                {
                    foreach (var item in NewDataItems) item.Remark = tmpValue;
                }
                else
                {
                    var item = NewDataItems[SelectedDataItemIndex];
                    item.Remark = tmpValue;
                }
            }
            //RemarkはTextBoxのため、リストの処理はなし
        }

        [ObservableProperty]
        private ObservableCollection&lt;DataItem&gt; newDataItems = [];   //追加のDataItem

        [ObservableProperty]
        private BitmapSource fileIcon;

        [ObservableProperty]
        private string fileName = string.Empty;

        [ObservableProperty]
        private bool isAddSelectEnabled;

        [ObservableProperty]
        private bool isBulkSetting;  //複数ファイルの場合、一括設定するかどうかの変数。

        [ObservableProperty]
        private int selectedDataItemIndex;
        partial void OnSelectedDataItemIndexChanged(int value)
        {
            if (value != -1)
            {
                IsDataItemChanging = true;
                var item = NewDataItems[value];
                FileIcon = GetFileIcon(item.Link);
                FileName = Path.GetFileName(item.Link);
                FileInfo fileInfo = new FileInfo(item.Link); // FileInfoオブジェクトを作成
                DateText = fileInfo.LastWriteTime.ToString("yyyy/MM/dd HH:mm");
                ProductText = item.Product;
                TypeText = item.Type;
                ItemNameText = item.ItemName;
                LotText = item.Lot;
                SlotText = item.Slot;
                ProgramText = item.Program;
                RemarkText = item.Remark;
                IsDataItemChanging = false;
            }
        }

        [ObservableProperty]
        private bool isDataItemChanging;    //ListBoxでDataItemが切り替わっている状態を示す

        [ObservableProperty]
        private DataItem selectedDataItem = new();

        [ObservableProperty]
        private ObservableCollection&lt;DataItem&gt; selectedDataItems = [];

        [ObservableProperty]
        private bool isDeleteButtonEnabled;

        private int dataItemCnt;
        private readonly string _folderPath;
        readonly Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt; _dataListBoxItems;
        private readonly List&lt;string&gt; newTypes = [];
        private readonly List&lt;string&gt; newItemNames = [];
        private readonly List&lt;string&gt; newVers = [];
        private readonly List&lt;string&gt; newLots = [];
        private readonly List&lt;string&gt; newPrograms = [];
        private readonly List&lt;string&gt; newOwners = [];
        #endregion

        /// &lt;summary&gt;
        /// Addコマンド時のコンストラクタ
        /// &lt;/summary&gt;
        /// &lt;param name="folderPath"&gt;private/public設定ファイルの保存フォルダ&lt;/param&gt;
        /// &lt;param name="selectedProduct"&gt;Manegementで選択中のProduct&lt;/param&gt;
        /// &lt;param name="selectedType"&gt;Manegementで選択中のType&lt;/param&gt;
        /// &lt;param name="selectedItemName"&gt;Manegementで選択中のItemName&lt;/param&gt;
        /// &lt;param name="dataListBoxItems"&gt;ManegementのListBoxの情報&lt;/param&gt;
        public AddViewModel(string folderPath, ItemModel selectedProduct, ItemModel selectedType, ItemModel selectedItemName, 
                            Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt; dataListBoxItems) 
        {
            _folderPath = folderPath;
            _dataListBoxItems = dataListBoxItems;
            Products = _dataListBoxItems.Keys.Select(item =&gt; item.Name).ToList();
            ProductText = selectedProduct.Name;
            Types = _dataListBoxItems[selectedProduct].Keys.Select(item =&gt; item.Name).ToList();
            TypeText = selectedType.Name;
            ItemNames = _dataListBoxItems[selectedProduct][selectedType].Select(item =&gt; item.Name).ToList();
            ItemNameText = selectedItemName.Name;
            SetComboBox(_folderPath + "\\" + selectedProduct.Name + "_" + selectedType.Name + "_" + (selectedItemName.Name != "all" ? selectedItemName.Name : "-") + ".xlsx");

            IsAddSelectEnabled = true;
            IsBulkSetting = false;
            IsDataItemChanging = false;
            IsDeleteButtonEnabled = true;
            IsAllFilesEnabled = true;
            dataItemCnt = 0;

            //FileIcon = new BitmapImage(new Uri("pack://application:,,,/DataManager;component/Resources/DefaultIcon.png"));
            FileIcon = null!;
            FileName = string.Empty;
            DateText = string.Empty;

            NewDataItems.CollectionChanged += (s, e) =&gt; AddOKCommand.NotifyCanExecuteChanged();
            SelectedDataItems.CollectionChanged += (s, e) =&gt; DeleteListBoxItemCommand.NotifyCanExecuteChanged(); // SelectedDataItemsの変更を監視し、CanExecuteを更新
        }

        /// &lt;summary&gt;
        /// ドラック＆ドロップ時のコンストラクタ
        /// &lt;/summary&gt;
        /// &lt;param name="folderPath"&gt;private/public設定ファイルの保存フォルダ&lt;/param&gt;
        /// &lt;param name="selectedProduct"&gt;Manegementで選択中のProduct&lt;/param&gt;
        /// &lt;param name="selectedType"&gt;Manegementで選択中のType&lt;/param&gt;
        /// &lt;param name="selectedItemName"&gt;Manegementで選択中のItemName&lt;/param&gt;
        /// &lt;param name="dataListBoxItems"&gt;ManegementのListBoxの情報&lt;/param&gt;
        /// &lt;param name="files"&gt;ドラック＆ドロップされたファイル&lt;/param&gt;
        public AddViewModel(string folderPath, ItemModel selectedProduct, ItemModel selectedType, ItemModel selectedItemName,
                            Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt; dataListBoxItems, string[] files)
        {
            _folderPath = folderPath;
            _dataListBoxItems = dataListBoxItems;
            Products = _dataListBoxItems.Keys.Select(item =&gt; item.Name).ToList();
            ProductText = selectedProduct.Name;
            Types = _dataListBoxItems[selectedProduct].Keys.Select(item =&gt; item.Name).ToList();
            TypeText = selectedType.Name;
            ItemNames = _dataListBoxItems[selectedProduct][selectedType].Select(item =&gt; item.Name).ToList();
            ItemNameText = selectedItemName.Name;
            SetComboBox(_folderPath + "\\" + selectedProduct.Name + "_" + selectedType.Name + "_" + (selectedItemName.Name != "all" ? selectedItemName.Name : "-") + ".xlsx");

            IsAddSelectEnabled = false;
            IsBulkSetting = false;
            IsDataItemChanging = false;
            IsDeleteButtonEnabled = true;
            IsAllFilesEnabled = false;
            dataItemCnt = 0;

            if (files.Length &gt; 1) SelectedAddPath = Path.GetDirectoryName(files[0]) ?? "-";
            else SelectedAddPath = files[0];
            FileIcon = GetFileIcon(files[0]);
            FileName = Path.GetFileName(files[0]);
            FileInfo fileInfo = new(files[0]); // FileInfoオブジェクトを作成
            DateText = fileInfo.LastWriteTime.ToString("yyyy/MM/dd HH:mm");

            AddSelectDrag(files);
            SelectedDataItemIndex = 0;

            NewDataItems.CollectionChanged += (s, e) =&gt; AddOKCommand.NotifyCanExecuteChanged();
            SelectedDataItems.CollectionChanged += (s, e) =&gt; DeleteListBoxItemCommand.NotifyCanExecuteChanged(); // SelectedDataItemsの変更を監視し、CanExecuteを更新
        }

        /// &lt;summary&gt;
        /// 編集コマンド時のコンストラクタ
        /// &lt;/summary&gt;
        /// &lt;param name="folderPath"&gt;private/public設定ファイルの保存フォルダ&lt;/param&gt;
        /// &lt;param name="selectedProduct"&gt;Manegementで選択中のProduct&lt;/param&gt;
        /// &lt;param name="selectedType"&gt;Manegementで選択中のType&lt;/param&gt;
        /// &lt;param name="selectedItemName"&gt;Manegementで選択中のItemName&lt;/param&gt;
        /// &lt;param name="dataListBoxItems"&gt;ManegementのListBoxの情報&lt;/param&gt;
        /// &lt;param name="files"&gt;ドラック＆ドロップされたファイル&lt;/param&gt;
        public AddViewModel(string folderPath, Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt; dataListBoxItems, List&lt;DataItem&gt; selectedDataItems)
        {
            _folderPath = folderPath;
            _dataListBoxItems = dataListBoxItems;
            ProductText = selectedDataItems[0].Product;
            TypeText = selectedDataItems[0].Type;
            ItemNameText = selectedDataItems[0].ItemName;

            Products = _dataListBoxItems.Keys.Select(item =&gt; item.Name).ToList();
            var selectedProduct = _dataListBoxItems.Keys.FirstOrDefault(item =&gt; item.Name == ProductText);
            if (selectedProduct != null)
            {
                Types = _dataListBoxItems[selectedProduct].Keys.Select(item =&gt; item.Name).ToList();
                var selectedType = _dataListBoxItems[selectedProduct].Keys.FirstOrDefault(item =&gt; item.Name == TypeText);
                if (selectedType != null)
                {
                    ItemNames = _dataListBoxItems[selectedProduct][selectedType].Select(item =&gt; item.Name).ToList();
                    var selectedItemName = _dataListBoxItems[selectedProduct][selectedType].FirstOrDefault(item =&gt; item.Name == ItemNameText);
                    SetComboBox(_folderPath + "\\" + selectedProduct.Name + "_" + selectedType.Name + "_" 
                                + (selectedItemName != null ? (selectedItemName.Name != "all" ? selectedItemName.Name : "-" ) : "-") + ".xlsx");
                }
                else
                {
                    ItemNames = Vals.initialItemNames;
                    SetComboBox(_folderPath + "\\" + selectedProduct.Name + "_" + "-" + "_" + "-" + ".xlsx");
                }
            }
            else
            {
                Types = Vals.initialTypes;
                ItemNames = Vals.initialItemNames;
                SetComboBox(_folderPath + "\\" + "-" + "_" + "-" + "_" + "-" + ".xlsx");
            }
            
            IsAddSelectEnabled = false;
            IsBulkSetting = false;
            IsDataItemChanging = false;
            IsDeleteButtonEnabled = false;
            IsAllFilesEnabled = false;
            dataItemCnt = 0;

            if (selectedDataItems.Count &gt; 1) SelectedAddPath = Path.GetDirectoryName(selectedDataItems[0].Link) ?? "-";
            else SelectedAddPath = selectedDataItems[0].Link;
            FileIcon = GetFileIcon(selectedDataItems[0].Link);
            FileName = Path.GetFileName(selectedDataItems[0].Link);
            FileInfo fileInfo = new(selectedDataItems[0].Link); // FileInfoオブジェクトを作成
            DateText = fileInfo.LastWriteTime.ToString("yyyy/MM/dd HH:mm");

            AddSelectDataItems(selectedDataItems);
            SelectedDataItemIndex = 0;

            NewDataItems.CollectionChanged += (s, e) =&gt; AddOKCommand.NotifyCanExecuteChanged();
            SelectedDataItems.CollectionChanged += (s, e) =&gt; DeleteListBoxItemCommand.NotifyCanExecuteChanged(); // SelectedDataItemsの変更を監視し、CanExecuteを更新
        }

        #region "コマンド定義"
        /// &lt;summary&gt;
        /// ファイル選択のコマンド(CheckBoxのオプションで選択方法を切り替え)
        /// &lt;/summary&gt;
        [RelayCommand]
        private void AddSelect()
        {
            if (!IsAddAllFiles)
            {
                using var openFileDialog = new OpenFileDialog();
                if (openFileDialog.ShowDialog() == DialogResult.OK)
                {
                    NewDataItems.Clear(); dataItemCnt = 0;
                    SelectedAddPath = openFileDialog.FileName;
                    var dataItem = MakeNewDataItem(SelectedAddPath);
                    NewDataItems.Add(dataItem);
                    FileIcon = GetFileIcon(SelectedAddPath);
                    FileName = dataItem.DataName;
                    FileInfo fileInfo = new(SelectedAddPath); // FileInfoオブジェクトを作成
                    DateText = fileInfo.LastWriteTime.ToString("yyyy/MM/dd HH:mm");
                }
            }
            else
            {
                //TODO: ファイルが見えるタイプに修正
                using var folderDialog = new FolderBrowserDialog();
                if (folderDialog.ShowDialog() == DialogResult.OK) 
                {
                    NewDataItems.Clear(); dataItemCnt = 0;
                    SelectedAddPath = folderDialog.SelectedPath; 
                    var searchOption = IsAddSubFolder ? SearchOption.AllDirectories : SearchOption.TopDirectoryOnly; 
                    var filePaths = Directory.GetFiles(SelectedAddPath, "*.*", searchOption);

                    foreach (var path in filePaths) 
                    {
                        var dataItem = MakeNewDataItem(path);
                        NewDataItems.Add(dataItem);
                    }

                    if (filePaths.Length &gt; 0)
                    {
                        FileIcon = GetFileIcon(filePaths[0]);
                        FileName = System.IO.Path.GetFileName(filePaths[0]);
                        FileInfo fileInfo = new(filePaths[0]); // FileInfoオブジェクトを作成
                        DateText = fileInfo.LastWriteTime.ToString("yyyy/MM/dd HH:mm");
                    }
                }
            }
        }

        /// &lt;summary&gt;
        /// ファイル選択後に押すOKボタンコマンド。ファイルが1つの場合はこのタイミングで設定をNewDataItemsに反映。
        /// 一括設定にチェックがある場合は、このタイミングでも設定をNewDataItemsに反映。
        /// &lt;/summary&gt;
        /// &lt;param name="window"&gt;このウインドウ&lt;/param&gt;
        [RelayCommand(CanExecute = nameof(CanAddOK))]
        private void AddOK(Window window)
        {
            if (NewDataItems.Count == 1)
            {
                var item = NewDataItems[0];
                RenewalNewDataItem(item);
            }
            else if (IsBulkSetting)
            {
                foreach (var item in NewDataItems)
                {
                    RenewalNewDataItem(item);
                }
            }

            // 並べ替えを行い、結果をDataItemsに代入
            if (NewDataItems.Count &gt; 2) SortNewDataItems();

            window.DialogResult = true;
            window.Close();
        }
        private bool CanAddOK()
        {
            return NewDataItems.Count &gt; 0;
        }

        /// &lt;summary&gt;
        /// キャンセルしてウィンドウを閉じる
        /// &lt;/summary&gt;
        /// &lt;param name="window"&gt;このウィンドウ&lt;/param&gt;
        [RelayCommand]
        private static void AddCancel(Window window)
        {
            window.DialogResult = false;
            window.Close();
        }

        /// &lt;summary&gt;
        /// リストで選択したファイルを削除
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanDeleteListBoxItem))]
        private void DeleteListBoxItem()
        {
            int tmpSelectedDataItemIndex = SelectedDataItemIndex;
            var itemsToDelete = SelectedDataItems.ToList(); 
            foreach (var item in itemsToDelete) 
            {
                NewDataItems.Remove(item); 
            }
            
            if (NewDataItems.Count == 0)
            {
                SelectedDataItems.Clear(); // 選択アイテムをクリア
            }
            else
            {
                if (tmpSelectedDataItemIndex == 0) SelectedDataItemIndex = 0;
                else SelectedDataItemIndex = tmpSelectedDataItemIndex - 1;
            }
        }
        private bool CanDeleteListBoxItem()
        {
            return SelectedDataItems.Count &gt; 0 && IsDeleteButtonEnabled;
        }
        #endregion

        #region "メソッド定義"
        /// &lt;summary&gt;
        /// 選択した設定に応じてComboBoxのリストを更新
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;データリストの設定ファイルパス&lt;/param&gt;
        private void SetComboBox(string filePath)
        {
            if (File.Exists(filePath))
            {
                var result = LoadDataList(filePath);
                Vers = result.Item1;
                Lots = result.Item2;
                Programs = result.Item3;
                Owners = result.Item4;
                //dataItemCnt = 0;
            }
            else
            {
                Vers = [];
                Lots = [];
                Programs = [];
                Owners = [];
                //dataItemCnt = 0;
            }

            foreach (var newVer in newVers)
            {
                if (!Vers.Contains(newVer)) Lots.Add(newVer);
            }
            foreach (var newLot in newLots)
            {
                if (!Lots.Contains(newLot)) Lots.Add(newLot);
            }
            foreach (var newProgram in newPrograms)
            {
                if (!Programs.Contains(newProgram)) Programs.Add(newProgram);
            }
            foreach (var newOwner in newOwners)
            {
                if (!Owners.Contains(newOwner)) Programs.Add(newOwner);
            }
        }

        /// &lt;summary&gt;
        /// 選択した設定の設定ファイルから必要情報を読み込み
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;設定ファイルの保存フォルダ&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private static (List&lt;string&gt;, List&lt;string&gt;, List&lt;string&gt;, List&lt;string&gt;) LoadDataList(string filePath)
        {
            List&lt;string&gt; vers = [];
            List&lt;string&gt; lots = [];
            List&lt;string&gt; programs = [];
            List&lt;string&gt; owners = [];

            using var stream = new FileStream(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(stream);
            ISheet sheet = workbook.GetSheetAt(0);

            // データ行を取得
            for (int i = 1; i &lt;= sheet.LastRowNum; i++)
            {
                var row = sheet.GetRow(i);
                if (row == null) continue;
                //0:No, 1:DataName, 2:Link, 3:Product, 4:Type, 5:ItemName, 6:Ver, 7:Lot, 8:Slot, 9:LotSlot, 10:Program, 11:Date, 12:Owner, 13:Remark
                if (!vers.Contains(row.GetCell(6).StringCellValue)) vers.Add(row.GetCell(6).StringCellValue);
                if (!lots.Contains(row.GetCell(7).StringCellValue)) lots.Add(row.GetCell(7).StringCellValue);
                if (!programs.Contains(row.GetCell(10).StringCellValue)) programs.Add(row.GetCell(10).StringCellValue);
                if (!owners.Contains(row.GetCell(12).StringCellValue)) owners.Add(row.GetCell(12).StringCellValue);
            }
            workbook.Close();
            return (vers, lots, programs, owners);
        }

        /// &lt;summary&gt;
        /// 追加ファイルのアイコン情報取得
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;追加ファイルのパス&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private static BitmapSource GetFileIcon(string filePath)
        {
            Icon? icon = Icon.ExtractAssociatedIcon(filePath);
            if (icon != null)
            {
                return Imaging.CreateBitmapSourceFromHIcon(icon.Handle, Int32Rect.Empty, BitmapSizeOptions.FromEmptyOptions());
            }
            else
            {
                //return new BitmapImage(new Uri("pack://application:,,,/DataManager;component/Resources/DefaultIcon.png"));
                return null!;
            }
        }

        /// &lt;summary&gt;
        /// ドラック＆ドロップされたファイルをNewDataItemsに割り当てる
        /// &lt;/summary&gt;
        /// &lt;param name="filePaths"&gt;ドラック＆ドロップされたファイル&lt;/param&gt;
        private void AddSelectDrag(string[] filePaths)
        {
            NewDataItems.Clear(); 
            //dataItemCnt = 0;
            foreach (var path in filePaths)
            {
                var dataItem = MakeNewDataItem(path);
                NewDataItems.Add(dataItem);
            }
        }

        /// &lt;summary&gt;
        /// NewDataItemの新規設定
        /// &lt;/summary&gt;
        /// &lt;param name="path"&gt;ファイルパス&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private DataItem MakeNewDataItem(string path)
        {
            var dataItem = new DataItem
            {
                No = ++dataItemCnt,
                DataName = Path.GetFileName(path),
                Link = path,
                Product = !String.IsNullOrEmpty(ProductText) ? ProductText : "-",
                Type = !String.IsNullOrEmpty(TypeText) ? TypeText : "-",
                ItemName = !String.IsNullOrEmpty(ItemNameText) ? ItemNameText : "-",
                Ver = !String.IsNullOrEmpty(VerText) ? VerText : "-",
                Lot = !String.IsNullOrEmpty(LotText) ? LotText : "-",
                Slot = !String.IsNullOrEmpty(SlotText) ? SlotText : "-",
                LotSlot = (!String.IsNullOrEmpty(LotText) ? LotText : "-") + "-" + (!String.IsNullOrEmpty(SlotText) ? SlotText : "-"),
                Program = !String.IsNullOrEmpty(ProgramText) ? ProgramText : "-",
                Date = !String.IsNullOrEmpty(DateText) ? DateText : "-",
                Owner = !String.IsNullOrEmpty(OwnerText) ? OwnerText : "-",
                Remark = !String.IsNullOrEmpty(RemarkText) ? RemarkText : string.Empty
            };
            return dataItem;
        }

        /// &lt;summary&gt;
        /// 選択されているDataItemをNewDataItemに追記
        /// &lt;/summary&gt;
        /// &lt;param name="selectedDataItems"&gt;選択されているDataItem&lt;/param&gt;
        private void AddSelectDataItems(List&lt;DataItem&gt; selectedDataItems)
        {
            NewDataItems.Clear();
            foreach (var dataItem in selectedDataItems)
            {
                NewDataItems.Add(dataItem);
            }
        }

        /// &lt;summary&gt;
        /// NewDataItemsのデータ更新
        /// &lt;/summary&gt;
        /// &lt;param name="item"&gt;DataItem&lt;/param&gt;
        private void RenewalNewDataItem(DataItem item)
        {
            item.Product = !String.IsNullOrEmpty(ProductText) ? ProductText : "-";
            item.Type = !String.IsNullOrEmpty(TypeText) ? TypeText : "-";
            item.ItemName = !String.IsNullOrEmpty(ItemNameText) ? ItemNameText : "-";
            item.Ver = !String.IsNullOrEmpty(VerText) ? VerText : "-";
            item.Lot = !String.IsNullOrEmpty(LotText) ? LotText : "-";
            item.Slot = !String.IsNullOrEmpty(SlotText) ? SlotText : "-";
            item.LotSlot = item.Lot + "-" + item.Slot;
            item.Program = !String.IsNullOrEmpty(ProgramText) ? ProgramText : "-";
            item.Date = !String.IsNullOrEmpty(DateText) ? DateText : "-";
            item.Owner = !String.IsNullOrEmpty(OwnerText) ? OwnerText : "-";
            item.Remark = !String.IsNullOrEmpty(RemarkText) ? RemarkText : string.Empty;
        }

        /// &lt;summary&gt;
        /// NewDataItemsを並べ替える
        /// &lt;/summary&gt;
        private void SortNewDataItems()
        {
            var sortedList = NewDataItems
                .OrderBy(item =&gt; item.Product) // Productで昇順にソート
                .ThenBy(item =&gt; item.Type) // Typeで昇順にソート
                .ThenBy(item =&gt; item.ItemName) // ItemNameで昇順にソート
                .ToList();

            NewDataItems.Clear();
            foreach (var item in sortedList)
            {
                NewDataItems.Add(item);
            }
        }
        #endregion
    }
}
            </code></pre>

            <p>
                AddWindow.xaml
            </p>
            <pre><code class="prettyprint">
                &lt;Window x:Class="DataManager.AddWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DataManager"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Style="{StaticResource MaterialDesignWindow}"
        Title="データ追加" Height="540" Width="640"
        ResizeMode="NoResize"&gt;
    &lt;Grid&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="*"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
        &lt;/Grid.RowDefinitions&gt;

        &lt;Grid Grid.Row="0"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="*"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;
            &lt;TextBox Grid.Column="0" Margin="8 4 2 4" Height="35" VerticalAlignment="Center"
                     Padding="0 0 0 0"  materialDesign:HintAssist.Hint="FilePath"
                     Style="{StaticResource MaterialDesignOutlinedTextBox}"
                     Text="{Binding SelectedAddPath}" IsReadOnly="True"/&gt;
            &lt;Button Grid.Column="1" Command="{Binding AddSelectCommand}" Width="90" Margin="2 8 8 8" Content="Select" IsEnabled="{Binding IsAddSelectEnabled}"/&gt;
        &lt;/Grid&gt;

        &lt;StackPanel Grid.Row="1" Orientation="Horizontal"&gt;
            &lt;CheckBox Content="同じフォルダにあるファイルを全てリストアップする" Margin="8 8 8 8" IsChecked="{Binding IsAddAllFiles}" IsEnabled="{Binding IsAllFilesEnabled}"/&gt;
            &lt;CheckBox Content="サブフォルダもリストアップする" Margin="8 8 8 8" IsChecked="{Binding IsAddSubFolder}" IsEnabled="{Binding IsAddAllFiles}"/&gt;
            &lt;CheckBox Content="一括設定する" Margin="8 8 8 8" IsChecked="{Binding IsBulkSetting}"/&gt;
        &lt;/StackPanel&gt;

        &lt;StackPanel Grid.Row="2" Orientation="Horizontal"&gt;
            &lt;Image Source="{Binding FileIcon}" Width="24" Height="24" Margin="20 4 4 4"/&gt;
            &lt;TextBlock Text="{Binding FileName}" VerticalAlignment="Center" Margin="4"/&gt;
            &lt;TextBlock Text="{Binding DateText}" VerticalAlignment="Center" Margin="4"/&gt;
        &lt;/StackPanel&gt;

        &lt;Grid Grid.Row="3"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="*"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;

            &lt;Grid Grid.Column="0"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                    &lt;RowDefinition Height="*"/&gt;
                &lt;/Grid.RowDefinitions&gt;

                &lt;Grid Grid.Row="0"&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;

                    &lt;StackPanel Grid.Column="0" Orientation="Vertical"&gt;
                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Product:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                            &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxProduct" IsEditable="True" 
                                      ItemsSource="{Binding Products}" Text="{Binding ProductText}"/&gt;
                        &lt;/Grid&gt;

                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Type:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                            &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxType" IsEditable="True"
                                      ItemsSource="{Binding Types}" Text="{Binding TypeText}"/&gt;
                        &lt;/Grid&gt;

                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="ItemName:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                            &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxItemName" IsEditable="True"
                                      ItemsSource="{Binding ItemNames}" Text="{Binding ItemNameText}"/&gt;
                        &lt;/Grid&gt;
                    &lt;/StackPanel&gt;

                    &lt;StackPanel Grid.Column="1" Orientation="Vertical"&gt;
                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Ver:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                            &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxVer" IsEditable="True"
                                      ItemsSource="{Binding Vers}" Text="{Binding VerText}"/&gt;
                        &lt;/Grid&gt;

                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Lot:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                            &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxLot" IsEditable="True"
                                      ItemsSource="{Binding Lots}" Text="{Binding LotText}"/&gt;
                        &lt;/Grid&gt;

                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Slot:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                            &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxSlot" IsEditable="False"
                                      ItemsSource="{Binding Slots}" Text="{Binding SlotText}"/&gt;
                        &lt;/Grid&gt;

                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Program:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                            &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxProgram" IsEditable="True"
                                      ItemsSource="{Binding Programs}" Text="{Binding ProgramText}"/&gt;
                        &lt;/Grid&gt;

                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                                &lt;ColumnDefinition Width="auto"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Owner:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                            &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxOwner" IsEditable="True"
                                      ItemsSource="{Binding Owners}" Text="{Binding OwnerText}"/&gt;
                        &lt;/Grid&gt;
                    &lt;/StackPanel&gt;

                &lt;/Grid&gt;
                
                &lt;Grid Grid.Row="1"&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="*"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;
                    &lt;TextBlock Grid.Column="0" Width="55" Margin="8 12 8 8" Text="Remark:" TextAlignment="Right" VerticalAlignment="Top"/&gt;
                    &lt;TextBox Grid.Column="1" Margin="2 8 8 8" BorderBrush="DarkGray" BorderThickness="1"
                             AcceptsReturn="True" TextWrapping="Wrap" VerticalContentAlignment="Top"
                             Text="{Binding RemarkText}"/&gt;
                &lt;/Grid&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="1"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                    &lt;RowDefinition Height="*"/&gt;
                &lt;/Grid.RowDefinitions&gt;

                &lt;Button Grid.Row="0" Width="180" Margin="8 8 8 2" Content="Delete Selected Item" Command="{Binding DeleteListBoxItemCommand}" HorizontalAlignment="Right"/&gt;
                &lt;ListBox x:Name="ItemListBox" Grid.Row="1" Margin="8 2 8 8" ItemsSource="{Binding NewDataItems}" 
                         SelectionMode="Extended" SelectionChanged="ListBox_SelectionChanged"
                         SelectedItem="{Binding SelectedDataItem}" SelectedIndex="{Binding SelectedDataItemIndex}"
                         BorderBrush ="LightGray" BorderThickness="1"&gt;
                    &lt;ListBox.ItemTemplate&gt;
                        &lt;DataTemplate&gt;
                            &lt;TextBlock Text="{Binding DataName}" /&gt;
                        &lt;/DataTemplate&gt;
                    &lt;/ListBox.ItemTemplate&gt;
                &lt;/ListBox&gt;
            &lt;/Grid&gt;            
        &lt;/Grid&gt;
        
        &lt;StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right"&gt;
            &lt;Button Command="{Binding AddOKCommand}" Width="90" Margin="8 0 8 8" Content="OK"
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/&gt;
            &lt;Button Command="{Binding AddCancelCommand}" Width="90" Margin="8 0 8 8" Content="Cancel"
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/&gt;
        &lt;/StackPanel&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
            </code></pre>

            <p>
                AddWindow.xaml.cs
            </p>
            <pre><code class="prettyprint">
                using System.Windows;
using System.Windows.Controls;

namespace DataManager
{
    /// &lt;summary&gt;
    /// AddWindow.xaml の相互作用ロジック
    /// &lt;/summary&gt;
    public partial class AddWindow : Window
    {
        //public DataItem NewDataItem { get; private set; } = new();

        public AddWindow(AddViewModel viewModel)
        {
            InitializeComponent();
            DataContext = viewModel;
        }

        private void ListBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            if (DataContext is AddViewModel viewModel)
            {
                viewModel.SelectedDataItems.Clear();
                foreach (var item in ItemListBox.SelectedItems)
                {
                    viewModel.SelectedDataItems.Add((DataItem)item);
                }
                viewModel.DeleteListBoxItemCommand.NotifyCanExecuteChanged();
            }
        }
    }
}
            </code></pre>

            <p>
                DataItem.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;

namespace DataManager
{
    public partial class DataItem : ObservableObject
    {
        [ObservableProperty]
        private bool isSelected;

        public int No { get; set; }
        public string DataName { get; set; } = string.Empty;
        public string Link { get; set; } = string.Empty;

        [ObservableProperty]
        private string product = string.Empty;

        [ObservableProperty]
        private string type = string.Empty;

        [ObservableProperty]
        private string itemName = string.Empty;

        [ObservableProperty]
        private string ver = string.Empty;

        [ObservableProperty]
        private string lot = string.Empty;

        [ObservableProperty]
        private string slot = string.Empty;

        public string LotSlot { get; set; } = string.Empty;

        [ObservableProperty]
        private string program = string.Empty;

        [ObservableProperty]
        private string date = string.Empty;

        [ObservableProperty]
        private string owner = string.Empty;

        [ObservableProperty]
        private string remark = string.Empty;
    }
}
            </code></pre>

            <p>
                MainViewModel.cs
            </p>
            <pre><code class="prettyprint">
                //データ管理
IsDataManegementEnabled = true;
Modes = ["private", "public"];
SelectedMode = "public";
if (SelectedMode == "public") DataManegementListBoxData = LoadMajorCategory(publicSetupFile);
else DataManegementListBoxData = LoadMajorCategory(privateSetupFile);

Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
SelectedProductIndex = 0;

IsDataGridEditing = false;

//フィルタの設定
Headers = new ObservableCollection&lt;string&gt;(Vals.dataGridHeaders);
foreach (var header in Headers)
{
    ListFilters.Add(header, "");  //初期値は空のデータを格納
}
SelectedFilterHeader = Headers[0];
UpdateFilterText();
IsFiltering = false;
isHolding = false;

//// ディクショナリの変更イベントを購読
//ListFilters.CollectionChanged += (s, e) =&gt; ApplyFilter(); 
//DataItems.CollectionChanged += (s, e) =&gt; ApplyFilter();
            </code></pre>

            <p>
                MainViewModel.Manegement.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using NPOI.SS.UserModel;
using NPOI.XSSF.UserModel;
using System.Collections.ObjectModel;
using System.IO;
using System.Windows.Input;

namespace DataManager
{
    public partial class MainViewModel
    {
        #region "変数定義"
        //*** 大分類用 ***
        [ObservableProperty]
        private Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt; dataManegementListBoxData;

        [ObservableProperty]
        public ObservableCollection&lt;string&gt; modes = [];

        [ObservableProperty]
        private string selectedMode = string.Empty;
        partial void OnSelectedModeChanged(string value)    //モード切り替え時の動作
        {
            if (value == "public") DataManegementListBoxData = LoadMajorCategory(publicSetupFile);
            else DataManegementListBoxData = LoadMajorCategory(privateSetupFile);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = 0;   //Product以降の動作はOnSelectedProductChangedで記述
        }

        [ObservableProperty]
        private ObservableCollection&lt;ItemModel&gt; products = [];

        [ObservableProperty]
        private ItemModel selectedProduct = new();
        partial void OnSelectedProductChanged(ItemModel value)
        {
            RemoveProductCommand.NotifyCanExecuteChanged(); //選択状態が変わったら、CanRemoveProductを動作させる
            if (value != null && DataManegementListBoxData.ContainsKey(value))
            {
                Types = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData[value].Keys);
                SelectedType = null!;
                if (Types.Count &gt; 0) SelectedType = Types[0];    //Type以降の動作はOnSelectedTypeChangedで記述
            }
        }

        [ObservableProperty]
        private int selectedProductIndex;

        [ObservableProperty]
        private string newProductText = string.Empty;   //追加用のTextBoxにバインド

        [ObservableProperty]
        private ObservableCollection&lt;ItemModel&gt; types = [];

        [ObservableProperty]
        private ItemModel selectedType = new();
        partial void OnSelectedTypeChanged(ItemModel value)
        {
            RemoveTypeCommand.NotifyCanExecuteChanged();    //選択状態が変わったら、CanRemoveTypeを動作させる
            if (value != null && DataManegementListBoxData[SelectedProduct].ContainsKey(value)) 
            {
                ItemNames = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData[SelectedProduct][value]);
                SelectedItemName = null!;
                if (ItemNames.Count &gt; 0) SelectedItemName = ItemNames[0];  //ItemName以降の動作はOnSelectedItemNameChangedで記述
            }
        }

        [ObservableProperty]
        private int selectedTypeIndex;

        [ObservableProperty]
        private string newTypeText = string.Empty;  //追加用のTextBoxにバインド

        [ObservableProperty]
        private ObservableCollection&lt;ItemModel&gt; itemNames = [];

        [ObservableProperty]
        private ItemModel selectedItemName = new();
        partial void OnSelectedItemNameChanged(ItemModel value)
        {
            RemoveItemNameCommand.NotifyCanExecuteChanged(); //選択状態が変わったら、CanRemoveItemNameを動作させる
            if (value != null)
            {
                string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                                    + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + value.Name + ".xlsx";
                try
                {
                    Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                    LoadDataList(filePath); //DataGrid用のExcel設定ファイルを読み込む
                }
                finally
                {
                    Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
                }
            }
        }

        [ObservableProperty]
        private int selectedItemNameIndex;

        [ObservableProperty]
        private string newItemNameText = string.Empty;  //追加用のTextBoxにバインド

        //*** データリスト(フィルタリング) ***
        [ObservableProperty]
        private ObservableCollection&lt;string&gt; headers = [];  //データリスト==DataGridのヘッダー情報

        [ObservableProperty]
        private Dictionary&lt;string, string&gt; listFilters = [];  //フィルタ用のディクショナリ

        [ObservableProperty] 
        private string selectedFilterHeader = string.Empty;
        partial void OnSelectedFilterHeaderChanged(string value)
        {
            isHolding = true;
            UpdateFilterText();  //ComboBoxのHeader選択を切り替えたら、フィルタの表示(TextBox)を更新する
            isHolding = false;
        }
        private bool isHolding;

        [ObservableProperty] 
        private string filterValue = string.Empty;
        partial void OnFilterValueChanged(string value)
        {
            if (!string.IsNullOrEmpty(SelectedFilterHeader) && !isHolding) //フィルタのヘッダーの切り替え時、フィルタのクリア時(isHolding=true)は実行しない
            { 
                ListFilters[SelectedFilterHeader] = value;   //フィルタ(TextBox)の値を更新したらフィルタ用のディクショナリを更新
            }
        }

        [ObservableProperty]
        private bool isFiltering;   //フィルタの実行はコマンドで実施するため、フィルタが実行中である変数を用意。クリアが実行されるまでtrue。

        //*** データリスト ***
        [ObservableProperty]
        private ObservableCollection&lt;DataItem&gt; dataItems = [];  //DataGridのデータ

        //[ObservableProperty] 
        //private ObservableCollection&lt;DataItem&gt; tmpDataItems = [];    //DataGridのテンポラリデータ

        [ObservableProperty]
        private List&lt;string&gt; dataManegementColumnHeaders = [];  // TODO: DataGridのヘッダー。現状は有効利用できていない。

        [ObservableProperty]
        private DataItem selectedDataItem = new();  //DataGridの選択行
        partial void OnSelectedDataItemChanged(DataItem value)
        {
            UpdateDataItemInfo(value);    //選択が変わったらInfomationを更新
        }

        [ObservableProperty]
        private string dataItemInfo = string.Empty; //選択行の情報

        [ObservableProperty]
        private bool isDataManegementEnabled;   //各コマンド実行中にボタンを無効にするための変数。DataManegementのコントロールのEnabledにバインディング。

        [ObservableProperty]
        private bool isDataListAdding;  //DataGridの追加中を示す変数。

        [ObservableProperty]
        private int addDataListStatus; // DataGridの削除中のボタン状態の変数。

        [ObservableProperty]
        private bool isDataListEditing;  //DataGridの編集中を示す変数。

        [ObservableProperty]
        private int editDataListStatus; // DataGridの編集中のボタン状態の変数。

        [ObservableProperty]
        private bool isDataListRemoving;  //DataGridの削除中を示す変数。

        [ObservableProperty]
        private int removeDataListStatus; // DataGridの削除中のボタン状態の変数。

        [ObservableProperty]
        private bool isDataGridEditing;  //DataGridのセルの編集中を示す変数。
        #endregion

        #region "コマンド定義"
        /// &lt;summary&gt;
        /// Product追加コマンド(大分類のファイルに追記する and データリストのファイル新規作成)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand]
        private void AddProduct()
        {
            if (!string.IsNullOrWhiteSpace(NewProductText) && !Products.Any(item =&gt; item.Name == NewProductText))
            {
                AddProductToFile(NewProductText);
                NewProductText = string.Empty;
            }
        }

        /// &lt;summary&gt;
        /// Product削除コマンド(大分類のファイルから削除する and データリストのファイル削除)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveProduct))]
        private void RemoveProduct()
        {
            int _selectedIndex = SelectedProductIndex;
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream fs = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(fs);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            for (int i = sheet.LastRowNum; i &gt;= 0; i--)
            {
                IRow row = sheet.GetRow(i);
                if (row != null)
                {
                    ICell cell0 = row.GetCell(0); // 1列目のセルを取得
                    ICell cell1 = row.GetCell(1); // 2列目のセルを取得
                    ICell cell2 = row.GetCell(2); // 3列目のセルを取得
                    ICell cell4 = row.GetCell(4); // 5列目のセルを取得
                    if (cell0 != null && cell2 != null && cell4 != null && cell0.StringCellValue == SelectedProduct.Name && cell1.NumericCellValue != 0)
                    {
                        sheet.RemoveRow(row);   //行を削除                 
                        if (i &lt; sheet.LastRowNum) sheet.ShiftRows(i + 1, sheet.LastRowNum, -1); // 後続の行を上にシフト
                        string deleteFilePath = folderPath + "\\" + cell0.StringCellValue + "_" + cell2.StringCellValue + "_" + cell4.StringCellValue + ".xlsx";
                        if (File.Exists(deleteFilePath)) File.Delete(deleteFilePath);
                    }
                }
            }

            using (FileStream fs = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fs); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProductIndex = _selectedIndex - 1;  //削除できないデータが1つ以上あるため0以下になるケアは不要
        }
        private bool CanRemoveProduct()
        {
            return SelectedProduct != null && SelectedProduct.IsDeletable;
        }

        /// &lt;summary&gt;
        /// Type追加コマンド(大分類のファイルに追記する and データリストのファイル新規作成)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand]
        private void AddType()
        {
            if (!string.IsNullOrWhiteSpace(NewTypeText) && !Types.Any(item =&gt; item.Name == NewTypeText))
            {
                AddTypeToFile(NewTypeText);
                NewTypeText = string.Empty;
            }
        }

        /// &lt;summary&gt;
        /// Type削除コマンド(大分類のファイルから削除する and データリストのファイル削除)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveType))]
        private void RemoveType()
        {
            int _selectedProductIndex = SelectedProductIndex;
            int _selectedTypeIndex = SelectedTypeIndex;
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream fs = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(fs);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            for (int i = sheet.LastRowNum; i &gt;= 0; i--)
            {
                IRow row = sheet.GetRow(i);
                if (row != null)
                {
                    ICell cell0 = row.GetCell(0); // 1列目のセルを取得
                    ICell cell2 = row.GetCell(2); // 3列目のセルを取得
                    ICell cell3 = row.GetCell(3); // 4列目のセルを取得
                    ICell cell4 = row.GetCell(4); // 4列目のセルを取得
                    if (cell0 != null && cell2 != null && cell4 != null
                        && cell0.StringCellValue == SelectedProduct.Name && cell2.StringCellValue == SelectedType.Name && cell3.NumericCellValue != 0)
                    {
                        sheet.RemoveRow(row);   // 行を削除                   
                        if (i &lt; sheet.LastRowNum) sheet.ShiftRows(i + 1, sheet.LastRowNum, -1); // 後続の行を上にシフト
                        string deleteFilePath = folderPath + "\\" + cell0.StringCellValue + "_" + cell2.StringCellValue + "_" + cell4.StringCellValue + ".xlsx";
                        if (File.Exists(deleteFilePath)) File.Delete(deleteFilePath);
                    }
                }
            }

            using (FileStream fs = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fs); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = _selectedProductIndex;
            SelectedTypeIndex = _selectedTypeIndex - 1;   //削除できないデータが1つ以上あるため0以下になるケアは不要
        }
        private bool CanRemoveType()
        {
            return SelectedType != null && SelectedType.IsDeletable;
        }

        /// &lt;summary&gt;
        /// ItemName追加コマンド(大分類のファイルに追記する and データリストのファイル新規作成)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand]
        private void AddItemName()
        {
            if (!string.IsNullOrWhiteSpace(NewItemNameText) && !ItemNames.Any(item =&gt; item.Name == NewItemNameText))
            {
                AddItemNameToFile(NewItemNameText);
                NewItemNameText = string.Empty;
            }
        }

        /// &lt;summary&gt;
        /// ItemName削除コマンド(大分類のファイルから削除する and データリストのファイル削除)
        /// 大分類のファイルはデータ量がそれほど多くならないと思われるのでファイルを編集する方法とする
        /// &lt;/summary&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveItemName))]
        private void RemoveItemName()
        {
            int _selectedProductIndex = SelectedProductIndex;
            int _selectedTypeIndex = SelectedTypeIndex;
            int _selectedItemNameIndex = SelectedItemNameIndex;
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream fs = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(fs);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            for (int i = sheet.LastRowNum; i &gt;= 0; i--)
            {
                IRow row = sheet.GetRow(i);
                if (row != null)
                {
                    ICell cell0 = row.GetCell(0); // 1列目のセルを取得
                    ICell cell2 = row.GetCell(2); // 3列目のセルを取得
                    ICell cell4 = row.GetCell(4); // 4列目のセルを取得
                    ICell cell5 = row.GetCell(5); // 4列目のセルを取得
                    if (cell0 != null && cell2 != null && cell4 != null
                        && cell0.StringCellValue == SelectedProduct.Name && cell2.StringCellValue == SelectedType.Name && cell4.StringCellValue == SelectedItemName.Name && cell5.NumericCellValue != 0)
                    {
                        sheet.RemoveRow(row);   // 行を削除
                                                // 後続の行を上にシフト
                        if (i &lt; sheet.LastRowNum) sheet.ShiftRows(i + 1, sheet.LastRowNum, -1);
                        string deleteFilePath = folderPath + "\\" + cell0.StringCellValue + "_" + cell2.StringCellValue + "_" + cell4.StringCellValue + ".xlsx";
                        if (File.Exists(deleteFilePath)) File.Delete(deleteFilePath);
                        break;
                    }
                }
            }

            using (FileStream fs = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fs); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = _selectedProductIndex;
            SelectedType = null!;
            SelectedTypeIndex = _selectedTypeIndex;
            SelectedItemNameIndex = _selectedItemNameIndex - 1;     //削除できないデータが1つ以上あるため0以下になるケアは不要
        }
        private bool CanRemoveItemName()
        {
            return SelectedItemName != null && SelectedItemName.IsDeletable;
        }

        /// &lt;summary&gt;
        /// データリストにフィルタを実行するコマンド
        /// &lt;/summary&gt;
        [RelayCommand]
        private void ApplyFilter()
        {
            IsFiltering = true;
            foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア

            Dictionary&lt;string, string&gt; filters = [];
            foreach (var filter in ListFilters)
            {
                if (filter.Value != "") filters.Add(filter.Key, filter.Value);
            }
            if (filters.Count == 0) return; //フィルタが空の場合は終了

            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   //DataListの編集には時間がかかる可能性があるのでマウスカーソルの状態を変える
                string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                                    + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedItemName.Name + ".xlsx";
                using var fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);
                XSSFWorkbook workbook = new(fs);
                ISheet sheet = workbook.GetSheetAt(0);

                //フィルタをかけるヘッダとデータリストの列番号を紐づけ
                var headerRow = sheet.GetRow(0);
                Dictionary&lt;string, int&gt; headersColumn = [];
                foreach (var filter in filters)
                {
                    for (int j = 0; j &lt; headerRow.LastCellNum; j++)
                    {
                        if (filter.Key == headerRow.GetCell(j).ToString())
                        {
                            headersColumn.Add(filter.Key, j);
                        }
                    }
                }

                // データ行を取得
                DataItems.Clear();
                for (int i = 1; i &lt;= sheet.LastRowNum; i++)
                {
                    var row = sheet.GetRow(i);
                    if (row == null) continue;

                    int matchCnt = 0;
                    foreach (var filter in filters)
                    {
                        if (filter.Key == "No") //TODO:Noでフィルタをかけるアルゴは要検討
                        {
                            if (row.GetCell(headersColumn[filter.Key]).NumericCellValue.ToString().Contains(filter.Value)) ++matchCnt;
                        }
                        else
                        {
                            if (row.GetCell(headersColumn[filter.Key]).StringCellValue.Contains(filter.Value)) ++matchCnt;
                        }
                    }

                    if (matchCnt == filters.Count)  //フィルタ数とマッチ数が一致したdataItemをDataItemsに追加
                    {
                        var dataItem = SetDataItem(row);
                        DataItems.Add(dataItem);
                    }
                }
                workbook.Close();
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }
        }

        /// &lt;summary&gt;
        /// フィルタをクリアするコマンド
        /// &lt;/summary&gt;
        [RelayCommand]
        private void ClearFilter()
        {
            ClearFilterDictionary();
            string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                                    + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedItemName.Name + ".xlsx";
            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   //DataListの編集には時間がかかる可能性があるのでマウスカーソルの状態を変える
                LoadDataList(filePath); //DataGrid用のExcel設定ファイルを読み込む
                foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }
        }

        /// &lt;summary&gt;
        /// データリストにdataItemを追加するコマンド(別ウインドウが立ち上がる)
        /// &lt;/summary&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        [RelayCommand]
        private async Task AddDataListAsync()
        {
            IsDataListAdding = true;
            IsDataManegementEnabled = !IsDataListAdding;
            AddDataListStatus = -1;

            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            var addViewModel = new AddViewModel(folderPath, SelectedProduct, SelectedType, SelectedItemName, DataManegementListBoxData);
            var addWindow = new AddWindow(addViewModel);
            if (addWindow.ShowDialog() == true) 
            {
                string preProduct = string.Empty, preType = string.Empty, preItemName = string.Empty, tmpProduct, tmpType, tmpItemName;
                List&lt;DataItem&gt; tmpDataItems = [];
                int cnt = 0;
                foreach (var newItem in addViewModel.NewDataItems)
                {
                    tmpProduct = newItem.Product;
                    tmpType = newItem.Type;
                    tmpItemName = newItem.ItemName;
                    if(cnt &gt; 0 && !(preProduct == tmpProduct && preType == tmpType && preItemName == tmpItemName))
                    {   //大項目分類が切り替わったら、新規の大分類かチェックし、データリストを更新
                        CheckMajorCategory(preProduct, preType, preItemName);
                        await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, false);
                        tmpDataItems = [];
                    }
                    tmpDataItems.Add(newItem);
                    preProduct = tmpProduct;
                    preType = tmpType;
                    preItemName = tmpItemName;
                    cnt++;
                }
                CheckMajorCategory(preProduct, preType, preItemName);
                await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, true);
            }

            IsDataListAdding = false;
            IsDataManegementEnabled = !IsDataListAdding;
            AddDataListStatus = 0;
        }

        /// &lt;summary&gt;
        /// ドロップされたファイルをデータリストに追加するコマンド(別ウインドウが立ち上がる)
        /// &lt;/summary&gt;
        /// &lt;param name="files"&gt;ドロップされたファイル&lt;/param&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        [RelayCommand]
        private async Task AddDataDragAsync(string[] files)
        {
            IsDataManegementEnabled = false;

            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            var addViewModel = new AddViewModel(folderPath, SelectedProduct, SelectedType, SelectedItemName, DataManegementListBoxData, files);
            var addWindow = new AddWindow(addViewModel);
            if (addWindow.ShowDialog() == true)
            {
                string preProduct = string.Empty, preType = string.Empty, preItemName = string.Empty, tmpProduct, tmpType, tmpItemName;
                List&lt;DataItem&gt; tmpDataItems = [];
                int cnt = 0;
                foreach (var newItem in addViewModel.NewDataItems)
                {
                    tmpProduct = newItem.Product;
                    tmpType = newItem.Type;
                    tmpItemName = newItem.ItemName;
                    if (cnt &gt; 0 && !(preProduct == tmpProduct && preType == tmpType && preItemName == tmpItemName))
                    {
                        CheckMajorCategory(preProduct, preType, preItemName);
                        await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, false);
                        tmpDataItems = [];
                    }
                    tmpDataItems.Add(newItem);
                    preProduct = tmpProduct;
                    preType = tmpType;
                    preItemName = tmpItemName;
                    cnt++;
                }
                CheckMajorCategory(preProduct, preType, preItemName);
                await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, true);
            }

            IsDataManegementEnabled = true;
        }

        /// &lt;summary&gt;
        /// 選択アイテムの編集
        /// &lt;/summary&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        [RelayCommand(CanExecute = nameof(CanEditDataList))]
        private async Task EditDataListAsync()
        {
            IsDataListEditing = true;
            IsDataManegementEnabled = !IsDataListEditing;
            EditDataListStatus = -1;

            List&lt;DataItem&gt; selectedDataItems = [];
            foreach (var item in DataItems)
            {
                if (item.IsSelected) selectedDataItems.Add(item);
            }

            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            var addViewModel = new AddViewModel(folderPath, DataManegementListBoxData, selectedDataItems);
            var addWindow = new AddWindow(addViewModel);
            if (addWindow.ShowDialog() == true)
            {
                string preProduct = string.Empty, preType = string.Empty, preItemName = string.Empty, tmpProduct, tmpType, tmpItemName;
                List&lt;DataItem&gt; tmpDataItems = [];
                int cnt = 0;
                foreach (var newItem in addViewModel.NewDataItems)
                {
                    tmpProduct = newItem.Product;
                    tmpType = newItem.Type;
                    tmpItemName = newItem.ItemName;
                    if (cnt &gt; 0 && !(preProduct == tmpProduct && preType == tmpType && preItemName == tmpItemName))
                    {
                        CheckMajorCategory(preProduct, preType, preItemName);
                        await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, false);
                        tmpDataItems = [];
                    }
                    tmpDataItems.Add(newItem);
                    preProduct = tmpProduct;
                    preType = tmpType;
                    preItemName = tmpItemName;
                    cnt++;
                }
                CheckMajorCategory(preProduct, preType, preItemName);
                await UpdateDataList(tmpDataItems, preProduct, preType, preItemName, true);
            }

            IsDataListEditing = false;
            IsDataManegementEnabled = !IsDataListEditing;
            EditDataListStatus = 0;
        }
        private bool CanEditDataList() 
        {
            return DataItems.Any(item =&gt; item.IsSelected);
        }

        /// &lt;summary&gt;
        /// 選択行のデータをデータリストから削除
        /// &lt;/summary&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        [RelayCommand(CanExecute = nameof(CanRemoveDataList))]
        private async Task RemoveDataListAsync()
        {
            IsDataListRemoving = true;
            IsDataManegementEnabled = !IsDataListRemoving;
            RemoveDataListStatus = -1;
            var itemsToRemove = DataItems.Where(item =&gt; item.IsSelected).Select(item =&gt; item.No).ToList();
            string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                            + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedItemName.Name + ".xlsx";
            Dictionary&lt;string, List&lt;DataItem&gt;&gt; deleteItems = [];

            //データの削除では行をシフトさせる処理が重くなるケースが考えられるためいったんファイルを削除し新規作成する。
            List&lt;DataItem&gt; tmpDataItems = LoadDataItems(filePath);  //現状のファイル内容をいったん保持
            if (File.Exists(filePath)) File.Delete(filePath);       //いったん削除

            XSSFWorkbook workbook = new();  //設定ファイル新規作成
            ISheet sheet = workbook.CreateSheet("DataGrid");

            await Task.Run(() =&gt; 
            {
                // ヘッダー行を作成
                IRow headerRow = sheet.CreateRow(0);
                int i = 0;
                foreach (var header in Vals.dataGridHeaders)
                {
                    headerRow.CreateCell(i).SetCellValue(header);
                    i++;
                }

                int rowcnt = 1;
                foreach (DataItem item in tmpDataItems)
                {
                    if (!itemsToRemove.Contains(item.No))
                    {   //削除対象でない場合は設定ファイルに追記
                        IRow row = sheet.CreateRow(rowcnt);
                        SetDataItemToExcel(row, rowcnt, item);
                        rowcnt++;
                    }
                    else if (itemsToRemove.Contains(item.No))
                    {   //削除対象の場合はdeleteItemsに追加
                        var dataItem = SetDataItem(item);
                        if (!deleteItems.ContainsKey(item.ItemName)) deleteItems[item.ItemName] = [];
                        deleteItems[item.ItemName].Add(dataItem);
                    }
                }
            });

            //DataGridアップデート(★この時点ではまだデータリストのエクセルファイルは閉じてない)
            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                if (IsFiltering)
                {   //フィルタリングが有効の場合、フィルタリングをした状態にする
                    //ヘッダと紐づけ
                    Dictionary&lt;string, string&gt; filters = [];
                    foreach (var filter in ListFilters)
                    {
                        if (filter.Value != "") filters.Add(filter.Key, filter.Value);
                    }

                    var headerRow = sheet.GetRow(0);
                    Dictionary&lt;string, int&gt; headersColumn = [];
                    foreach (var filter in filters)
                    {
                        for (int j = 0; j &lt; headerRow.LastCellNum; j++)
                        {
                            if (filter.Key == headerRow.GetCell(j).ToString())
                            {
                                headersColumn.Add(filter.Key, j);
                            }
                        }
                    }

                    // データ行を取得
                    DataItems.Clear();
                    for (int i = 1; i &lt;= sheet.LastRowNum; i++)
                    {
                        var row = sheet.GetRow(i);
                        if (row == null) continue;

                        int matchCnt = 0;
                        foreach (var filter in filters)
                        {
                            if (row.GetCell(headersColumn[filter.Key]).StringCellValue.Contains(filter.Value)) ++matchCnt;
                        }

                        if (matchCnt == filters.Count)
                        {
                            var dataItem = SetDataItem(row);
                            DataItems.Add(dataItem);
                        }
                    }
                }
                else
                {   //フィルタリングが無効の場合
                    // データ行を取得
                    DataItems.Clear();
                    for (int i = 1; i &lt;= sheet.LastRowNum; i++)
                    {
                        var row = sheet.GetRow(i);
                        if (row == null) continue;
                        var dataItem = SetDataItem(row);
                        DataItems.Add(dataItem);
                    }
                }
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
                using var fs = new FileStream(filePath, FileMode.Create, FileAccess.Write); // ワークブックをファイルに保存して閉じる
                workbook.Write(fs);
                workbook.Close();
            }

            if (SelectedItemName.Name != "all")
            {   //"all"以外が選択されている場合は、allのファイルでも同じデータを削除する
                filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                            + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + "all" + ".xlsx";
                tmpDataItems = LoadDataItems(filePath);
                if (File.Exists(filePath)) File.Delete(filePath);

                workbook = new();
                sheet = workbook.CreateSheet("DataGrid");

                await Task.Run(() =&gt;
                {
                    // ヘッダー行を作成
                    IRow headerRow = sheet.CreateRow(0);
                    int i = 0;
                    foreach (var header in Vals.dataGridHeaders)
                    {
                        headerRow.CreateCell(i).SetCellValue(header);
                        i++;
                    }

                    int rowcnt = 1;
                    foreach (var item in tmpDataItems)
                    {
                        if (!MatchDataItem(item, deleteItems[SelectedItemName.Name]))
                        {
                            IRow row = sheet.CreateRow(rowcnt);
                            SetDataItemToExcel(row, rowcnt, item);
                            rowcnt++;
                        }
                    }
                });

                // ワークブックをファイルに保存
                using var fs0 = new FileStream(filePath, FileMode.Create, FileAccess.Write);
                workbook.Write(fs0);
                workbook.Close();
            }
            else 
            {   //"all"が選択されていたら、該当するItemNameのファイルのデータも削除する
                foreach (var key in deleteItems.Keys)
                {
                    filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                        + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + key + ".xlsx";
                    tmpDataItems = LoadDataItems(filePath);
                    if (File.Exists(filePath)) File.Delete(filePath);

                    workbook = new();
                    sheet = workbook.CreateSheet("DataGrid");

                    await Task.Run(() =&gt;
                    {
                        // ヘッダー行を作成
                        IRow headerRow = sheet.CreateRow(0);
                        int i = 0;
                        foreach (var header in Vals.dataGridHeaders)
                        {
                            headerRow.CreateCell(i).SetCellValue(header);
                            i++;
                        }

                        int rowcnt = 1;
                        foreach (var item in tmpDataItems)
                        {
                            if (!MatchDataItem(item, deleteItems[key]))
                            {
                                IRow row = sheet.CreateRow(rowcnt);
                                SetDataItemToExcel(row, rowcnt, item);
                                rowcnt++;
                            }
                        }
                    });

                    // ワークブックをファイルに保存
                    using var fs0 = new FileStream(filePath, FileMode.Create, FileAccess.Write);
                    workbook.Write(fs0);
                    workbook.Close();
                }
            }

            IsDataListRemoving = false;
            IsDataManegementEnabled = !IsDataListRemoving;
            RemoveDataListStatus = 0;
        }
        private bool CanRemoveDataList()
        {
            return DataItems.Any(item =&gt; item.IsSelected);
        }
        #endregion

        #region "メソッド定義"
        /// &lt;summary&gt;
        /// 大分類設定ファイルの新規作成
        /// &lt;/summary&gt;
        /// &lt;param name="_path"&gt;設定ファイルのパス&lt;/param&gt;
        private static void MakeInitialSetupFile(string _path)
        {
            XSSFWorkbook workbook = new();
            ISheet sheet = workbook.CreateSheet("setup");

            // ヘッダー行を作成
            IRow headerRow = sheet.CreateRow(0);
            headerRow.CreateCell(0).SetCellValue("Product");
            headerRow.CreateCell(1).SetCellValue("isProductDeletable");
            headerRow.CreateCell(2).SetCellValue("Type");
            headerRow.CreateCell(3).SetCellValue("isTypeDeletable");
            headerRow.CreateCell(4).SetCellValue("ItemName");
            headerRow.CreateCell(5).SetCellValue("isItemNameDeletable");

            // データ行を作成
            int d = 0;
            for (int i = 0; i &lt; Vals.initialProducts.Count; i++)
            {
                for (int j = 0; j &lt; Vals.initialTypes.Count; j++)
                {
                    for (int k = 0; k &lt; Vals.initialItemNames.Count; k++)
                    {
                        IRow row = sheet.CreateRow(++d);
                        row.CreateCell(0).SetCellValue(Vals.initialProducts[i]);
                        row.CreateCell(1).SetCellValue(0);
                        row.CreateCell(2).SetCellValue(Vals.initialTypes[j]);
                        row.CreateCell(3).SetCellValue(0);
                        row.CreateCell(4).SetCellValue(Vals.initialItemNames[k]);
                        row.CreateCell(5).SetCellValue(0);
                    }
                }
            }

            using var fs = new FileStream(_path, FileMode.Create, FileAccess.Write);    // ワークブックをファイルに保存
            workbook.Write(fs);
            workbook.Close();
        }

        /// &lt;summary&gt;
        /// 初期の大分類ファイルに対応したデータリスト設定ファイルを作成する。
        /// &lt;/summary&gt;
        /// &lt;param name="folderPath"&gt;データリストの保存フォルダ&lt;/param&gt;
        /// &lt;param name="filePath"&gt;データリストの設定ファイルパス&lt;/param&gt;
        private static void MakeInitialDataGridInfo(string folderPath, string filePath)
        {
            using FileStream fs = new(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(fs);
            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得

            for (int i = 1; i &lt;= sheet.LastRowNum; i++) // 2行目以降を処理
            {
                IRow row = sheet.GetRow(i);
                var product = row.GetCell(0).StringCellValue;
                var type = row.GetCell(2).StringCellValue;
                var itemName = row.GetCell(4).StringCellValue;
                string outFilePath = folderPath + "\\" + product + "_" + type + "_" + itemName + ".xlsx";
                MakeInitialDataGridFile(outFilePath);
            }
            workbook.Close();
        }

        /// &lt;summary&gt;
        /// 初期の設定ファイル(ヘッダー情報だけのファイル)を作成する
        /// &lt;/summary&gt;
        /// &lt;param name="_path"&gt;作成する設定ファイルのパス&lt;/param&gt;
        private static void MakeInitialDataGridFile(string _path)
        {
            XSSFWorkbook workbook = new();
            ISheet sheet = workbook.CreateSheet("DataGrid");

            // ヘッダー行を作成
            IRow headerRow = sheet.CreateRow(0);
            int i = 0;
            foreach (var header in Vals.dataGridHeaders)
            {
                headerRow.CreateCell(i).SetCellValue(header);
                i++;
            }

            // ワークブックをファイルに保存
            using var fs = new FileStream(_path, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }

        /// &lt;summary&gt;
        /// 大分類の設定ファイルを読み込む(Excelファイル)
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;ファイルパス&lt;/param&gt;
        /// &lt;returns&gt;大分類のリスト(ディクショナリ)&lt;/returns&gt;
        private static Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt; LoadMajorCategory(string filePath)
        {
            var result = new Dictionary&lt;ItemModel, Dictionary&lt;ItemModel, List&lt;ItemModel&gt;&gt;&gt;();

            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                XSSFWorkbook workbook = new(file);
                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
                for (int i = 1; i &lt;= sheet.LastRowNum; i++) // 2行目以降を処理
                {
                    IRow row = sheet.GetRow(i);
                    var product = new ItemModel { Name = row.GetCell(0).StringCellValue, IsDeletable = row.GetCell(1).NumericCellValue != 0 };
                    var type = new ItemModel { Name = row.GetCell(2).StringCellValue, IsDeletable = row.GetCell(3).NumericCellValue != 0 };
                    var itemName = new ItemModel { Name = row.GetCell(4).StringCellValue, IsDeletable = row.GetCell(5).NumericCellValue != 0 };
                    if (!result.ContainsKey(product)) result[product] = [];
                    if (!result[product].ContainsKey(type)) result[product][type] = [];
                    if (!result[product][type].Contains(itemName)) result[product][type].Add(itemName);
                }
                workbook.Close();
            }
            return result;
        }

        /// &lt;summary&gt;
        /// Filterの表示テキストを更新する
        /// &lt;/summary&gt;
        private void UpdateFilterText()
        {
            FilterValue = ListFilters[SelectedFilterHeader];
        }

        /// &lt;summary&gt;
        /// 選択されたDataItemの情報を表示
        /// &lt;/summary&gt;
        /// &lt;param name="value"&gt;DataGridで選択されたDataItem&lt;/param&gt;
        private void UpdateDataItemInfo(DataItem value)
        {
            if (value != null)
            {
                DataItemInfo = "DataName:" + value.DataName + "\n"
                                    + "Remark:" + value.Remark + "\n"
                                    + "Product:" + value.Product + " Type:" + value.Type + " ItemName:" + value.ItemName + "\n"
                                    + "Ver:" + value.Ver + ", LotSlot:" + value.LotSlot + "\n"
                                    + "Program:" + value.Program + "\n"
                                    + "Date:" + value.Date + " Owner:" + value.Owner;
            }
            else DataItemInfo = string.Empty;
        }

        /// &lt;summary&gt;
        /// Productを追加するメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="value"&gt;newProductのテキスト&lt;/param&gt;
        private void AddProductToFile(string value)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            for (int j = 0; j &lt; Vals.initialTypes.Count; j++)
            {
                for (int k = 0; k &lt; Vals.initialItemNames.Count; k++)
                {
                    IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
                    row.CreateCell(0).SetCellValue(value);
                    row.CreateCell(1).SetCellValue(1);  //追加のproductは編集可能に
                    row.CreateCell(2).SetCellValue(Vals.initialTypes[j]);
                    row.CreateCell(3).SetCellValue(0);
                    row.CreateCell(4).SetCellValue(Vals.initialItemNames[k]);
                    row.CreateCell(5).SetCellValue(0);
                    string outFilePath = folderPath + "\\" + value + "_" + Vals.initialTypes[j] + "_" + Vals.initialItemNames[k] + ".xlsx";
                    MakeInitialDataGridFile(outFilePath);
                }
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            var newProduct = new ItemModel { Name = value, IsDeletable = true };
            SelectedProduct = newProduct;
        }

        /// &lt;summary&gt;
        /// Typeを追加するメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="value"&gt;newTypeのテキスト&lt;/param&gt;
        private void AddTypeToFile(string value)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedIndex = SelectedProductIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            for (int k = 0; k &lt; Vals.initialItemNames.Count; k++)
            {
                IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
                row.CreateCell(0).SetCellValue(SelectedProduct.Name);
                row.CreateCell(1).SetCellValue(SelectedProduct.IsDeletable ? 1 : 0);
                row.CreateCell(2).SetCellValue(value);
                row.CreateCell(3).SetCellValue(1);  //追加のTypeは編集可能に
                row.CreateCell(4).SetCellValue(Vals.initialItemNames[k]);
                row.CreateCell(5).SetCellValue(0);

                string outFilePath = folderPath + "\\" + SelectedProduct.Name + "_" + value + "_" + Vals.initialItemNames[k] + ".xlsx";
                MakeInitialDataGridFile(outFilePath);
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = _selectedIndex;
            var newType = new ItemModel { Name = value, IsDeletable = true };
            SelectedType = newType;
        }

        /// &lt;summary&gt;
        /// ItemNameを追加するメソッド
        /// &lt;/summary&gt;
        /// &lt;param name="value"&gt;newItemNameのテキスト&lt;/param&gt;
        private void AddItemNameToFile(string value)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedProductIndex = SelectedProductIndex;
            int _selectedTypeIndex = SelectedTypeIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
            row.CreateCell(0).SetCellValue(SelectedProduct.Name);
            row.CreateCell(1).SetCellValue(SelectedProduct.IsDeletable ? 1 : 0);
            row.CreateCell(2).SetCellValue(SelectedType.Name);
            row.CreateCell(3).SetCellValue(SelectedType.IsDeletable ? 1 : 0);
            row.CreateCell(4).SetCellValue(value);
            row.CreateCell(5).SetCellValue(1);  //追加のTypeは編集可能に

            string outFilePath = folderPath + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + value + ".xlsx";
            MakeInitialDataGridFile(outFilePath);

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = LoadMajorCategory(filePath);
            Products = new ObservableCollection&lt;ItemModel&gt;(DataManegementListBoxData.Keys);
            //SelectedProduct = null!;
            SelectedProductIndex = -1;
            SelectedProductIndex = _selectedProductIndex;
            //SelectedType = null!;
            SelectedTypeIndex = -1;
            SelectedTypeIndex = _selectedTypeIndex;
            var newItemName = new ItemModel { Name = value, IsDeletable = true };
            SelectedItemName = newItemName;
        }

        /// &lt;summary&gt;
        /// dataItemを設定する(エクセル行入力版)
        /// &lt;/summary&gt;
        /// &lt;param name="row"&gt;エクセルの行データ&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private static DataItem SetDataItem(IRow row)
        {
            int col = 0;
            return new DataItem
            {
                No = (int)row.GetCell(col).NumericCellValue,
                DataName = row.GetCell(++col).StringCellValue,
                Link = row.GetCell(++col).StringCellValue,
                Product = row.GetCell(++col).StringCellValue,
                Type = row.GetCell(++col).StringCellValue,
                ItemName = row.GetCell(++col).StringCellValue,
                Ver = row.GetCell(++col).StringCellValue,
                Lot = row.GetCell(++col).StringCellValue,
                Slot = row.GetCell(++col).StringCellValue,
                LotSlot = row.GetCell(++col).StringCellValue,
                Program = row.GetCell(++col).StringCellValue,
                Date = row.GetCell(++col).StringCellValue,
                Owner = row.GetCell(++col).StringCellValue,
                Remark = row.GetCell(++col).StringCellValue
            };
        }

        /// &lt;summary&gt;
        /// dataItemを設定する(DataItem入力版)
        /// &lt;/summary&gt;
        /// &lt;param name="item"&gt;DataItem&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private static DataItem SetDataItem(DataItem item)
        {
            return new DataItem
            {
                No = item.No,
                DataName = item.DataName,
                Link = item.Link,
                Product = item.Product,
                Type = item.Type,
                ItemName = item.ItemName,
                Ver = item.Ver,
                Lot = item.Lot,
                Slot = item.Slot,
                LotSlot = item.LotSlot,
                Program = item.Program,
                Date = item.Date,
                Owner = item.Owner,
                Remark = item.Remark
            };
        }

        /// &lt;summary&gt;
        /// フィルタの情報をクリア
        /// &lt;/summary&gt;
        private void ClearFilterDictionary()
        {
            IsFiltering = false;    //フィルタリング状態の変数をオフにする
            isHolding = true;       //FilterValueの変更メソッドが走らないようにする変数
            foreach (var headerFilter in ListFilters)
            {
                ListFilters[headerFilter.Key] = "";
            }
            FilterValue = string.Empty;
            isHolding = false;
        }

        /// &lt;summary&gt;
        /// データリストをロードする(DataItems==DataGridの更新)
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;データリストの設定ファイルのパス&lt;/param&gt;
        private void LoadDataList(string filePath)
        {
            IsFiltering = false;    //データをロードし直した場合、フィルタリングをオフする
            using var fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(fs);
            ISheet sheet = workbook.GetSheetAt(0);

            // データ行を取得
            DataItems.Clear();
            for (int i = 1; i &lt;= sheet.LastRowNum; i++)
            {
                var row = sheet.GetRow(i);
                if (row == null) continue;
                var dataItem = SetDataItem(row);
                DataItems.Add(dataItem);
            }
            workbook.Close();
        }

        /// &lt;summary&gt;
        /// 大分類をチェックし、新規であれば追加
        /// &lt;/summary&gt;
        /// &lt;param name="_product"&gt;品種名&lt;/param&gt;
        /// &lt;param name="_type"&gt;種類&lt;/param&gt;
        /// &lt;param name="_itemName"&gt;項目名&lt;/param&gt;
        private void CheckMajorCategory(string _product, string _type, string _itemName)
        {
            //SelectedProduct = null!;
            if (!Products.Any(item =&gt; item.Name == _product)) AddProductToFile(_product);
            SelectedProduct = Products.FirstOrDefault(item =&gt; item.Name == _product) ?? null!;      //処理的にnullにならないはず。警告対策。
            //SelectedType = null!;
            if (!Types.Any(item =&gt; item.Name == _type)) AddTypeToFile(_type);
            SelectedType = Types.FirstOrDefault(item =&gt; item.Name == _type) ?? null!;               //処理的にnullにならないはず。警告対策。
            //SelectedItemName = null!;
            if (!ItemNames.Any(item =&gt; item.Name == _itemName)) AddItemNameToFile(_itemName);
            SelectedItemName = ItemNames.FirstOrDefault(item =&gt; item.Name == _itemName) ?? null!;   //処理的にnullにならないはず。警告対策。
        }

        /// &lt;summary&gt;
        /// データリストの設定ファイルを更新する
        /// &lt;/summary&gt;
        /// &lt;param name="newDataItems"&gt;追加するdataItemのリスト&lt;/param&gt;
        /// &lt;param name="_product"&gt;品種名&lt;/param&gt;
        /// &lt;param name="_type"&gt;種類&lt;/param&gt;
        /// &lt;param name="_itemName"&gt;項目名&lt;/param&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        private async Task UpdateDataList(List&lt;DataItem&gt; newDataItems, string _product, string _type, string _itemName, bool isLastItem)
        {
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            string filePath;
            if (SelectedItemName.Name == "all") filePath = folderPath + "\\" + _product + "_" + _type + "_" + "-" + ".xlsx";
            else filePath = folderPath + "\\" + _product + "_" + _type + "_" + _itemName + ".xlsx";

            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                await WriteDataList(filePath, newDataItems);
                //DataItems.Clear();
                if (SelectedItemName.Name != "all" && isLastItem) LoadDataList(filePath); //DataGrid更新
                filePath = folderPath + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + "all" + ".xlsx";
                await WriteDataList(filePath, newDataItems);
                if (SelectedItemName.Name == "all" && isLastItem) LoadDataList(filePath); //DataGrid更新
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }
        }

        /// &lt;summary&gt;
        /// データリストの設定ファイルに書き込み
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;設定ファイルのパス&lt;/param&gt;
        /// &lt;param name="newDataItems"&gt;追加するdataItemのリスト&lt;/param&gt;
        /// &lt;returns&gt;タスク&lt;/returns&gt;
        private static async Task WriteDataList(string filePath, List&lt;DataItem&gt; newDataItems)
        {
            await Task.Run(() =&gt;
            {
                XSSFWorkbook workbook;
                using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(file);
                }
                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得

                int j = sheet.LastRowNum;
                foreach (var item in newDataItems)
                {
                    IRow row = sheet.CreateRow(++j);
                    IRow prerow = sheet.GetRow(j - 1);
                    int k = 0;
                    if (j &gt; 1) row.CreateCell(k).SetCellValue((int)prerow.GetCell(0).NumericCellValue + 1);
                    else row.CreateCell(k).SetCellValue(1);
                    row.CreateCell(++k).SetCellValue(item.DataName);
                    row.CreateCell(++k).SetCellValue(item.Link);
                    row.CreateCell(++k).SetCellValue(item.Product);
                    row.CreateCell(++k).SetCellValue(item.Type);
                    row.CreateCell(++k).SetCellValue(item.ItemName != "all" ? item.ItemName : "-");
                    row.CreateCell(++k).SetCellValue(item.Ver);
                    row.CreateCell(++k).SetCellValue(item.Lot);
                    row.CreateCell(++k).SetCellValue(item.Slot);
                    row.CreateCell(++k).SetCellValue(item.LotSlot);
                    row.CreateCell(++k).SetCellValue(item.Program);
                    row.CreateCell(++k).SetCellValue(item.Date);
                    row.CreateCell(++k).SetCellValue(item.Owner);
                    row.CreateCell(++k).SetCellValue(item.Remark);
                }

                using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
                {
                    workbook.Write(fileOut); // ファイルに書き込み
                }
                workbook.Close();
            });
        }

        /// &lt;summary&gt;
        /// 設定ファイルの内容を読み込む
        /// &lt;/summary&gt;
        /// &lt;param name="filePath"&gt;設定ファイルのパス&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private static List&lt;DataItem&gt; LoadDataItems(string filePath)
        {
            using var fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(fs);
            ISheet sheet = workbook.GetSheetAt(0);

            // データ行を取得
            List&lt;DataItem&gt; Items = [];
            for (int i = 1; i &lt;= sheet.LastRowNum; i++)
            {
                var row = sheet.GetRow(i);
                if (row == null) continue;
                var dataItem = SetDataItem(row);
                Items.Add(dataItem);
            }
            workbook.Close();
            return Items;
        }

        /// &lt;summary&gt;
        /// エクセルファイルにDataItemのデータを書き込む
        /// &lt;/summary&gt;
        /// &lt;param name="row"&gt;エクセルの行データ&lt;/param&gt;
        /// &lt;param name="rowcnt"&gt;行番号&lt;/param&gt;
        /// &lt;param name="item"&gt;設定するDataItem&lt;/param&gt;
        private static void SetDataItemToExcel(IRow row, int rowcnt, DataItem item)
        {
            int col = 0;
            row.CreateCell(col).SetCellValue(rowcnt);
            row.CreateCell(++col).SetCellValue(item.DataName);
            row.CreateCell(++col).SetCellValue(item.Link);
            row.CreateCell(++col).SetCellValue(item.Product);
            row.CreateCell(++col).SetCellValue(item.Type);
            row.CreateCell(++col).SetCellValue(item.Ver);
            row.CreateCell(++col).SetCellValue(item.ItemName);
            row.CreateCell(++col).SetCellValue(item.Lot);
            row.CreateCell(++col).SetCellValue(item.Slot);
            row.CreateCell(++col).SetCellValue(item.LotSlot);
            row.CreateCell(++col).SetCellValue(item.Program);
            row.CreateCell(++col).SetCellValue(item.Date);
            row.CreateCell(++col).SetCellValue(item.Owner);
            row.CreateCell(++col).SetCellValue(item.Remark);
        }

        /// &lt;summary&gt;
        /// データアイテムが同じものかチェックする
        /// &lt;/summary&gt;
        /// &lt;param name="item"&gt;DataItem&lt;/param&gt;
        /// &lt;param name="deleteItems"&gt;削除対象のDataItemのリスト&lt;/param&gt;
        /// &lt;returns&gt;データアイテムが同じものであればtrueを返す&lt;/returns&gt;
        private static bool MatchDataItem(DataItem item, List&lt;DataItem&gt; deleteItems)
        {
            bool isMatch = false;

            foreach (DataItem deleteItem in deleteItems)
            {
                if (item.DataName == deleteItem.DataName && item.Link == deleteItem.Link && item.ItemName == deleteItem.ItemName)
                {
                    isMatch = true;
                    break;
                }
            }
            return isMatch;
        }
        #endregion
    }
}
            </code></pre>

            <p>
                ManegementTab.xaml
            </p>
            <pre><code class="prettyprint">
                &lt;UserControl x:Class="DataManager.ManegementTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" 
             xmlns:local="clr-namespace:DataManager"
             mc:Ignorable="d" &gt;
    &lt;Grid&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="*"/&gt;
        &lt;/Grid.RowDefinitions&gt;

        &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
            &lt;TextBlock HorizontalAlignment="Center" Text="データ管理" FontSize="16" TextWrapping="Wrap"/&gt;
        &lt;/materialDesign:Card&gt;

        &lt;Grid Grid.Row="1"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="*"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;

            &lt;Grid Grid.Column="0"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                    &lt;RowDefinition Height="*"/&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                &lt;/Grid.RowDefinitions&gt;

                &lt;ListBox x:Name="RadioButtonGroupChoiceChipPrimaryOutline"
                     Style="{StaticResource MaterialDesignChoiceChipPrimaryOutlineListBox}"
                     ItemsSource="{Binding Modes}" SelectedItem="{Binding SelectedMode}"
                     Margin="4 4 4 4" IsEnabled="{Binding IsDataManegementEnabled}"&gt;
                    &lt;ListBox.ItemTemplate&gt;
                        &lt;DataTemplate&gt;
                            &lt;TextBlock Text="{Binding}" /&gt;
                        &lt;/DataTemplate&gt;
                    &lt;/ListBox.ItemTemplate&gt;
                &lt;/ListBox&gt;

                &lt;Grid Grid.Row="1"&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;

                    &lt;Grid Grid.Column="0"&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;TextBlock Text="品種名" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                            &lt;Button Content="追加" Command="{Binding AddProductCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 4 2 4" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;TextBox Height="29"  Margin="6 2 6 2" Text="{Binding NewProductText, UpdateSourceTrigger=PropertyChanged}"
                                 Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="ProductTextBox_KeyDown"
                                 IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/StackPanel&gt;

                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                             BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                             ItemsSource="{Binding Products}" SelectedItem="{Binding SelectedProduct}" 
                             SelectedIndex="{Binding SelectedProductIndex}" Style="{StaticResource MaterialDesignListBox}"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                            &lt;ListBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ListBox.ItemTemplate&gt;
                        &lt;/ListBox&gt;

                        &lt;Button Grid.Row="3" Content="削除" Command="{Binding RemoveProductCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                    &lt;/Grid&gt;

                    &lt;Grid Grid.Column="1"&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;TextBlock Text="種類" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                            &lt;Button Content="追加" Command="{Binding AddTypeCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 4 2 4" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;TextBox Height="29" Margin="6 2 6 2" Text="{Binding NewTypeText, UpdateSourceTrigger=PropertyChanged}"
                                 Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="TypeTextBox_KeyDown"
                                 IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/StackPanel&gt;

                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                             BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                             ItemsSource="{Binding Types}" SelectedItem="{Binding SelectedType}" 
                             SelectedIndex="{Binding SelectedTypeIndex}" Style="{StaticResource MaterialDesignListBox}"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                            &lt;ListBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ListBox.ItemTemplate&gt;
                        &lt;/ListBox&gt;

                        &lt;Button Grid.Row="3" Content="削除" Command="{Binding RemoveTypeCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                    &lt;/Grid&gt;

                    &lt;Grid Grid.Column="2"&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;TextBlock Text="項目名" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                            &lt;Button Content="追加" Command="{Binding AddItemNameCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 4 2 4" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;TextBox Height="29" Margin="6 2 6 2" Text="{Binding NewItemNameText, UpdateSourceTrigger=PropertyChanged}"
                                 Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="ItemNameTextBox_KeyDown"
                                 IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/StackPanel&gt;

                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                             BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                             ItemsSource="{Binding ItemNames}" SelectedItem="{Binding SelectedItemName}" 
                             SelectedIndex="{Binding SelectedItemNameIndex}" Style="{StaticResource MaterialDesignListBox}" ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                            &lt;ListBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ListBox.ItemTemplate&gt;
                        &lt;/ListBox&gt;

                        &lt;Button Grid.Row="3" Content="削除" Command="{Binding RemoveItemNameCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="2 2 2 8" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                    &lt;/Grid&gt;
                &lt;/Grid&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="1"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                    &lt;RowDefinition Height="*"/&gt;
                &lt;/Grid.RowDefinitions&gt;

                &lt;StackPanel Orientation="Horizontal"&gt;
                    &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                        &lt;TextBlock Text="データリスト" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" VerticalAlignment="Top"/&gt;
                        &lt;Button Content="データ追加" Command="{Binding AddDataListCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="6 4 2 2" Padding="0" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;Button Content="データ編集" Command="{Binding EditDataListCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="6 2 2 4" Padding="0" IsEnabled="{Binding IsDataManegementEnabled}" 
                            materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsDataListEditing}"
                            materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsDataListEditing}"
                            materialDesign:ButtonProgressAssist.Value="{Binding EditDataListStatus}"/&gt;
                        &lt;Button Content="データ削除" Command="{Binding RemoveDataListCommand}" HorizontalAlignment="Center" 
                            Width="90" Margin="6 2 2 4" Padding="0" IsEnabled="{Binding IsDataManegementEnabled}" 
                            materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsDataListRemoving}"
                            materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsDataListRemoving}"
                            materialDesign:ButtonProgressAssist.Value="{Binding RemoveDataListStatus}"/&gt;
                    &lt;/StackPanel&gt;

                    &lt;GroupBox Height="136" Width="300" Margin="4 8 4 4" Padding="0"
                          Header="データの情報" IsEnabled="{Binding IsDataManegementEnabled}"
                          materialDesign:GroupBoxAssist.HeaderPadding="4"
                          Style="{StaticResource MaterialDesignGroupBox}"&gt;
                        &lt;ScrollViewer Padding="4" materialDesign:ScrollViewerAssist.PaddingMode="Content"&gt;
                            &lt;StackPanel&gt;
                                &lt;TextBlock Margin="4" TextWrapping="Wrap" Text="{Binding DataItemInfo}" /&gt;
                            &lt;/StackPanel&gt;
                        &lt;/ScrollViewer&gt;
                    &lt;/GroupBox&gt;

                    &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="*"/&gt;
                                &lt;ColumnDefinition Width="*"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;Button Grid.Column="0" Margin="6 0 0 0" Padding="4 0 4 0"
                                HorizontalAlignment="Left" VerticalAlignment="Bottom"
                                Command="{Binding ApplyFilterCommand}" Content="Filtering"
                                Style="{StaticResource MaterialDesignFlatButton}" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;Button Grid.Column="1" Margin="0 0 8 0" Padding="4 0 4 0"
                                HorizontalAlignment="Right" VerticalAlignment="Bottom"
                                Command="{Binding ClearFilterCommand}" Content="Clear"
                                Style="{StaticResource MaterialDesignFlatButton}" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/Grid&gt;

                        &lt;ComboBox Margin="4 4 4 4" Width="150" Height="40"
                              materialDesign:HintAssist.Hint="Headers" IsEnabled="{Binding IsDataManegementEnabled}"
                              Style="{StaticResource MaterialDesignFilledComboBox}"
                              ItemsSource="{Binding Headers}" SelectedItem="{Binding SelectedFilterHeader}"&gt;
                            &lt;ComboBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding}" /&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ComboBox.ItemTemplate&gt;
                        &lt;/ComboBox&gt;
                        &lt;TextBox Margin="4 4 4 4" Width="150" Height="40" VerticalAlignment="Top"
                             Padding="8 -8 0 -8" IsEnabled="{Binding IsDataManegementEnabled}"
                             materialDesign:HintAssist.Hint="Filter" KeyDown="FilterTextBox_KeyDown"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Text="{Binding FilterValue, UpdateSourceTrigger=PropertyChanged}"/&gt;
                    &lt;/StackPanel&gt;
                &lt;/StackPanel&gt;

                &lt;Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" Margin="4 1 4 4"&gt;
                    &lt;DataGrid VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.VirtualizationMode="Recycling" 
                          EnableRowVirtualization="True" EnableColumnVirtualization="True"
                          CanUserAddRows="False" AutoGenerateColumns="False" IsEnabled="{Binding IsDataManegementEnabled}"
                          ItemsSource="{Binding DataItems, Mode=TwoWay}" SelectionMode="Extended"
                          SelectedItem="{Binding SelectedDataItem}" SelectionChanged="DataItem_SelectionChanged"
                          AllowDrop="True" Drop="DataGrid_Drop" CellEditEnding="DataGrid_CellEditEnding"&gt;
                        &lt;DataGrid.RowStyle&gt;
                            &lt;Style TargetType="{x:Type DataGridRow}" BasedOn="{StaticResource {x:Type DataGridRow}}"&gt;
                                &lt;Setter Property="IsSelected" Value="{Binding IsSelected,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/&gt;
                            &lt;/Style&gt;
                        &lt;/DataGrid.RowStyle&gt;
                        &lt;DataGrid.Columns&gt;
                            &lt;!--*** No ***--&gt;
                            &lt;DataGridTextColumn Header="No" Binding="{Binding No}" IsReadOnly="True"/&gt;
                            &lt;!--*** DataName ***--&gt;
                            &lt;DataGridTextColumn Header="DataName" Binding="{Binding DataName}" IsReadOnly="True"/&gt;
                            &lt;!--*** Link ***--&gt;
                            &lt;DataGridTemplateColumn Header="Link" IsReadOnly="True" Width="100"&gt;
                                &lt;DataGridTemplateColumn.CellTemplate&gt;
                                    &lt;DataTemplate&gt;
                                        &lt;TextBlock&gt; 
                                        &lt;Hyperlink NavigateUri="{Binding Link}" RequestNavigate="Hyperlink_RequestNavigate"&gt; 
                                            &lt;TextBlock Text="{Binding Link}"/&gt; 
                                        &lt;/Hyperlink&gt; 
                                    &lt;/TextBlock&gt;
                                    &lt;/DataTemplate&gt;
                                &lt;/DataGridTemplateColumn.CellTemplate&gt;
                            &lt;/DataGridTemplateColumn&gt;
                            &lt;!--*** Product ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Product" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Product"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Type ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Type" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Type"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** ItemName ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="ItemName" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="ItemName"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Ver ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Ver" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Ver"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Lot ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Lot" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Lot"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Slot ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Slot" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Slot"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** LotSlot ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="LotSlot" IsReadOnly="True" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="LotSlot"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Program ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Program" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Program"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Date ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Date" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Date"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Owner ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Owner" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Owner"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Remark ***--&gt;
                            &lt;materialDesign:DataGridTextColumn Header="Remark" EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" &gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Remark"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                        &lt;/DataGrid.Columns&gt;
                    &lt;/DataGrid&gt;
                &lt;/Border&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="2"&gt;
                &lt;Expander ExpandDirection="Right" IsEnabled="{Binding IsDataManegementEnabled}"&gt;
                    &lt;Expander.Header&gt;
                        &lt;TextBlock RenderTransformOrigin=".5,.5" Text="データ選択"&gt;
                            &lt;TextBlock.LayoutTransform&gt;
                                &lt;RotateTransform Angle="-90" /&gt;
                            &lt;/TextBlock.LayoutTransform&gt;
                        &lt;/TextBlock&gt;
                    &lt;/Expander.Header&gt;
                    &lt;StackPanel Margin="8,8,8,8" Orientation="Vertical" TextBlock.Foreground="{DynamicResource MaterialDesignBody}"&gt;
                        &lt;TextBlock Text="準備中" /&gt;
                    &lt;/StackPanel&gt;
                &lt;/Expander&gt;
            &lt;/Grid&gt;
        &lt;/Grid&gt;
    &lt;/Grid&gt;
&lt;/UserControl&gt;
            </code></pre>

            <p>
                ManegementTab.xaml.cs
            </p>
            <pre><code class="prettyprint">
                using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Navigation;
using DataFormats = System.Windows.DataFormats;
using DragEventArgs = System.Windows.DragEventArgs;
using KeyEventArgs = System.Windows.Input.KeyEventArgs;

namespace DataManager
{
    /// &lt;summary&gt;
    /// ManegementTab.xaml の相互作用ロジック
    /// &lt;/summary&gt;
    public partial class ManegementTab : System.Windows.Controls.UserControl
    {
        public ManegementTab()
        {
            InitializeComponent();
        }

        //データ管理
        private void ProductTextBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                if (DataContext is MainViewModel viewModel && viewModel.AddProductCommand.CanExecute(null))
                {
                    viewModel.AddProductCommand.Execute(null);
                }
            }
        }

        private void TypeTextBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                if (DataContext is MainViewModel viewModel && viewModel.AddTypeCommand.CanExecute(null))
                {
                    viewModel.AddTypeCommand.Execute(null);
                }
            }
        }

        private void ItemNameTextBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                if (DataContext is MainViewModel viewModel && viewModel.AddItemNameCommand.CanExecute(null))
                {
                    viewModel.AddItemNameCommand.Execute(null);
                }
            }
        }

        //private void Hyperlink_Click(object sender, RoutedEventArgs e)
        //{
        //    if (sender is Hyperlink hyperlink)
        //    {
        //        var url = hyperlink.NavigateUri.ToString();
        //        System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo
        //        {
        //            FileName = url,
        //            UseShellExecute = true
        //        });
        //    }
        //}

        //private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)
        //{
        //    System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(e.Uri.AbsoluteUri) { UseShellExecute = true });
        //    e.Handled = true;
        //}

        //private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e) 
        //{ 
        //    var encodedUrl = HttpUtility.UrlEncode(e.Uri.AbsoluteUri); 
        //    System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(encodedUrl) { UseShellExecute = true }); 
        //    e.Handled = true; 
        //}

        private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)
        {
            System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(e.Uri.ToString()) { UseShellExecute = true });
            e.Handled = true;
        }

        //private void MainWindow_DataContextChanged(object sender, DependencyPropertyChangedEventArgs e)
        //{
        //    if (DataContext is MainViewModel viewModel)
        //    {
        //        viewModel.LoadDataCommand.Execute(null);

        //        foreach (var header in viewModel.DynamicColumnHeaders)
        //        {
        //            dataGrid.Columns.Add(new DataGridTextColumn
        //            {
        //                Header = header,
        //                Binding = new System.Windows.Data.Binding($"VariableColumns[{viewModel.DynamicColumnHeaders.IndexOf(header)}]")
        //            });
        //        }
        //    }
        //}

        private void DataItem_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            if (DataContext is MainViewModel viewModel && sender is System.Windows.Controls.DataGrid dataGrid)
            {
                foreach (DataItem item in dataGrid.Items)
                {
                    item.IsSelected = dataGrid.SelectedItems.Contains(item);
                }

                // コマンドの有効状態を更新
                viewModel.RemoveDataListCommand.NotifyCanExecuteChanged();
                viewModel.EditDataListCommand.NotifyCanExecuteChanged();
            }
        }

        private void DataGrid_Drop(object sender, DragEventArgs e)
        {
            if (e.Data.GetDataPresent(DataFormats.FileDrop))
            {
                string[] files = (string[])e.Data.GetData(DataFormats.FileDrop);

                if (DataContext is MainViewModel viewModel)
                {
                    viewModel.AddDataDragCommand.Execute(files);
                }
            }
        }

        private void DataGrid_CellEditEnding(object sender, DataGridCellEditEndingEventArgs e)
        {
            if (DataContext is MainViewModel viewModel && sender is System.Windows.Controls.DataGrid dataGrid)
            {
                if (dataGrid.SelectedItems.Count == 1)
                {
                    System.Windows.MessageBox.Show("Item = 1");
                }
                else
                {
                    System.Windows.MessageBox.Show("Item &gt; 1");
                }
            }
        }

        private void FilterTextBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                if (DataContext is MainViewModel viewModel)
                {
                    viewModel.ApplyFilterCommand.Execute(null);
                }
            }
        }
    }
}
            </code></pre>

            <p>
                Vals.cs
            </p>
            <pre><code class="prettyprint">
                namespace DataManager
{
    public static class Vals
    {
        public static readonly List&lt;string&gt; initialProducts = ["-"];
        public static readonly List&lt;string&gt; initialTypes = ["-", "test1", "test2", "test3", "test4", "test5", "test6", "test7"];
        public static readonly List&lt;string&gt; initialItemNames = ["all", "-"];
        public static readonly List&lt;string&gt; dataGridHeaders = ["No", "DataName", "Link", "Product", "Type", "ItemName", "Ver", "Lot", "Slot", "LotSlot", "Pro", "Date", "Owner", "Remark"];
        public const int BATCH_SIZE = 50;
        public const int BATCH_DELAY = 10;
    }
}
            </code></pre>
        </article>
    </div>

    <footer>
        <div class="wrapper">
            <p><small>&copy; 2022 大人の学び舎</small></p>
        </div>
    </footer>
</body>

</html>