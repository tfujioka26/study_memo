<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="python勉強中です。。">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>大人の学び舎 - python-study</title>

    <!-- CSS -->
    <link href="https://unpkg.com/ress/dist/ress.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <!-- <link href="vibrant-ink.css" rel="stylesheet"> -->
    <link href="prettify.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c" rel="stylesheet">
    <link rel="icon" type="image/png" href="favicon.png">

    <!-- javascript -->
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
</head>

<body>
    <div id="study" class="big-bg">
        <header class="page-header wrapper">
            <h1>
                <a href="index.html"><img class="logo" src="logo.png" alt="大人の学び舎ホーム"></a>
            </h1>
            <nav>
                <ul class="main-nav">
                    <li><a href="python_study_vol0.html">python</a></li>
                    <li><a href="csharp_study_vol0.html">C#</a></li>
                    <li><a href="excelvba_study_vol0.html">ExcelVBA</a></li>
                    <li><a href="statistics_study_vol0.html">統計</a></li>
                </ul>
            </nav>
        </header>

        <div class="wrapper">
            <h2 class="page-title">c#-study</h2>
        </div>
    </div>

    <div class="study-contents wrapper">
        <aside>
            <h3 class="sub-title">カテゴリー</h3>
            <ul class="sub-menu">
                <li><a href="python_study_vol0.html">基本操作</a></li>
                <li><a href="python_study_vol1.html">画像関連</a></li>
                <li><a href="python_study_vol2.html">********</a></li>
                <li><a href="python_study_vol3.html">********</a></li>
            </ul>

            <h3 class="sub-title-2nd">基本操作</h3>
            <ul class="sub-menu">
                <li><a href="#python-base-v0">ディレクトリ内のファイルをリストアップ</a></li>
                <li><a href="#">********</a></li>
                <li><a href="#">********</a></li>
                <li><a href="#">********</a></li>
            </ul>
        </aside>

        <article id="python-base-v0">
            <header class="post-info">
                <h2 class="post-title">ディレクトリ内のファイルをリストアップ</h2>
                <p class="post-date">1/3 <span>2022</span></p>
                <p class="post-cat">カテゴリー：example</p>
            </header>

            <p>
                AddViewModel.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using NPOI.SS.UserModel;
using NPOI.XSSF.UserModel;
using System.Collections.ObjectModel;
using System.IO;
using System.Windows;

namespace DataManager
{
    public partial class AddViewModel : ObservableObject
    {
        [ObservableProperty]
        private string selectedAddPath = string.Empty;

        [ObservableProperty]
        private bool isAddFolder;

        [ObservableProperty]
        private bool isAddSubFolder;

        [ObservableProperty]
        private List<string> _products, _types, _vers, _links = [], _lots = [], _programs = [];

        [ObservableProperty]
        private List<string> _slots = ["-", "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", 
                                        "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25"];

        [ObservableProperty]
        private string productText = string.Empty;
        partial void OnProductTextChanged(string value)
        {
            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            foreach (var item in NewDataItems) item.Product = tmpValue;
            var _product = _dataListBoxItems.Keys.FirstOrDefault(item => item.Name == tmpValue);
            if (_product != null) Types = _dataListBoxItems[_product].Keys.Select(item => item.Name).ToList();
            else Types = Vals.initialTypes;
            Vers = Vals.initialVers;

            string filePath = _folderPath + "\\" + tmpValue + "_" + (!string.IsNullOrEmpty(TypeText) ? TypeText : "-")
                                + "_" + (!string.IsNullOrEmpty(VerText) ? VerText : "-") + ".xlsx";
            SetComboBox(filePath);

            TypeText = string.Empty;
            VerText = string.Empty;
            LotText = string.Empty;
            SlotText = string.Empty;
            ProgramText = string.Empty;
        }

        [ObservableProperty]
        private string typeText = string.Empty;
        partial void OnTypeTextChanged(string value)
        {
            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            foreach (var item in NewDataItems) item.Type = tmpValue;
            string tmpProduct = !string.IsNullOrEmpty(ProductText) ? ProductText : "-";
            var _product = _dataListBoxItems.Keys.FirstOrDefault(item => item.Name == tmpProduct);

            if (_product != null)
            {
                var _type = _dataListBoxItems[_product].Keys.FirstOrDefault(item => item.Name == tmpValue);
                if (_type != null) Vers = _dataListBoxItems[_product][_type].Select(item => item.Name).ToList();
                else Vers = Vals.initialVers;
            }
            else Vers = Vals.initialVers;

            string filePath = _folderPath + "\\" + tmpProduct + "_" + tmpValue + "_" + (!string.IsNullOrEmpty(VerText) ? VerText : "-") + ".xlsx";
            SetComboBox(filePath);

            VerText = string.Empty;
            LotText = string.Empty;
            SlotText = string.Empty;
            ProgramText = string.Empty;
        }

        [ObservableProperty]
        private string verText = string.Empty;
        partial void OnVerTextChanged(string value)
        {
            string tmpValue = !string.IsNullOrEmpty(value) ? value : "-";
            foreach (var item in NewDataItems) item.Ver = tmpValue;

            string filePath = _folderPath + "\\" + (!string.IsNullOrEmpty(ProductText) ? ProductText : "-") + "_" 
                                + (!string.IsNullOrEmpty(TypeText) ? TypeText : "-") + "_" + tmpValue + ".xlsx";
            SetComboBox(filePath);

            LotText = string.Empty;
            SlotText = string.Empty;
            ProgramText = string.Empty;
        }

        [ObservableProperty]
        private string lotText = string.Empty;
        partial void OnLotTextChanged(string value)
        {
            foreach (var item in NewDataItems)
            {
                item.Lot = value;
                item.LotSlot = value + "-" + item.Slot;
            }
        }

        [ObservableProperty]
        private string slotText = string.Empty;
        partial void OnSlotTextChanged(string value) 
        {
            foreach (var item in NewDataItems)
            {
                item.Slot = value;
                item.LotSlot = item.Lot + "-" + value;
            }
        }

        [ObservableProperty]
        private string programText = string.Empty;
        partial void OnProgramTextChanged(string value) 
        {
            foreach (var item in NewDataItems) item.Program = value;
        }

        [ObservableProperty]
        private string remarkText = string.Empty;
        partial void OnRemarkTextChanged(string value)
        {
            foreach (var item in NewDataItems) item.Remark = value;
        }

        [ObservableProperty]
        private ObservableCollection<DataItem> newDataItems = [];

        private int cnt;
        private readonly string _folderPath;
        readonly Dictionary<ItemModel, Dictionary<ItemModel, List<ItemModel>>> _dataListBoxItems;

        public AddViewModel(string folderPath, ItemModel selectedProduct, ItemModel selectedType, ItemModel selectedVer, 
                            Dictionary<ItemModel, Dictionary<ItemModel, List<ItemModel>>> dataItems) 
        {
            _folderPath = folderPath;
            _dataListBoxItems = dataItems;
            Products = _dataListBoxItems.Keys.Select(item => item.Name).ToList();
            ProductText = selectedProduct.Name;
            Types = _dataListBoxItems[selectedProduct].Keys.Select(item => item.Name).ToList();
            TypeText = selectedType.Name;
            Vers = _dataListBoxItems[selectedProduct][selectedType].Select(item => item.Name).ToList();
            VerText = selectedVer.Name;
            string filePath = _folderPath + "\\" + selectedProduct.Name + "_" + selectedType.Name + "_" + (selectedVer.Name != "all" ? selectedVer.Name : "-") + ".xlsx";
            SetComboBox(filePath);
            SlotText = "-";

            NewDataItems.CollectionChanged += (s, e) => AddOKCommand.NotifyCanExecuteChanged();
        }

        private void SetComboBox(string filePath)
        {
            if (File.Exists(filePath))
            {
                var result = LoadDataList(filePath);
                Links = result.Item1;
                Lots = result.Item2;
                Programs = result.Item3;
                cnt = Links.Count;
            }
            else
            {
                Links = [];
                Lots = [];
                Programs = [];
                cnt = 0;
            }
        }

        private static (List<string>, List<string>, List<string>) LoadDataList(string filePath)
        {
            List<string> links = [];
            List<string> lots = [];
            List<string> programs = [];

            using var stream = new FileStream(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(stream);
            ISheet sheet = workbook.GetSheetAt(0);

            // データ行を取得
            for (int i = 1; i <= sheet.LastRowNum; i++)
            {
                var row = sheet.GetRow(i);
                if (row == null) continue;
                links.Add(row.GetCell(2).StringCellValue);
                lots.Add(row.GetCell(6).StringCellValue);
                programs.Add(row.GetCell(9).StringCellValue);
            }
            workbook.Close();

            return (links, lots, programs);
        }

        [RelayCommand]
        private void AddSelect()
        {
            if (!IsAddFolder)
            {
                using var openFileDialog = new OpenFileDialog();
                if (openFileDialog.ShowDialog() == DialogResult.OK)
                {
                    if (Links.Contains(openFileDialog.FileName))
                    {
                        System.Windows.MessageBox.Show("既にリストに存在します。");
                        return;
                    }
                    SelectedAddPath = openFileDialog.FileName;
                    var dataItem = new DataItem
                    {
                        No = ++cnt,
                        DataName = Path.GetFileName(SelectedAddPath),
                        Link = SelectedAddPath,
                        Product = !String.IsNullOrEmpty(ProductText) ? ProductText : "-",
                        Type = !String.IsNullOrEmpty(TypeText) ? TypeText : "-",
                        Ver = !String.IsNullOrEmpty(VerText) ? VerText : "-",
                        Lot = !String.IsNullOrEmpty(LotText) ? LotText : "-",
                        Slot = !String.IsNullOrEmpty(SlotText) ? SlotText : "-",
                        LotSlot = (!String.IsNullOrEmpty(LotText) ? LotText : "-") + "-" + (!String.IsNullOrEmpty(SlotText) ? SlotText : "-"),
                        Program = !String.IsNullOrEmpty(ProgramText) ? ProgramText : "-",
                        Remark = !String.IsNullOrEmpty(RemarkText) ? RemarkText : string.Empty
                    };
                    NewDataItems.Add(dataItem);
                }
            }
            else
            {
                using var folderDialog = new FolderBrowserDialog();
                if (folderDialog.ShowDialog() == DialogResult.OK) 
                {
                    SelectedAddPath = folderDialog.SelectedPath; 
                    var searchOption = IsAddSubFolder ? SearchOption.AllDirectories : SearchOption.TopDirectoryOnly; 
                    var filePaths = Directory.GetFiles(SelectedAddPath, "*.*", searchOption);

                    int existCnt = 0;
                    foreach (var path in filePaths) 
                    {
                        if (Links.Contains(path)) 
                        {  
                            existCnt++;
                            continue;
                        }
                        var dataItem = new DataItem
                        {
                            No = ++cnt,
                            DataName = Path.GetFileName(path),
                            Link = path,
                            Product = !String.IsNullOrEmpty(ProductText) ? ProductText : "-",
                            Type = !String.IsNullOrEmpty(TypeText) ? TypeText : "-",
                            Ver = !String.IsNullOrEmpty(VerText) ? VerText : "-",
                            Lot = !String.IsNullOrEmpty(LotText) ? LotText : "-",
                            Slot = !String.IsNullOrEmpty(SlotText) ? SlotText : "-",
                            LotSlot = (!String.IsNullOrEmpty(LotText) ? LotText : "-") + "-" + (!String.IsNullOrEmpty(SlotText) ? SlotText : "-"),
                            Program = !String.IsNullOrEmpty(ProgramText) ? ProgramText : "-",
                            Remark = !String.IsNullOrEmpty(RemarkText) ? RemarkText : string.Empty
                        };
                        NewDataItems.Add(dataItem);
                    }

                    if (existCnt > 0 && NewDataItems.Count > 0)
                    {
                        System.Windows.MessageBox.Show($"{existCnt}既にリストに存在しているファイルは除外しました");
                    }
                    else if (NewDataItems.Count == 0)
                    {
                        System.Windows.MessageBox.Show("全て既にリストに存在します。");
                    }
                }
            }
            
        }

        [RelayCommand(CanExecute = nameof(CanAddOK))]
        private void AddOK(Window window)
        {
            if (NewDataItems.Count > 0)
            {
                window.DialogResult = true; 
                window.Close();
            }
        }
        private bool CanAddOK()
        {
            return NewDataItems.Count > 0;
        }

        [RelayCommand]
        private static void AddCancel(Window window)
        {
            window.DialogResult = false;
            window.Close();
        }
    }
}

            </code></pre>

            <p>
                AddWindow.xaml
            </p>
            <pre><code class="prettyprint">
                &lt;Window x:Class="DataManager.AddWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DataManager"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Style="{StaticResource MaterialDesignWindow}"
        Title="DataList追加" Height="360" Width="640"
        ResizeMode="NoResize"&gt;
    &lt;Grid&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="*"/&gt;
            &lt;RowDefinition Height="auto"/&gt;
        &lt;/Grid.RowDefinitions&gt;

        &lt;Grid Grid.Row="0"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="*"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;
            &lt;TextBox Grid.Column="0" Margin="8 4 2 4" Height="35" VerticalAlignment="Center"
                     Padding="0 0 0 0"  materialDesign:HintAssist.Hint="FilePath"
                     Style="{StaticResource MaterialDesignOutlinedTextBox}"
                     Text="{Binding SelectedAddPath}" IsReadOnly="True"/&gt;
            &lt;Button Grid.Column="1" Command="{Binding AddSelectCommand}" Width="90" Margin="2 8 8 8" Content="Select"/&gt;
        &lt;/Grid&gt;

        &lt;StackPanel Grid.Row="1" Orientation="Horizontal"&gt;
            &lt;CheckBox Content="同じフォルダにあるファイルを全てリストアップする" Margin="8 8 8 8" IsChecked="{Binding IsAddFolder}"/&gt;
            &lt;CheckBox Content="サブフォルダもリストアップする" Margin="8 8 8 8" IsChecked="{Binding IsAddSubFolder}" IsEnabled="{Binding IsAddFolder}"/&gt;
        &lt;/StackPanel&gt;

        &lt;Grid Grid.Row="2"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="*"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;

            &lt;StackPanel Grid.Column="0" Orientation="Vertical"&gt;
                &lt;Grid&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;
                    &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Product:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                    &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxProduct" IsEditable="True" 
                              ItemsSource="{Binding Products}" Text="{Binding ProductText}"/&gt;
                &lt;/Grid&gt;

                &lt;Grid&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;
                    &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Type:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                    &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxType" IsEditable="True"
                              ItemsSource="{Binding Types}" Text="{Binding TypeText}"/&gt;
                &lt;/Grid&gt;

                &lt;Grid&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;
                    &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Ver:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                    &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxVer" IsEditable="True"
                              ItemsSource="{Binding Vers}" Text="{Binding VerText}"/&gt;
                &lt;/Grid&gt;
            &lt;/StackPanel&gt;

            &lt;StackPanel Grid.Column="1" Orientation="Vertical"&gt;
                &lt;Grid&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;
                    &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Lot:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                    &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxLot" IsEditable="True"
                              ItemsSource="{Binding Lots}" Text="{Binding LotText}"/&gt;
                &lt;/Grid&gt;

                &lt;Grid&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;
                    &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Slot:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                    &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxSlot" IsEditable="False"
                              ItemsSource="{Binding Slots}" Text="{Binding SlotText}"/&gt;
                &lt;/Grid&gt;

                &lt;Grid&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;
                    &lt;TextBlock Grid.Column="0" Width="55" Margin="8 8 8 8" Text="Program:" TextAlignment="Right" VerticalAlignment="Center"/&gt;
                    &lt;ComboBox Grid.Column="1" Width="80" Margin="8 8 8 8" x:Name="ComboBoxProgram" IsEditable="True"
                              ItemsSource="{Binding Programs}" Text="{Binding ProgramText}"/&gt;
                &lt;/Grid&gt;
            &lt;/StackPanel&gt;

            &lt;Grid Grid.Column="2"&gt;
                &lt;Grid.ColumnDefinitions&gt;
                    &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;ColumnDefinition Width="*"/&gt;
                &lt;/Grid.ColumnDefinitions&gt;
                &lt;TextBlock Grid.Column="0" Width="55" Margin="8 12 8 8" Text="Remark:" TextAlignment="Right" VerticalAlignment="Top"/&gt;
                &lt;TextBox Grid.Column="1" Margin="2 8 8 8" BorderBrush="DarkGray" BorderThickness="1"
                         AcceptsReturn="True" TextWrapping="Wrap" VerticalContentAlignment="Top"
                         Text="{Binding RemarkText}"/&gt;
            &lt;/Grid&gt;
        &lt;/Grid&gt;
        
        &lt;StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right"&gt;
            &lt;Button Command="{Binding AddOKCommand}" Width="90" Margin="8 8 8 8" Content="OK"
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/&gt;
            &lt;Button Command="{Binding AddCancelCommand}" Width="90" Margin="8 8 8 8" Content="Cancel"
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/&gt;
        &lt;/StackPanel&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
            </code></pre>

            <p>
                AddWindow.xaml.cs
            </p>
            <pre><code class="prettyprint">
                using System.Windows;

namespace DataManager
{
    /// <summary>
    /// AddWindow.xaml の相互作用ロジック
    /// </summary>
    public partial class AddWindow : Window
    {
        //public DataItem NewDataItem { get; private set; } = new();

        public AddWindow(AddViewModel viewModel)
        {
            InitializeComponent();
            DataContext = viewModel;
        }
    }
}
            </code></pre>

            <p>
                DataItem.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace DataManager
{
    public partial class DataItem : ObservableObject
    {
        [ObservableProperty]
        private bool isSelected;

        public int No { get; set; }
        public string DataName { get; set; } = string.Empty;
        public string Link { get; set; } = string.Empty;

        [ObservableProperty]
        private string product = string.Empty;

        [ObservableProperty]
        private string type = string.Empty;

        [ObservableProperty]
        private string ver = string.Empty;

        [ObservableProperty]
        private string lot = string.Empty;

        [ObservableProperty]
        private string slot = string.Empty;

        [ObservableProperty]
        private string lotSlot = string.Empty;

        [ObservableProperty]
        private string program = string.Empty;

        [ObservableProperty]
        private string remark = string.Empty;
    }
}
            </code></pre>

            <p>
                ItemModel.cs
            </p>
            <pre><code class="prettyprint">
                using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace DataManager
{
    public class ItemModel
    {
        public string Name { get; set; } = string.Empty;
        public bool IsDeletable { get; set; }

        public override bool Equals(object? obj)
        {
            if (obj is ItemModel other)
            {
                return Name == other.Name;
            }
            return false;
        }

        public override int GetHashCode()
        {
            return Name.GetHashCode();
        }
    }
}
            </code></pre>

            <p>
                MainViewModel.cs
            </p>
            <pre><code class="prettyprint">
                //コンストラクタ
                //共通
userName = Environment.UserName;
executeFilePath = Environment.ProcessPath;

publicFolder = Path.GetDirectoryName(executeFilePath) + "\\setup\\DataManagement\\public";
publicSetupFile = Path.GetDirectoryName(executeFilePath) + "\\setup\\DataManagement\\public.xlsx";
privateFolder = Path.GetDirectoryName(executeFilePath) + "\\setup\\DataManagement\\" + userName;
privateSetupFile = Path.GetDirectoryName(executeFilePath) + "\\setup\\DataManagement\\" + userName +".xlsx";

//publicの設定ファイル・フォルダを作成
if (!File.Exists(publicSetupFile)) MakeInitialSetupFile(publicSetupFile);
if (!Directory.Exists(publicFolder))
{
    Directory.CreateDirectory(publicFolder);
    MakeInitialDataGridInfo(publicFolder, publicSetupFile);
}

//ユーザーの設定ファイル・フォルダを作成
if (!File.Exists(privateSetupFile)) MakeInitialSetupFile(privateSetupFile);
if (!Directory.Exists(privateFolder))
{
    Directory.CreateDirectory(privateFolder);
    MakeInitialDataGridInfo(privateFolder, privateSetupFile);
}

//データ管理
IsDataManegementEnabled = true;
Modes = ["private", "public"];
SelectedMode = "public";
if (SelectedMode == "public") DataManegementListBoxData = ReadExcelToDictionary(publicSetupFile);
else DataManegementListBoxData = ReadExcelToDictionary(privateSetupFile);

Products = new ObservableCollection<ItemModel>(DataManegementListBoxData.Keys);
SelectedProductIndex = 0;

//フィルタの設定
Headers = new ObservableCollection<string>(Vals.dataGridHeaders);
foreach (var header in Headers)
{
    HeaderFilters.Add(header, "");  //初期値は空のデータを格納
}
SelectedHeaderKey = Headers[0];
UpdateValueText();
IsFiltering = false;

//// ディクショナリの変更イベントを購読
//HeaderFilters.CollectionChanged += (s, e) => ApplyFilter(); 
//DataItems.CollectionChanged += (s, e) => ApplyFilter();

//Home
IsDataManegementCardEnabled = IsFlipped;
            </code></pre>

            <p>
                MainViewModel.Home.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Media.Animation;

namespace DataManager
{
    public partial class MainViewModel : ObservableObject
    {
        //Home
        [ObservableProperty]
        private int slideIndex = 0;

        [ObservableProperty]
        private bool isToggled;

        [ObservableProperty]
        private bool isFlipped;

        partial void OnIsFlippedChanged(bool value) 
        {
            System.Windows.Application.Current.Dispatcher.Invoke(() => 
            { 
                Storyboard flipAnimation = (Storyboard)System.Windows.Application.Current.MainWindow.FindResource("FlipAnimation");
                flipAnimation.Begin(); }); 
        }

        [ObservableProperty]
        private int tabIndex = 0;

        [ObservableProperty] 
        private bool isDataManegementCardEnabled;

        [RelayCommand]
        private void SelectFirstSlide()
        {
            SlideIndex = 0;
        }

        [RelayCommand]
        private void SelectUserSlide()
        {
            SlideIndex = 1;
        }

        [RelayCommand]
        private void SelectSaveSlide()
        {
            SlideIndex = 2;
        }

        [RelayCommand]
        private void SelectFTPSlide()
        {
            SlideIndex = 3;
        }

        [RelayCommand]
        private void SelectScheduleSlide()
        {
            SlideIndex = 4;
        }

        [RelayCommand]
        private void SelectLogToExcelTab() 
        { 
            TabIndex = 1;
        }

        [RelayCommand]
        private void SelectDataConvertTab()
        {
            TabIndex = 2;
        }

        [RelayCommand]
        private void SelectDataManegementTab()
        {
            TabIndex = 3;
        }

        [RelayCommand]
        private void SelectDataExtractTab()
        {
            TabIndex = 4;
        }

        [RelayCommand]
        private void SelectDecompressTab()
        {
            TabIndex = 5;
        }

        [RelayCommand]
        private void SelectCompressTab()
        {
            TabIndex = 6;
        }

        [RelayCommand]
        private void SelectSeverCheckTab()
        {
            TabIndex = 7;
        }

        public void EnableDataManegementCard()
        {
            IsDataManegementCardEnabled = IsFlipped;
        }
    }
}
            </code></pre>

            <p>
                MainViewModel.Manegement.cs
            </p>
            <pre><code class="prettyprint">
                using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using NPOI.SS.Formula.Functions;
using NPOI.SS.UserModel;
using NPOI.XSSF.UserModel;
using System.Collections.ObjectModel;
using System.IO;
using System.Windows.Input;

namespace DataManager
{
    public partial class MainViewModel
    {
        //*** データ管理 ***
        [ObservableProperty]
        private Dictionary<ItemModel, Dictionary<ItemModel, List<ItemModel>>> dataManegementListBoxData;

        [ObservableProperty]
        public ObservableCollection<string> modes = [];

        [ObservableProperty]
        private string selectedMode = string.Empty;
        partial void OnSelectedModeChanged(string value)
        {
            //モード切り替え時の動作
            if (value == "public") DataManegementListBoxData = ReadExcelToDictionary(publicSetupFile);
            else DataManegementListBoxData = ReadExcelToDictionary(privateSetupFile);
            Products = new ObservableCollection<ItemModel>(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = 0;   //Product以降の動作はOnSelectedProductChangedで記述
        }

        [ObservableProperty]
        private ObservableCollection<ItemModel> products = [];

        [ObservableProperty]
        private ItemModel selectedProduct = new();
        partial void OnSelectedProductChanged(ItemModel value)
        {
            RemoveProductCommand.NotifyCanExecuteChanged(); //選択状態が変わったら、CanRemoveProductを動作させる
            if (value != null && DataManegementListBoxData.ContainsKey(value))
            {
                Types = new ObservableCollection<ItemModel>(DataManegementListBoxData[value].Keys);
                SelectedType = null!;
                if (Types.Count > 0) SelectedType = Types[0];    //Type以降の動作はOnSelectedTypeChangedで記述
            }
        }

        [ObservableProperty]
        private int selectedProductIndex;

        [ObservableProperty]
        private string newProductText = string.Empty;

        [ObservableProperty]
        private ObservableCollection<ItemModel> types = [];

        [ObservableProperty]
        private ItemModel selectedType = new();
        partial void OnSelectedTypeChanged(ItemModel value)
        {
            RemoveTypeCommand.NotifyCanExecuteChanged();    //選択状態が変わったら、CanRemoveTypeを動作させる
            if (value != null && DataManegementListBoxData[SelectedProduct].ContainsKey(value)) 
            {
                Vers = new ObservableCollection<ItemModel>(DataManegementListBoxData[SelectedProduct][value]);
                SelectedVer = null!;
                if (Vers.Count > 0) SelectedVer = Vers[0];  //Ver以降の動作はOnSelectedVerChangedで記述
            }
        }

        [ObservableProperty]
        private int selectedTypeIndex;

        [ObservableProperty]
        private string newTypeText = string.Empty;

        [ObservableProperty]
        private ObservableCollection<ItemModel> vers = [];

        [ObservableProperty]
        private ItemModel selectedVer = new();
        partial void OnSelectedVerChanged(ItemModel value)
        {
            RemoveVerCommand.NotifyCanExecuteChanged(); //選択状態が変わったら、CanRemoveVerを動作させる
            if (value != null)
            {
                string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                                    + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + value.Name + ".xlsx";
                try
                {
                    Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                    LoadData(filePath); //DataGrid用のExcel設定ファイルを読み込む
                }
                finally
                {
                    Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
                }
            }
        }

        [ObservableProperty]
        private int selectedVerIndex;

        [ObservableProperty]
        private string newVerText = string.Empty;

        [ObservableProperty]
        private ObservableCollection<string> headers = [];  //DataGridのヘッダー情報

        [ObservableProperty]
        private Dictionary<string, string> headerFilters = [];  //TODO:フィルタ用のディクショナリ。更新された際にDataGridを更新する機能を追加する
        //private readonly ObservableDictionary<string, string> HeaderFilters = [];  //TODO:フィルタ用のディクショナリ。更新された際にDataGridを更新する機能を追加する

        [ObservableProperty] 
        private string selectedHeaderKey = string.Empty;
        partial void OnSelectedHeaderKeyChanged(string value)
        {
            UpdateValueText();  //ComboBoxの選択を切り替えたら、フィルタの表示(TextBox)を更新する
        }

        [ObservableProperty] 
        private string selectedHeaderValue = string.Empty;
        partial void OnSelectedHeaderValueChanged(string value)
        {
            if (!string.IsNullOrEmpty(SelectedHeaderKey)) 
            { 
                HeaderFilters[SelectedHeaderKey] = value;   //フィルタ(TextBox)の値を更新したらフィルタ用のディクショナリを更新
            }
        }

        [ObservableProperty]
        private bool isFiltering;

        [ObservableProperty]
        private ObservableCollection<DataItem> dataItems = [];  //DataGridのデータ

        [ObservableProperty] 
        private ObservableCollection<DataItem> tmpDataItems = [];    //DataGridのテンポラリデータ

        [ObservableProperty]
        private List<string> dataManegementColumnHeaders = [];  // TODO: DataGridのヘッダー。現状は有効利用できていない。

        [ObservableProperty]
        private DataItem selectedDataItem = new();  //DataGridの選択行
        partial void OnSelectedDataItemChanged(DataItem value)
        {
            UpdateDataManegementInfo(value);    //選択が変わったらInfomationを更新
        }

        [ObservableProperty]
        private string selectedDataItemInfo = string.Empty; //選択行の情報。

        [ObservableProperty]
        private bool isDataManegementEnabled;   //DataManegementのコントロールのEnabledにバインディング

        //TODO: Commandの非同期の動作

        [ObservableProperty]
        private bool isDataManegementAdding;  //DataGridの追加中を示す変数。

        [ObservableProperty]
        private int addDataListStatus; // DataGridの削除中のボタン状態の変数。

        [ObservableProperty]
        private bool isDataManegementRemoving;  //DataGridの削除中を示す変数。

        [ObservableProperty]
        private int removeDataListStatus; // DataGridの削除中のボタン状態の変数。

        [RelayCommand]
        private void AddProduct()
        {
            if (!string.IsNullOrWhiteSpace(NewProductText) && !Products.Any(item => item.Name == NewProductText))
            {
                AddProductItem(NewProductText);
                NewProductText = string.Empty;
            }
        }
        
        private void AddProductItem(string value)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            for (int j = 0; j < Vals.initialTypes.Count; j++)
            {
                for (int k = 0; k < Vals.initialVers.Count; k++)
                {
                    IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
                    row.CreateCell(0).SetCellValue(value);
                    row.CreateCell(1).SetCellValue(1);  //追加のproductは編集可能に
                    row.CreateCell(2).SetCellValue(Vals.initialTypes[j]);
                    row.CreateCell(3).SetCellValue(0);
                    row.CreateCell(4).SetCellValue(Vals.initialVers[k]);
                    row.CreateCell(5).SetCellValue(0);
                    string outFilePath = folderPath + "\\" + value + "_" + Vals.initialTypes[j] + "_" + Vals.initialVers[k] + ".xlsx";
                    MakeInitialDataGridFile(outFilePath);
                }
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = ReadExcelToDictionary(filePath);
            Products = new ObservableCollection<ItemModel>(DataManegementListBoxData.Keys);
            var newProduct = new ItemModel { Name = value, IsDeletable = true };
            SelectedProduct = newProduct;
        }

        [RelayCommand(CanExecute = nameof(CanRemoveProduct))]
        private void RemoveProduct()
        {
            if (SelectedProduct != null && SelectedProduct.IsDeletable)
            {
                int _selectedIndex = SelectedProductIndex;
                string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
                string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

                XSSFWorkbook workbook;
                using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(file);
                }

                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
                for (int i = sheet.LastRowNum; i >= 0; i--)
                {
                    IRow row = sheet.GetRow(i);
                    if (row != null)
                    {
                        ICell cell0 = row.GetCell(0); // 1列目のセルを取得
                        ICell cell1 = row.GetCell(1); // 2列目のセルを取得
                        ICell cell2 = row.GetCell(2); // 3列目のセルを取得
                        ICell cell4 = row.GetCell(4); // 5列目のセルを取得
                        if (cell0 != null && cell2 != null && cell4 != null && cell0.StringCellValue == SelectedProduct.Name && cell1.NumericCellValue != 0)
                        {
                            sheet.RemoveRow(row);   //行を削除
                            // 後続の行を上にシフト
                            if (i < sheet.LastRowNum) sheet.ShiftRows(i + 1, sheet.LastRowNum, -1);
                            string deleteFilePath = folderPath + "\\" + cell0.StringCellValue + "_" + cell2.StringCellValue + "_" + cell4.StringCellValue + ".xlsx";
                            if (File.Exists(deleteFilePath)) File.Delete(deleteFilePath);
                        }
                    }
                }

                using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
                {
                    workbook.Write(fileOut); // ファイルに書き込み
                }
                workbook.Close();

                DataManegementListBoxData = ReadExcelToDictionary(filePath);
                Products = new ObservableCollection<ItemModel>(DataManegementListBoxData.Keys);
                SelectedProductIndex = _selectedIndex - 1;  //削除できないデータが1つ以上あるため0以下になるケアは不要
            }
        }
        private bool CanRemoveProduct()
        {
            return SelectedProduct != null && SelectedProduct.IsDeletable;
        }

        [RelayCommand]
        private void AddType()
        {
            if (!string.IsNullOrWhiteSpace(NewTypeText) && !Types.Any(item => item.Name == NewTypeText))
            {
                AddTypeItem(NewTypeText);
                NewTypeText = string.Empty;
            }
        }

        private void AddTypeItem(string value)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedIndex = SelectedProductIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            for (int k = 0; k < Vals.initialVers.Count; k++)
            {
                IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
                row.CreateCell(0).SetCellValue(SelectedProduct.Name);
                row.CreateCell(1).SetCellValue(SelectedProduct.IsDeletable ? 1 : 0);  
                row.CreateCell(2).SetCellValue(value);
                row.CreateCell(3).SetCellValue(1);  //追加のTypeは編集可能に
                row.CreateCell(4).SetCellValue(Vals.initialVers[k]);
                row.CreateCell(5).SetCellValue(0);

                string outFilePath = folderPath + "\\" + SelectedProduct.Name + "_" + value + "_" + Vals.initialVers[k] + ".xlsx";
                MakeInitialDataGridFile(outFilePath);
            }

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = ReadExcelToDictionary(filePath);
            Products = new ObservableCollection<ItemModel>(DataManegementListBoxData.Keys);
            SelectedProduct = null!;
            SelectedProductIndex = _selectedIndex;
            var newType = new ItemModel { Name = value, IsDeletable = true };
            SelectedType = newType;
        }

        [RelayCommand(CanExecute = nameof(CanRemoveType))]
        private void RemoveType()
        {
            if (SelectedType != null && SelectedType.IsDeletable)
            {
                int _selectedProductIndex = SelectedProductIndex;
                int _selectedTypeIndex = SelectedTypeIndex;
                string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
                string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

                XSSFWorkbook workbook;
                using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(file);
                }

                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
                for (int i = sheet.LastRowNum; i >= 0; i--)
                {
                    IRow row = sheet.GetRow(i);
                    if (row != null)
                    {
                        ICell cell0 = row.GetCell(0); // 1列目のセルを取得
                        ICell cell2 = row.GetCell(2); // 3列目のセルを取得
                        ICell cell3 = row.GetCell(3); // 4列目のセルを取得
                        ICell cell4 = row.GetCell(4); // 4列目のセルを取得
                        if (cell0 != null && cell2 != null && cell4 != null 
                            && cell0.StringCellValue == SelectedProduct.Name && cell2.StringCellValue == SelectedType.Name && cell3.NumericCellValue != 0)
                        {
                            sheet.RemoveRow(row);   // 行を削除
                            // 後続の行を上にシフト
                            if (i < sheet.LastRowNum) sheet.ShiftRows(i + 1, sheet.LastRowNum, -1);
                            string deleteFilePath = folderPath + "\\" + cell0.StringCellValue + "_" + cell2.StringCellValue + "_" + cell4.StringCellValue + ".xlsx";
                            if (File.Exists(deleteFilePath)) File.Delete(deleteFilePath);
                        }
                    }
                }

                using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
                {
                    workbook.Write(fileOut); // ファイルに書き込み
                }
                workbook.Close();

                DataManegementListBoxData = ReadExcelToDictionary(filePath);
                Products = new ObservableCollection<ItemModel>(DataManegementListBoxData.Keys);
                SelectedProduct = null!;
                SelectedProductIndex = _selectedProductIndex;
                SelectedTypeIndex = _selectedTypeIndex - 1;   //削除できないデータが1つ以上あるため0以下になるケアは不要
            }
        }
        private bool CanRemoveType()
        {
            return SelectedType != null && SelectedType.IsDeletable;
        }

        [RelayCommand]
        private void AddVer()
        {
            if (!string.IsNullOrWhiteSpace(NewVerText) && !Vers.Any(item => item.Name == NewVerText))
            {
                AddVerItem(NewVerText);
                NewVerText = string.Empty;
            }
        }

        private void AddVerItem(string value)
        {
            string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            int _selectedProductIndex = SelectedProductIndex;
            int _selectedTypeIndex = SelectedTypeIndex;
            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }

            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
            int lastRowNum = sheet.LastRowNum;
            IRow row = sheet.CreateRow(++lastRowNum); // 新しい行を作成
            row.CreateCell(0).SetCellValue(SelectedProduct.Name);
            row.CreateCell(1).SetCellValue(SelectedProduct.IsDeletable ? 1 : 0);
            row.CreateCell(2).SetCellValue(SelectedType.Name);
            row.CreateCell(3).SetCellValue(SelectedType.IsDeletable ? 1 : 0);
            row.CreateCell(4).SetCellValue(value);
            row.CreateCell(5).SetCellValue(1);  //追加のTypeは編集可能に

            string outFilePath = folderPath + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + value + ".xlsx";
            MakeInitialDataGridFile(outFilePath);

            using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
            {
                workbook.Write(fileOut); // ファイルに書き込み
            }
            workbook.Close();

            DataManegementListBoxData = ReadExcelToDictionary(filePath);
            Products = new ObservableCollection<ItemModel>(DataManegementListBoxData.Keys);
            //SelectedProduct = null!;
            SelectedProductIndex = -1;
            SelectedProductIndex = _selectedProductIndex;
            //SelectedType = null!;
            SelectedTypeIndex = -1;
            SelectedTypeIndex = _selectedTypeIndex;
            var newVer = new ItemModel { Name = value, IsDeletable = true };
            SelectedVer = newVer;
        }

        [RelayCommand(CanExecute = nameof(CanRemoveVer))]
        private void RemoveVer()
        {
            if (SelectedVer != null && SelectedVer.IsDeletable)
            {
                int _selectedProductIndex = SelectedProductIndex;
                int _selectedTypeIndex = SelectedTypeIndex;
                int _selectedVerIndex = SelectedVerIndex;
                string filePath = SelectedMode == "public" ? publicSetupFile : privateSetupFile;
                string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;

                XSSFWorkbook workbook;
                using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(file);
                }

                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得
                for (int i = sheet.LastRowNum; i >= 0; i--)
                {
                    IRow row = sheet.GetRow(i);
                    if (row != null)
                    {
                        ICell cell0 = row.GetCell(0); // 1列目のセルを取得
                        ICell cell2 = row.GetCell(2); // 3列目のセルを取得
                        ICell cell4 = row.GetCell(4); // 4列目のセルを取得
                        ICell cell5 = row.GetCell(5); // 4列目のセルを取得
                        if (cell0 != null && cell2 != null && cell4 != null
                            && cell0.StringCellValue == SelectedProduct.Name && cell2.StringCellValue == SelectedType.Name && cell4.StringCellValue == SelectedVer.Name && cell5.NumericCellValue != 0)
                        {
                            sheet.RemoveRow(row);   // 行を削除
                            // 後続の行を上にシフト
                            if (i < sheet.LastRowNum) sheet.ShiftRows(i + 1, sheet.LastRowNum, -1);
                            string deleteFilePath = folderPath + "\\" + cell0.StringCellValue + "_" + cell2.StringCellValue + "_" + cell4.StringCellValue + ".xlsx";
                            if (File.Exists(deleteFilePath)) File.Delete(deleteFilePath);
                            break;
                        }
                    }
                }

                using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
                {
                    workbook.Write(fileOut); // ファイルに書き込み
                }
                workbook.Close();

                DataManegementListBoxData = ReadExcelToDictionary(filePath);
                Products = new ObservableCollection<ItemModel>(DataManegementListBoxData.Keys);
                SelectedProduct = null!;
                SelectedProductIndex = _selectedProductIndex;
                SelectedType = null!;
                SelectedTypeIndex = _selectedTypeIndex;
                SelectedVerIndex = _selectedVerIndex - 1;     //削除できないデータが1つ以上あるため0以下になるケアは不要
            }
        }
        private bool CanRemoveVer()
        {
            return SelectedVer != null && SelectedVer.IsDeletable;
        }

        [RelayCommand]
        private void ClearFilter()
        {
            ClearFilterDictionary();
            string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                                    + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedVer.Name + ".xlsx";
            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                LoadData(filePath); //DataGrid用のExcel設定ファイルを読み込む
                foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }
        }

        private void LoadData(string filePath)
        {
            IsFiltering = false;
            using var stream = new FileStream(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(stream);
            ISheet sheet = workbook.GetSheetAt(0);

            // TODO: ヘッダーを取得。現状は有効利用できていない。
            var headerRow = sheet.GetRow(0);
            DataManegementColumnHeaders.Clear();
            for (int j = 0; j < headerRow.LastCellNum; j++)
            {
                string? _header = headerRow.GetCell(j).ToString();
                if (_header == null) return;
                DataManegementColumnHeaders.Add(_header);
            }

            // データ行を取得
            DataItems.Clear();
            for (int i = 1; i <= sheet.LastRowNum; i++)
            {
                var row = sheet.GetRow(i);
                if (row == null) continue;
                var dataItem = new DataItem
                {
                    No = (int)row.GetCell(0).NumericCellValue,
                    DataName = row.GetCell(1).StringCellValue,
                    Link = row.GetCell(2).StringCellValue,
                    Product = row.GetCell(3).StringCellValue,
                    Type = row.GetCell(4).StringCellValue,
                    Ver = row.GetCell(5).StringCellValue,
                    Lot = row.GetCell(6).StringCellValue,
                    Slot = row.GetCell(7).StringCellValue,
                    LotSlot = row.GetCell(8).StringCellValue,
                    Program = row.GetCell(9).StringCellValue,
                    Remark = row.GetCell(10).StringCellValue
                };
                DataItems.Add(dataItem);
            }
            workbook.Close();
        }

        private void ClearFilterDictionary()
        {
            IsFiltering = false;
            foreach (var headerFilter in HeaderFilters)
            {
                HeaderFilters[headerFilter.Key] = "";
            }
            SelectedHeaderValue = string.Empty;
        }

        //private async Task LoadData(string filePath)
        //{
        //    using var stream = new FileStream(filePath, FileMode.Open, FileAccess.Read);
        //    XSSFWorkbook workbook = new(stream);
        //    ISheet sheet = workbook.GetSheetAt(0);

        //    // TODO: ヘッダーを取得。現状は有効利用できていない。
        //    var headerRow = sheet.GetRow(0);
        //    DataManegementColumnHeaders.Clear();
        //    for (int j = 0; j < headerRow.LastCellNum; j++)
        //    {
        //        string? _header = headerRow.GetCell(j).ToString();
        //        if (_header == null) return;
        //        DataManegementColumnHeaders.Add(_header);
        //    }

        //    // データ行を取得
        //    //DataItems.Clear();
        //    await Task.Run(async () =>
        //    {
        //        for (int i = 1; i <= sheet.LastRowNum; i += Vals.BATCH_SIZE)
        //        {
        //            await System.Windows.Application.Current.Dispatcher.InvokeAsync(() =>
        //            {
        //                int jend = (i + Vals.BATCH_SIZE - 1) <= sheet.LastRowNum ? (i + Vals.BATCH_SIZE - 1) : sheet.LastRowNum;
        //                for (int j = i; j <= jend; j++)
        //                {
        //                    var row = sheet.GetRow(j);
        //                    if (row == null) continue;

        //                    var dataItem = new DataItem
        //                    {
        //                        No = (int)row.GetCell(0).NumericCellValue,
        //                        DataName = row.GetCell(1).StringCellValue,
        //                        Link = row.GetCell(2).StringCellValue,
        //                        Product = row.GetCell(3).StringCellValue,
        //                        Type = row.GetCell(4).StringCellValue,
        //                        Ver = row.GetCell(5).StringCellValue,
        //                        Lot = row.GetCell(6).StringCellValue,
        //                        Slot = row.GetCell(7).StringCellValue,
        //                        LotSlot = row.GetCell(8).StringCellValue,
        //                        Program = row.GetCell(9).StringCellValue,
        //                        Remark = row.GetCell(10).StringCellValue
        //                    };
        //                    DataItems.Add(dataItem);
        //                }
        //            });
        //            await Task.Delay(Vals.BATCH_DELAY); // 小さな遅延を入れてUIがフリーズしないようにする
        //        }
        //    });
        //    //for (int i = 1; i <= sheet.LastRowNum; i++)
        //    //{
        //    //    var row = sheet.GetRow(i);
        //    //    if (row == null) continue;
        //    //    var dataItem = new DataItem
        //    //    {
        //    //        No = (int)row.GetCell(0).NumericCellValue,
        //    //        DataName = row.GetCell(1).StringCellValue,
        //    //        Link = row.GetCell(2).StringCellValue,
        //    //        Product = row.GetCell(3).StringCellValue,
        //    //        Type = row.GetCell(4).StringCellValue,
        //    //        Ver = row.GetCell(5).StringCellValue,
        //    //        Lot = row.GetCell(6).StringCellValue,
        //    //        Slot = row.GetCell(7).StringCellValue,
        //    //        LotSlot = row.GetCell(8).StringCellValue,
        //    //        Program = row.GetCell(9).StringCellValue,
        //    //        Remark = row.GetCell(10).StringCellValue
        //    //    };
        //    //    DataItems.Add(dataItem);
        //    //}
        //    workbook.Close();
        //}

        [RelayCommand]
        private async Task AddDataListAsync()
        {
            IsDataManegementAdding = true;
            IsDataManegementEnabled = !IsDataManegementAdding;
            AddDataListStatus = -1;

            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            var addViewModel = new AddViewModel(folderPath, SelectedProduct, SelectedType, SelectedVer, DataManegementListBoxData);
            var addWindow = new AddWindow(addViewModel);
            if (addWindow.ShowDialog() == true) 
            {
                var newItem = addViewModel.NewDataItems[0];
                if (!Products.Any(item => item.Name == newItem.Product)) AddProductItem(newItem.Product);
                SelectedProduct = null!;
                SelectedProduct = Products.FirstOrDefault(item => item.Name == newItem.Product) ?? null!;   //処理的にnullにならないはず。警告対策。
                if (!Types.Any(item => item.Name == newItem.Type)) AddTypeItem(newItem.Type);
                SelectedType = null!;
                SelectedType = Types.FirstOrDefault(item => item.Name == newItem.Type) ?? null!;    //処理的にnullにならないはず。警告対策。
                if (!Vers.Any(item => item.Name == newItem.Ver)) AddVerItem(newItem.Ver);
                SelectedVer = null!;
                SelectedVer = Vers.FirstOrDefault(item => item.Name == newItem.Ver) ?? null!;   //処理的にnullにならないはず。警告対策。
                await UpdateDataList(addViewModel.NewDataItems);
            }

            IsDataManegementAdding = false;
            IsDataManegementEnabled = !IsDataManegementAdding;
            AddDataListStatus = 0;
        }

        private async Task UpdateDataList(ObservableCollection<DataItem> NewDataItems)
        {
            string folderPath = SelectedMode == "public" ? publicFolder : privateFolder;
            string filePath;
            if (SelectedVer.Name == "all") filePath = folderPath + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" +"-" + ".xlsx";
            else filePath = folderPath + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedVer.Name + ".xlsx";
            
            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                await WriteDataList(filePath, NewDataItems);
                //DataItems.Clear();
                if (SelectedVer.Name != "all") LoadData(filePath); //DataGrid更新
                filePath = folderPath + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + "all" + ".xlsx";
                await WriteDataList(filePath, NewDataItems);
                if (SelectedVer.Name == "all") LoadData(filePath); //DataGrid更新
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }
        }
        
        private static async Task WriteDataList(string filePath, ObservableCollection<DataItem> NewDataItems)
        {
            await Task.Run(() => 
            {
                XSSFWorkbook workbook;
                using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
                {
                    workbook = new XSSFWorkbook(file);
                }
                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得

                int j = sheet.LastRowNum;
                foreach (var item in NewDataItems)
                {
                    IRow row = sheet.CreateRow(++j);
                    IRow prerow = sheet.GetRow(j - 1);
                    int k = 0;
                    //row.CreateCell(k).SetCellValue(item.No);
                    //if (j > 1) row.CreateCell(k).SetCellValue((int)prerow.GetCell(0).NumericCellValue + 1);
                    //else row.CreateCell(k).SetCellValue(1);
                    ////row.CreateCell(k).SetCellValue((int)prerow.GetCell(0).NumericCellValue + 1);
                    if (j > 1) row.CreateCell(k).SetCellValue((int)prerow.GetCell(0).NumericCellValue + 1);
                    else row.CreateCell(k).SetCellValue(1);
                    row.CreateCell(++k).SetCellValue(item.DataName);
                    row.CreateCell(++k).SetCellValue(item.Link);
                    row.CreateCell(++k).SetCellValue(item.Product);
                    row.CreateCell(++k).SetCellValue(item.Type);
                    row.CreateCell(++k).SetCellValue(item.Ver != "all" ? item.Ver : "-");
                    row.CreateCell(++k).SetCellValue(item.Lot);
                    row.CreateCell(++k).SetCellValue(item.Slot);
                    row.CreateCell(++k).SetCellValue(item.LotSlot);
                    row.CreateCell(++k).SetCellValue(item.Program);
                    row.CreateCell(++k).SetCellValue(item.Remark);
                }

                using (FileStream fileOut = new(filePath, FileMode.Create, FileAccess.Write))
                {
                    workbook.Write(fileOut); // ファイルに書き込み
                }
                workbook.Close();
            });
        }

        [RelayCommand(CanExecute = nameof(CanRemoveDataList))]
        private async Task RemoveDataListAsync()
        {
            IsDataManegementRemoving = true;
            IsDataManegementEnabled = !IsDataManegementRemoving;
            RemoveDataListStatus = -1;
            var itemsToRemove = DataItems.Where(item => item.IsSelected).Select(item => item.No).ToList();
            string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                            + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedVer.Name + ".xlsx";
            Dictionary<string, List<DataItem>> deleteItems = [];
            TmpDataItems = LoadDataItems(filePath);

            if (File.Exists(filePath)) File.Delete(filePath);

            XSSFWorkbook workbook;
            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                workbook = new XSSFWorkbook(file);
            }
            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得

            await Task.Run(() => 
            {
                // ヘッダー行を作成
                IRow headerRow = sheet.CreateRow(0);
                int i = 0;
                foreach (var header in Vals.dataGridHeaders)
                {
                    headerRow.CreateCell(i).SetCellValue(header);
                    i++;
                }

                int j = 1;
                foreach (var item in TmpDataItems)
                {
                    if (!itemsToRemove.Contains(item.No))
                    {
                        IRow row = sheet.CreateRow(j);
                        int k = 0;
                        row.CreateCell(k).SetCellValue(j);
                        row.CreateCell(++k).SetCellValue(item.DataName);
                        row.CreateCell(++k).SetCellValue(item.Link);
                        row.CreateCell(++k).SetCellValue(item.Product);
                        row.CreateCell(++k).SetCellValue(item.Type);
                        row.CreateCell(++k).SetCellValue(item.Ver);
                        row.CreateCell(++k).SetCellValue(item.Lot);
                        row.CreateCell(++k).SetCellValue(item.Slot);
                        row.CreateCell(++k).SetCellValue(item.LotSlot);
                        row.CreateCell(++k).SetCellValue(item.Program);
                        row.CreateCell(++k).SetCellValue(item.Remark);
                        j++;
                    }
                    else if (itemsToRemove.Contains(item.No))
                    {
                        var dataItem = new DataItem
                        {
                            No = item.No,
                            DataName = item.DataName,
                            Link = item.Link,
                            Product = item.Product,
                            Type = item.Type,
                            Ver = item.Ver,
                            Lot = item.Lot,
                            Slot = item.Slot,
                            LotSlot = item.LotSlot,
                            Program = item.Program,
                            Remark = item.Remark
                        };
                        if (!deleteItems.ContainsKey(item.Type)) deleteItems[item.Type] = [];
                        deleteItems[item.Type].Add(dataItem);
                    }
                }
            });

            //DataGridアップデート
            DataItems.Clear();
            //await Task.Run(async () =>
            //{
            //    for (int i = 1; i <= sheet.LastRowNum; i += Vals.BATCH_SIZE)
            //    {
            //        await System.Windows.Application.Current.Dispatcher.InvokeAsync(() =>
            //        {
            //            int jend= (i + Vals.BATCH_SIZE - 1) <= sheet.LastRowNum ? (i + Vals.BATCH_SIZE - 1) : sheet.LastRowNum;
            //            for (int j = i; j <= jend; j++)
            //            {
            //                var row = sheet.GetRow(j);
            //                if (row == null) continue;

            //                var dataItem = new DataItem
            //                {
            //                    No = (int)row.GetCell(0).NumericCellValue,
            //                    DataName = row.GetCell(1).StringCellValue,
            //                    Link = row.GetCell(2).StringCellValue,
            //                    Product = row.GetCell(3).StringCellValue,
            //                    Type = row.GetCell(4).StringCellValue,
            //                    Ver = row.GetCell(5).StringCellValue,
            //                    Lot = row.GetCell(6).StringCellValue,
            //                    Slot = row.GetCell(7).StringCellValue,
            //                    LotSlot = row.GetCell(8).StringCellValue,
            //                    Program = row.GetCell(9).StringCellValue,
            //                    Remark = row.GetCell(10).StringCellValue
            //                };
            //                DataItems.Add(dataItem);
            //            }
            //        });
            //        await Task.Delay(Vals.BATCH_DELAY); // 小さな遅延を入れてUIがフリーズしないようにする
            //    }
            //});
            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更

                if (IsFiltering)
                {
                    //ヘッダと紐づけ
                    Dictionary<string, string> filters = [];
                    foreach (var filter in HeaderFilters)
                    {
                        if (filter.Value != "") filters.Add(filter.Key, filter.Value);
                    }

                    var headerRow = sheet.GetRow(0);
                    Dictionary<string, int> headersColumn = [];
                    foreach (var filter in filters)
                    {
                        for (int j = 0; j < headerRow.LastCellNum; j++)
                        {
                            if (filter.Key == headerRow.GetCell(j).ToString())
                            {
                                headersColumn.Add(filter.Key, j);
                            }
                        }
                    }

                    // データ行を取得
                    DataItems.Clear();
                    for (int i = 1; i <= sheet.LastRowNum; i++)
                    {
                        var row = sheet.GetRow(i);
                        if (row == null) continue;

                        int matchCnt = 0;
                        foreach (var filter in filters)
                        {
                            if (row.GetCell(headersColumn[filter.Key]).StringCellValue.Contains(filter.Value)) ++matchCnt;
                        }

                        if (matchCnt == filters.Count)
                        {
                            var dataItem = new DataItem
                            {
                                No = (int)row.GetCell(0).NumericCellValue,
                                DataName = row.GetCell(1).StringCellValue,
                                Link = row.GetCell(2).StringCellValue,
                                Product = row.GetCell(3).StringCellValue,
                                Type = row.GetCell(4).StringCellValue,
                                Ver = row.GetCell(5).StringCellValue,
                                Lot = row.GetCell(6).StringCellValue,
                                Slot = row.GetCell(7).StringCellValue,
                                LotSlot = row.GetCell(8).StringCellValue,
                                Program = row.GetCell(9).StringCellValue,
                                Remark = row.GetCell(10).StringCellValue
                            };
                            DataItems.Add(dataItem);
                        }
                    }
                }
                else
                {
                    // データ行を取得
                    DataItems.Clear();
                    for (int i = 1; i <= sheet.LastRowNum; i++)
                    {
                        var row = sheet.GetRow(i);
                        if (row == null) continue;
                        var dataItem = new DataItem
                        {
                            No = (int)row.GetCell(0).NumericCellValue,
                            DataName = row.GetCell(1).StringCellValue,
                            Link = row.GetCell(2).StringCellValue,
                            Product = row.GetCell(3).StringCellValue,
                            Type = row.GetCell(4).StringCellValue,
                            Ver = row.GetCell(5).StringCellValue,
                            Lot = row.GetCell(6).StringCellValue,
                            Slot = row.GetCell(7).StringCellValue,
                            LotSlot = row.GetCell(8).StringCellValue,
                            Program = row.GetCell(9).StringCellValue,
                            Remark = row.GetCell(10).StringCellValue
                        };
                        DataItems.Add(dataItem);
                    }
                }

                if (SelectedVer.Name != "all") 
                {
                    filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                            + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + "all" + ".xlsx";
                    TmpDataItems = LoadDataItems(filePath);
                    if (File.Exists(filePath)) File.Delete(filePath);
                    await Task.Run(() =>
                    {
                        // ヘッダー行を作成
                        IRow headerRow = sheet.CreateRow(0);
                        int i = 0;
                        foreach (var header in Vals.dataGridHeaders)
                        {
                            headerRow.CreateCell(i).SetCellValue(header);
                            i++;
                        }

                        int j = 1;
                        foreach (var item in TmpDataItems)
                        {
                            if (!MatchDataItem(item, deleteItems[SelectedVer.Name]))
                            {
                                IRow row = sheet.CreateRow(j);
                                int k = 0;
                                row.CreateCell(k).SetCellValue(j);
                                row.CreateCell(++k).SetCellValue(item.DataName);
                                row.CreateCell(++k).SetCellValue(item.Link);
                                row.CreateCell(++k).SetCellValue(item.Product);
                                row.CreateCell(++k).SetCellValue(item.Type);
                                row.CreateCell(++k).SetCellValue(item.Ver);
                                row.CreateCell(++k).SetCellValue(item.Lot);
                                row.CreateCell(++k).SetCellValue(item.Slot);
                                row.CreateCell(++k).SetCellValue(item.LotSlot);
                                row.CreateCell(++k).SetCellValue(item.Program);
                                row.CreateCell(++k).SetCellValue(item.Remark);
                                j++;
                            }
                        }
                    });
                }
                else
                {
                    foreach (var key in deleteItems.Keys)
                    {
                        filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                            + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + key + ".xlsx";
                        TmpDataItems = LoadDataItems(filePath);
                        if (File.Exists(filePath)) File.Delete(filePath);
                        await Task.Run(() =>
                        {
                            // ヘッダー行を作成
                            IRow headerRow = sheet.CreateRow(0);
                            int i = 0;
                            foreach (var header in Vals.dataGridHeaders)
                            {
                                headerRow.CreateCell(i).SetCellValue(header);
                                i++;
                            }

                            int j = 1;
                            foreach (var item in TmpDataItems)
                            {
                                if (!MatchDataItem(item, deleteItems[key]))
                                {
                                    IRow row = sheet.CreateRow(j);
                                    int k = 0;
                                    row.CreateCell(k).SetCellValue(j);
                                    row.CreateCell(++k).SetCellValue(item.DataName);
                                    row.CreateCell(++k).SetCellValue(item.Link);
                                    row.CreateCell(++k).SetCellValue(item.Product);
                                    row.CreateCell(++k).SetCellValue(item.Type);
                                    row.CreateCell(++k).SetCellValue(item.Ver);
                                    row.CreateCell(++k).SetCellValue(item.Lot);
                                    row.CreateCell(++k).SetCellValue(item.Slot);
                                    row.CreateCell(++k).SetCellValue(item.LotSlot);
                                    row.CreateCell(++k).SetCellValue(item.Program);
                                    row.CreateCell(++k).SetCellValue(item.Remark);
                                    j++;
                                }
                            }
                        });
                    }
                }
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }

            //TODO: SelectedVer.Name == "all"のときの処理追加

            // ワークブックをファイルに保存
            using var fs = new FileStream(filePath, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();

            IsDataManegementRemoving = false;
            IsDataManegementEnabled = !IsDataManegementRemoving;
            RemoveDataListStatus = 0;
        }
        private bool CanRemoveDataList()
        {
            return DataItems.Any(item => item.IsSelected);
        }

        private static bool MatchDataItem(DataItem item, List<DataItem> deleteItems)
        {
            bool isMatch = false;

            foreach (DataItem deleteItem in deleteItems) 
            { 
                if (item.DataName==deleteItem.DataName && item.Link == deleteItem.Link)
                {
                    isMatch = true;
                    break;
                }
            }
            return isMatch;
        }

        private static ObservableCollection<DataItem> LoadDataItems(string filePath)
        {
            using var stream = new FileStream(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(stream);
            ISheet sheet = workbook.GetSheetAt(0);

            // データ行を取得
            ObservableCollection<DataItem> Items = [];
            for (int i = 1; i <= sheet.LastRowNum; i++)
            {
                var row = sheet.GetRow(i);
                if (row == null) continue;
                var dataItem = new DataItem
                {
                    No = (int)row.GetCell(0).NumericCellValue,
                    DataName = row.GetCell(1).StringCellValue,
                    Link = row.GetCell(2).StringCellValue,
                    Product = row.GetCell(3).StringCellValue,
                    Type = row.GetCell(4).StringCellValue,
                    Ver = row.GetCell(5).StringCellValue,
                    Lot = row.GetCell(6).StringCellValue,
                    Slot = row.GetCell(7).StringCellValue,
                    LotSlot = row.GetCell(8).StringCellValue,
                    Program = row.GetCell(9).StringCellValue,
                    Remark = row.GetCell(10).StringCellValue
                };
                Items.Add(dataItem);
            }
            workbook.Close();
            return Items;
        }

        [RelayCommand]
        private void ApplyFilter()
        {
            IsFiltering = true;
            foreach (var item in DataItems) item.IsSelected = false;    //選択状態をクリア

            Dictionary<string, string> filters = [];
            foreach (var filter in HeaderFilters)
            {
                if (filter.Value != "") filters.Add(filter.Key, filter.Value);
            }
            if (filters.Count == 0) return;

            try
            {
                Mouse.OverrideCursor = System.Windows.Input.Cursors.Wait;   // マウスカーソルを砂時計に変更
                string filePath = (SelectedMode == "public" ? publicFolder : privateFolder)
                                    + "\\" + SelectedProduct.Name + "_" + SelectedType.Name + "_" + SelectedVer.Name + ".xlsx";
                using var stream = new FileStream(filePath, FileMode.Open, FileAccess.Read);
                XSSFWorkbook workbook = new(stream);
                ISheet sheet = workbook.GetSheetAt(0);

                //ヘッダと紐づけ
                var headerRow = sheet.GetRow(0);
                Dictionary<string, int> headersColumn = [];
                foreach (var filter in filters)
                {
                    for (int j = 0; j < headerRow.LastCellNum; j++)
                    {
                        if (filter.Key == headerRow.GetCell(j).ToString())
                        {
                            headersColumn.Add(filter.Key, j);
                        }
                    }
                }

                // データ行を取得
                DataItems.Clear();
                for (int i = 1; i <= sheet.LastRowNum; i++)
                {
                    var row = sheet.GetRow(i);
                    if (row == null) continue;

                    int matchCnt = 0;
                    foreach (var filter in filters)
                    {
                        if (row.GetCell(headersColumn[filter.Key]).StringCellValue.Contains(filter.Value)) ++matchCnt;
                    }

                    if (matchCnt == filters.Count)
                    {
                        var dataItem = new DataItem
                        {
                            No = (int)row.GetCell(0).NumericCellValue,
                            DataName = row.GetCell(1).StringCellValue,
                            Link = row.GetCell(2).StringCellValue,
                            Product = row.GetCell(3).StringCellValue,
                            Type = row.GetCell(4).StringCellValue,
                            Ver = row.GetCell(5).StringCellValue,
                            Lot = row.GetCell(6).StringCellValue,
                            Slot = row.GetCell(7).StringCellValue,
                            LotSlot = row.GetCell(8).StringCellValue,
                            Program = row.GetCell(9).StringCellValue,
                            Remark = row.GetCell(10).StringCellValue
                        };
                        DataItems.Add(dataItem);
                    }
                }
                workbook.Close();
            }
            finally
            {
                Mouse.OverrideCursor = null;    // 処理が完了したらマウスカーソルを元に戻す
            }

            //if (HeaderFilters.Count == 0)
            //{
            //    FilteredDataItems = new ObservableCollection<ItemModel>(DataItems);
            //}
            //else
            //{
            //    var filtered = DataItems.Where(item =>
            //    {
            //        bool match = true;
            //        foreach (var filter in filters)
            //        {
            //            var propertyValue = item.GetType().GetProperty(filter.Key)?.GetValue(item)?.ToString();
            //            if (propertyValue == null || !propertyValue.Contains(filter.Value))
            //            {
            //                match = false;
            //                break;
            //            }
            //        }
            //        return match;
            //    }).ToList();

            //    FilteredDataItems = new ObservableCollection<ItemModel>(filtered);
            //}
        }

        private void UpdateValueText() 
        {
            SelectedHeaderValue = HeaderFilters[SelectedHeaderKey];
        }

        private static void MakeInitialSetupFile(string _path)
        {
            XSSFWorkbook workbook = new();
            ISheet sheet = workbook.CreateSheet("setup");

            // ヘッダー行を作成
            IRow headerRow = sheet.CreateRow(0);
            headerRow.CreateCell(0).SetCellValue("Product");
            headerRow.CreateCell(1).SetCellValue("isProductDeletable");
            headerRow.CreateCell(2).SetCellValue("Type");
            headerRow.CreateCell(3).SetCellValue("isTypeDeletable");
            headerRow.CreateCell(4).SetCellValue("Ver");
            headerRow.CreateCell(5).SetCellValue("isVerDeletable");

            // データ行を作成
            int d =  0;
            for (int i = 0; i < Vals.initialProducts.Count; i++)
            {
                for (int j = 0; j < Vals.initialTypes.Count; j++)
                {
                    for (int k = 0; k < Vals.initialVers.Count; k++)
                    {
                        IRow row = sheet.CreateRow(++d);
                        row.CreateCell(0).SetCellValue(Vals.initialProducts[i]);
                        row.CreateCell(1).SetCellValue(0);
                        row.CreateCell(2).SetCellValue(Vals.initialTypes[j]);
                        row.CreateCell(3).SetCellValue(0);
                        row.CreateCell(4).SetCellValue(Vals.initialVers[k]);
                        row.CreateCell(5).SetCellValue(0);
                    }
                }
            }

            // ワークブックをファイルに保存
            using var fs = new FileStream(_path, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }

        private static void MakeInitialDataGridInfo(string folderPath, string filePath)
        {
            using FileStream file = new(filePath, FileMode.Open, FileAccess.Read);
            XSSFWorkbook workbook = new(file);
            ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得

            for (int i = 1; i <= sheet.LastRowNum; i++) // 2行目以降を処理
            {
                IRow row = sheet.GetRow(i);
                var product = row.GetCell(0).StringCellValue;
                var type = row.GetCell(2).StringCellValue;
                var ver = row.GetCell(4).StringCellValue;
                string outFilePath = folderPath + "\\" + product + "_" + type + "_" + ver + ".xlsx";
                MakeInitialDataGridFile(outFilePath);
            }
            workbook.Close();
        }

        private static Dictionary<ItemModel, Dictionary<ItemModel, List<ItemModel>>> ReadExcelToDictionary(string filePath)
        {
            var result = new Dictionary<ItemModel, Dictionary<ItemModel, List<ItemModel>>>();

            using (FileStream file = new(filePath, FileMode.Open, FileAccess.Read))
            {
                XSSFWorkbook workbook = new(file);
                ISheet sheet = workbook.GetSheetAt(0); // 最初のシートを取得

                for (int i = 1; i <= sheet.LastRowNum; i++) // 2行目以降を処理
                {
                    IRow row = sheet.GetRow(i);
                    var product = new ItemModel { Name = row.GetCell(0).StringCellValue, IsDeletable = row.GetCell(1).NumericCellValue != 0 };
                    var type = new ItemModel { Name = row.GetCell(2).StringCellValue, IsDeletable = row.GetCell(3).NumericCellValue != 0 };
                    var ver = new ItemModel { Name = row.GetCell(4).StringCellValue, IsDeletable = row.GetCell(5).NumericCellValue != 0 };
                    if (!result.ContainsKey(product)) result[product] = [];
                    if (!result[product].ContainsKey(type)) result[product][type] = [];
                    if (!result[product][type].Contains(ver)) result[product][type].Add(ver);
                }
                workbook.Close();
            }
            return result;
        }

        private static void MakeInitialDataGridFile(string _path)
        {
            XSSFWorkbook workbook = new();
            ISheet sheet = workbook.CreateSheet("DataGrid");

            // ヘッダー行を作成
            IRow headerRow = sheet.CreateRow(0);
            int i = 0;
            foreach (var header in Vals.dataGridHeaders)
            {
                headerRow.CreateCell(i).SetCellValue(header);
                i++;
            }

            // ワークブックをファイルに保存
            using var fs = new FileStream(_path, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }

        private void UpdateDataManegementInfo(DataItem value)
        {
            if (value != null) 
            {
                SelectedDataItemInfo = "DataName:" + value.DataName + "\n"
                                    + "Remark:" + value.Remark + "\n"
                                    + "Product:" + value.Product + ", Ver:" + value.Ver + "\n"
                                    + "Type:" + value.Type + ", LotSlot:" + value.LotSlot + "\n"
                                    + "Program:" + value.Program;
            }
            else SelectedDataItemInfo = string.Empty;
        }

        private void UpdateDataGridFile(string _path)
        {
            XSSFWorkbook workbook = new();
            ISheet sheet = workbook.CreateSheet("DataGrid");

            // ヘッダー行を作成
            IRow headerRow = sheet.CreateRow(0);
            int i = 0;
            foreach (var header in Vals.dataGridHeaders)
            {
                headerRow.CreateCell(i).SetCellValue(header);
                i++;
            }

            int j = 1;
            foreach (var item in DataItems)
            {
                IRow row = sheet.CreateRow(j);
                int k = 0;
                row.CreateCell(k).SetCellValue(j);
                row.CreateCell(++k).SetCellValue(item.DataName);
                row.CreateCell(++k).SetCellValue(item.Link);
                row.CreateCell(++k).SetCellValue(item.Product);
                row.CreateCell(++k).SetCellValue(item.Type);
                row.CreateCell(++k).SetCellValue(item.Ver);
                row.CreateCell(++k).SetCellValue(item.Lot);
                row.CreateCell(++k).SetCellValue(item.Slot);
                row.CreateCell(++k).SetCellValue(item.LotSlot);
                row.CreateCell(++k).SetCellValue(item.Program);
                row.CreateCell(++k).SetCellValue(item.Remark);
                j++;
            }

            // ワークブックをファイルに保存
            using var fs = new FileStream(_path, FileMode.Create, FileAccess.Write);
            workbook.Write(fs);
            workbook.Close();
        }
    }
}
            </code></pre>

            <p>
                MainWindow.xaml
            </p>
            <pre><code class="prettyprint">
//Window.Resources
&lt;Window.Resources&gt;
    &lt;Storyboard x:Key="FlipAnimation" Completed="FlipAnimation_Completed"&gt;
        &lt;DoubleAnimation Storyboard.TargetName="flipperClassic" 
                         Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)" 
                         From="0" To="180" Duration="0:0:0.3" /&gt;
    &lt;/Storyboard&gt;
&lt;/Window.Resources&gt;

//TabControl追加
SelectedIndex="{Binding TabIndex}"

//Home TabItem
&lt;TabItem&gt;
    &lt;TabItem.Header&gt;
        &lt;StackPanel Width="auto" Height="auto"&gt;
            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="Home" /&gt;
            &lt;TextBlock HorizontalAlignment="Center" Text="Home" /&gt;
        &lt;/StackPanel&gt;
    &lt;/TabItem.Header&gt;

    &lt;materialDesign:Transitioner AutoApplyTransitionOrigins="True" SelectedIndex="{Binding SlideIndex}"&gt;
        &lt;materialDesign:Transitioner.InputBindings&gt;
            &lt;KeyBinding Key="Left" Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}"/&gt;
            &lt;KeyBinding Key="Right" Command="{x:Static materialDesign:Transitioner.MoveNextCommand}"/&gt;
        &lt;/materialDesign:Transitioner.InputBindings&gt;

        &lt;!--スタート画面--&gt;
        &lt;materialDesign:TransitionerSlide&gt;
            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;
            
            &lt;Grid&gt;
                &lt;Grid&gt;
                    &lt;Grid.RowDefinitions&gt;
                        &lt;RowDefinition Height="auto" /&gt;
                        &lt;RowDefinition Height="auto" /&gt;
                        &lt;RowDefinition Height="*" /&gt;
                        &lt;RowDefinition Height="*" /&gt;
                        &lt;RowDefinition Height="auto" /&gt;
                    &lt;/Grid.RowDefinitions&gt;

                    &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                        &lt;TextBlock HorizontalAlignment="Center" Text="スタート" FontSize="16" TextWrapping="Wrap"/&gt;
                    &lt;/materialDesign:Card&gt;

                    &lt;!--モード切り替え--&gt;
                    &lt;StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                        &lt;!--&lt;ToggleButton Width="60" Margin="4 8 4 8"
                                      Style="{StaticResource MaterialDesignSwitchToggleButton}"
                                      ToolTip="ONするとデータ管理モードで動作します"
                                      IsChecked="{Binding IsToggled, Mode=TwoWay}"&gt;
                            &lt;materialDesign:ToggleButtonAssist.SwitchTrackOnBackground&gt;
                                &lt;SolidColorBrush Color="Green" /&gt;
                            &lt;/materialDesign:ToggleButtonAssist.SwitchTrackOnBackground&gt;
                            &lt;materialDesign:ToggleButtonAssist.SwitchTrackOffBackground&gt;
                                &lt;SolidColorBrush Color="LightGray" /&gt;
                            &lt;/materialDesign:ToggleButtonAssist.SwitchTrackOffBackground&gt;
                        &lt;/ToggleButton&gt;

                        &lt;TextBlock Text="データ管理モード" FontSize="20" VerticalAlignment="Center" Margin="4 8 4 8" IsEnabled="{Binding IsToggled}"/&gt;--&gt;
                        &lt;materialDesign:FlipperClassic x:Name="flipperClassic" IsFlipped="{Binding IsFlipped, Mode=TwoWay}"
                                                       ToolTip="簡易モードとデータ管理モードの切り替え"&gt;
                            &lt;materialDesign:FlipperClassic.FrontContent&gt;
                                &lt;Button Width="184" Margin="8" Background="MistyRose"
                                        BorderBrush="Firebrick" BorderThickness="1"
                                        materialDesign:ButtonAssist.CornerRadius="8"
                                        Command="{x:Static materialDesign:FlipperClassic.FlipCommand}"
                                        Content="簡易モード"
                                        Style="{StaticResource MaterialDesignFlatButton}"/&gt;
                            &lt;/materialDesign:FlipperClassic.FrontContent&gt;
                            &lt;materialDesign:FlipperClassic.BackContent&gt;
                                &lt;Button Width="184" Margin="8" Background="Honeydew"
                                        BorderBrush="DarkGreen" BorderThickness="1"
                                        materialDesign:ButtonAssist.CornerRadius="8"
                                        Command="{x:Static materialDesign:FlipperClassic.FlipCommand}"
                                        Content="データ管理モード"
                                        Style="{StaticResource MaterialDesignFlatButton}"/&gt;
                            &lt;/materialDesign:FlipperClassic.BackContent&gt;
                        &lt;/materialDesign:FlipperClassic&gt;
                    &lt;/StackPanel&gt;

                    &lt;!--通常使用モードのボタン群--&gt;
                    &lt;materialDesign:Card Grid.Row="2" Background="MistyRose" BorderBrush="Firebrick" BorderThickness="1" 
                         Margin="4 4 4 4" IsEnabled="{Binding IsDataManegementCardEnabled, Converter={StaticResource InvertBooleanConverter}}"&gt;
                        &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectLogToExcelTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="FileExcelOutline" /&gt;
                                    &lt;TextBlock Text="ログエクセル変換" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectDataConvertTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="FileArrowLeftRightOutline" /&gt;
                                    &lt;TextBlock Text="データ変換" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectDecompressTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ArrowSplitHorizontal" /&gt;
                                    &lt;TextBlock Text="解凍" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectCompressTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical" HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ArrowCollapseVertical" /&gt;
                                    &lt;TextBlock Text="圧縮" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectSeverCheckTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical" HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ServerNetwork" /&gt;
                                    &lt;TextBlock Text="サーバーデータチェック" FontSize="18"  HorizontalAlignment="Center" TextAlignment="Center" TextWrapping="Wrap"/&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                        &lt;/StackPanel&gt;
                    &lt;/materialDesign:Card&gt;

                    &lt;!--データ管理モードのボタン群--&gt;
                    &lt;materialDesign:Card Grid.Row="3" Background="Honeydew" BorderBrush="DarkGreen" BorderThickness="1"
                         Margin="4 4 4 4" IsEnabled="{Binding IsDataManegementCardEnabled}"&gt;
                        &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectLogToExcelTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="FileExcelOutline" /&gt;
                                    &lt;TextBlock Text="ログエクセル変換" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectDataConvertTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="FileArrowLeftRightOutline" /&gt;
                                    &lt;TextBlock Text="データ変換" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectDataManegementTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical"  HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="Database" /&gt;
                                    &lt;TextBlock Text="データ管理" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectDataExtractTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical" HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ChartBar" /&gt;
                                    &lt;TextBlock Text="データ抽出" FontSize="18"  HorizontalAlignment="Center" /&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                            &lt;Button Width="150" Height="150" Margin="8 8 8 8" Style="{StaticResource MaterialDesignRaisedLightButton}"
                                    Command="{Binding SelectSeverCheckTabCommand}"&gt;
                                &lt;StackPanel Orientation="Vertical" HorizontalAlignment="Center"&gt;
                                    &lt;materialDesign:PackIcon Width="80" Height="80" HorizontalAlignment="Center" Kind="ServerNetwork" /&gt;
                                    &lt;TextBlock Text="サーバーデータチェック" FontSize="18"  HorizontalAlignment="Center" TextAlignment="Center" TextWrapping="Wrap"/&gt;
                                &lt;/StackPanel&gt;
                            &lt;/Button&gt;
                        &lt;/StackPanel&gt;
                    &lt;/materialDesign:Card&gt;

                    &lt;!--切り替えボタン群--&gt;
                    &lt;StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Center" IsEnabled="{Binding IsDataManegementCardEnabled}"&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8" IsEnabled="False"&gt;
                            &lt;materialDesign:PackIcon Kind="ArrowLeftThick" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFirstSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8" IsEnabled="False"&gt;
                            &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectUserSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectSaveSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFTPSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectScheduleSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MoveNextCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="ArrowRightThick" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                    &lt;/StackPanel&gt;
                &lt;/Grid&gt;
            &lt;/Grid&gt;
        &lt;/materialDesign:TransitionerSlide&gt;

        &lt;!--ユーザー設定画面--&gt;
        &lt;materialDesign:TransitionerSlide&gt;
            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;

            &lt;Grid&gt;
                &lt;StackPanel Orientation="Vertical"&gt;
                    &lt;materialDesign:Card Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                        &lt;TextBlock HorizontalAlignment="Center" Text="ユーザー設定" FontSize="16" TextWrapping="Wrap"/&gt;
                    &lt;/materialDesign:Card&gt;
                &lt;/StackPanel&gt;

                &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                    &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="ArrowLeftThick" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFirstSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectUserSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8" IsEnabled="False"&gt;
                            &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectSaveSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFTPSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectScheduleSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MoveNextCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="ArrowRightThick" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                    &lt;/StackPanel&gt;
                &lt;/StackPanel&gt;
            &lt;/Grid&gt;
        &lt;/materialDesign:TransitionerSlide&gt;

        &lt;!--保存先設定--&gt;
        &lt;materialDesign:TransitionerSlide&gt;
            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;

            &lt;Grid&gt;
                &lt;StackPanel Orientation="Vertical"&gt;
                    &lt;materialDesign:Card Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                        &lt;TextBlock HorizontalAlignment="Center" Text="保存先設定" FontSize="16" TextWrapping="Wrap"/&gt;
                    &lt;/materialDesign:Card&gt;
                &lt;/StackPanel&gt;

                &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                    &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="SkipPrevious" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFirstSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectUserSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectSaveSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8" IsEnabled="False"&gt;
                            &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFTPSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectScheduleSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MoveNextCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="SkipNext" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                    &lt;/StackPanel&gt;
                &lt;/StackPanel&gt;
            &lt;/Grid&gt;
        &lt;/materialDesign:TransitionerSlide&gt;

        &lt;!--FTP設定--&gt;
        &lt;materialDesign:TransitionerSlide&gt;
            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;

            &lt;Grid&gt;
                &lt;StackPanel Orientation="Vertical"&gt;
                    &lt;materialDesign:Card Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                        &lt;TextBlock HorizontalAlignment="Center" Text="FTP設定" FontSize="16" TextWrapping="Wrap"/&gt;
                    &lt;/materialDesign:Card&gt;
                &lt;/StackPanel&gt;

                &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                    &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="SkipPrevious" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFirstSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectUserSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectSaveSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFTPSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8" IsEnabled="False"&gt;
                            &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectScheduleSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MoveNextCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="SkipNext" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                    &lt;/StackPanel&gt;
                &lt;/StackPanel&gt;
            &lt;/Grid&gt;
        &lt;/materialDesign:TransitionerSlide&gt;

        &lt;!--スケジューラー設定--&gt;
        &lt;materialDesign:TransitionerSlide&gt;
            &lt;materialDesign:TransitionerSlide.OpeningEffect&gt;
                &lt;materialDesign:TransitionEffect Kind="SlideInFromBottom" OffsetTime="0:0:0" Duration="0:0:0.5" /&gt;
            &lt;/materialDesign:TransitionerSlide.OpeningEffect&gt;
            &lt;materialDesign:TransitionerSlide.BackwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Right" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.BackwardWipe&gt;
            &lt;materialDesign:TransitionerSlide.ForwardWipe&gt;
                &lt;materialDesign:CircleWipe /&gt;
                &lt;!--&lt;materialDesign:SlideWipe Direction="Left" /&gt;--&gt;
            &lt;/materialDesign:TransitionerSlide.ForwardWipe&gt;
            &lt;Grid&gt;
                &lt;StackPanel Orientation="Vertical"&gt;
                    &lt;materialDesign:Card Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
                        &lt;TextBlock HorizontalAlignment="Center" Text="スケジューラー設定" FontSize="16" TextWrapping="Wrap"/&gt;
                    &lt;/materialDesign:Card&gt;
                &lt;/StackPanel&gt;

                &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                    &lt;StackPanel Orientation="Horizontal" HorizontalAlignment="Center"&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MovePreviousCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="SkipPrevious" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFirstSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="HomeFloor1" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectUserSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="Account" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectSaveSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="StorageTankOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectFTPSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8"&gt;
                            &lt;materialDesign:PackIcon Kind="FolderDownloadOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{Binding SelectScheduleSlideCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8" IsEnabled="False" &gt;
                            &lt;materialDesign:PackIcon Kind="InvoiceTextClockOutline" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                        &lt;Button Command="{x:Static materialDesign:Transitioner.MoveNextCommand}"
                                Style="{StaticResource MaterialDesignFloatingActionLightButton}"
                                Margin="4 4 4 8" IsEnabled="False"&gt;
                            &lt;materialDesign:PackIcon Kind="SkipNext" Width="30" Height="30"/&gt;
                        &lt;/Button&gt;
                    &lt;/StackPanel&gt;
                &lt;/StackPanel&gt;
            &lt;/Grid&gt;
        &lt;/materialDesign:TransitionerSlide&gt;
    &lt;/materialDesign:Transitioner&gt;

&lt;/TabItem&gt;

//Data Manegement
&lt;TabItem&gt;
    &lt;TabItem.Header&gt;
        &lt;StackPanel Width="auto" Height="auto"&gt;
            &lt;materialDesign:PackIcon Width="32" Height="32" HorizontalAlignment="Center" Kind="Database" /&gt;
            &lt;TextBlock HorizontalAlignment="Center" Text="管理" /&gt;
        &lt;/StackPanel&gt;
    &lt;/TabItem.Header&gt;

    &lt;Grid&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="auto"/&gt;
            &lt;RowDefinition Height="*"/&gt;
        &lt;/Grid.RowDefinitions&gt;

        &lt;materialDesign:Card Grid.Row="0" Padding="8" Background="DarkRed" Foreground="White" UniformCornerRadius="0"&gt;
            &lt;TextBlock HorizontalAlignment="Center" Text="データ管理" FontSize="16" TextWrapping="Wrap"/&gt;
        &lt;/materialDesign:Card&gt;

        &lt;Grid Grid.Row="1"&gt;
            &lt;Grid.ColumnDefinitions&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="*"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
                &lt;ColumnDefinition Width="auto"/&gt;
            &lt;/Grid.ColumnDefinitions&gt;

            &lt;Grid Grid.Column="0"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                    &lt;RowDefinition Height="*"/&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                &lt;/Grid.RowDefinitions&gt;

                &lt;ListBox x:Name="RadioButtonGroupChoiceChipPrimaryOutline"
                         Style="{StaticResource MaterialDesignChoiceChipPrimaryOutlineListBox}"
                         ItemsSource="{Binding Modes}" SelectedItem="{Binding SelectedMode}"
                         Margin="4 4 4 4" IsEnabled="{Binding IsDataManegementEnabled}"&gt;
                    &lt;ListBox.ItemTemplate&gt;
                        &lt;DataTemplate&gt;
                            &lt;TextBlock Text="{Binding}" /&gt;
                        &lt;/DataTemplate&gt;
                    &lt;/ListBox.ItemTemplate&gt;
                &lt;/ListBox&gt;

                &lt;Grid Grid.Row="1"&gt;
                    &lt;Grid.ColumnDefinitions&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                        &lt;ColumnDefinition Width="auto"/&gt;
                    &lt;/Grid.ColumnDefinitions&gt;

                    &lt;Grid Grid.Column="0"&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;TextBlock Text="Product" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                            &lt;Button Command="{Binding AddProductCommand}" HorizontalAlignment="Center" 
                                    Width="90" Margin="2 4 2 4" Content="Add" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;TextBox Height="29"  Margin="6 2 6 2" Text="{Binding NewProductText, UpdateSourceTrigger=PropertyChanged}"
                                     Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="ProductTextBox_KeyDown"
                                     IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/StackPanel&gt;

                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                                 BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                                 ItemsSource="{Binding Products}" SelectedItem="{Binding SelectedProduct}" 
                                 SelectedIndex="{Binding SelectedProductIndex}" Style="{StaticResource MaterialDesignListBox}"
                                 ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                            &lt;ListBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ListBox.ItemTemplate&gt;
                        &lt;/ListBox&gt;

                        &lt;Button Grid.Row="3" Command="{Binding RemoveProductCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 2 2 8" Content="Del" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                    &lt;/Grid&gt;

                    &lt;Grid Grid.Column="1"&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;TextBlock Text="Type" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                            &lt;Button Command="{Binding AddTypeCommand}" HorizontalAlignment="Center" 
                                    Width="90" Margin="2 4 2 4" Content="Add" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;TextBox Height="29" Margin="6 2 6 2" Text="{Binding NewTypeText, UpdateSourceTrigger=PropertyChanged}"
                                     Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="TypeTextBox_KeyDown"
                                     IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/StackPanel&gt;

                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                                 BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                                 ItemsSource="{Binding Types}" SelectedItem="{Binding SelectedType}" 
                                 SelectedIndex="{Binding SelectedTypeIndex}" Style="{StaticResource MaterialDesignListBox}"
                                 ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                            &lt;ListBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ListBox.ItemTemplate&gt;
                        &lt;/ListBox&gt;

                        &lt;Button Grid.Row="3" Command="{Binding RemoveTypeCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 2 2 8" Content="Del" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                    &lt;/Grid&gt;

                    &lt;Grid Grid.Column="2"&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                            &lt;RowDefinition Height="*"/&gt;
                            &lt;RowDefinition Height="auto"/&gt;
                        &lt;/Grid.RowDefinitions&gt;

                        &lt;TextBlock Text="Ver" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" /&gt;

                        &lt;StackPanel Grid.Row="1" Orientation="Vertical"&gt;
                            &lt;Button Command="{Binding AddVerCommand}" HorizontalAlignment="Center" 
                                    Width="90" Margin="2 4 2 4" Content="Add" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;TextBox Height="29" Margin="6 2 6 2" Text="{Binding NewVerText, UpdateSourceTrigger=PropertyChanged}"
                                     Background="White" Style="{StaticResource MaterialDesignTextBox}" KeyDown="VerTextBox_KeyDown"
                                     IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/StackPanel&gt;

                        &lt;ListBox Grid.Row="2" Background="White" Margin ="2 4 2 4" Width="100"
                                 BorderBrush="LightGray" BorderThickness="1" IsEnabled="{Binding IsDataManegementEnabled}"
                                 ItemsSource="{Binding Vers}" SelectedItem="{Binding SelectedVer}" 
                                 SelectedIndex="{Binding SelectedVerIndex}" Style="{StaticResource MaterialDesignListBox}" ScrollViewer.HorizontalScrollBarVisibility="Auto"&gt;
                            &lt;ListBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding Name}" Margin="0 -2 0 -2"/&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ListBox.ItemTemplate&gt;
                        &lt;/ListBox&gt;

                        &lt;Button Grid.Row="3" Command="{Binding RemoveVerCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="2 2 2 8" Content="Del" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                    &lt;/Grid&gt;
                &lt;/Grid&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="1"&gt;
                &lt;Grid.RowDefinitions&gt;
                    &lt;RowDefinition Height="auto"/&gt;
                    &lt;RowDefinition Height="*"/&gt;
                &lt;/Grid.RowDefinitions&gt;

                &lt;StackPanel Orientation="Horizontal"&gt;
                    &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                        &lt;TextBlock Text="DataList" Margin="8 4 4 4" FontWeight="Bold" TextDecorations="Underline" VerticalAlignment="Top"/&gt;
                        &lt;Button Command="{Binding AddDataListCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="6 4 2 2" Content="Add" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;Button Command="{Binding RemoveDataListCommand}" HorizontalAlignment="Center" 
                                Width="90" Margin="6 2 2 4" Content="Del" IsEnabled="{Binding IsDataManegementEnabled}" 
                                materialDesign:ButtonProgressAssist.IsIndeterminate="{Binding IsDataManegementRemoving}"
                                materialDesign:ButtonProgressAssist.IsIndicatorVisible="{Binding IsDataManegementRemoving}"
                                materialDesign:ButtonProgressAssist.Value="{Binding RemoveDataListStatus}"/&gt;
                    &lt;/StackPanel&gt;
                    
                    &lt;GroupBox Height="136" Width="300" Margin="4 8 4 4" Padding="0"
                              Header="Infomation" IsEnabled="{Binding IsDataManegementEnabled}"
                              materialDesign:GroupBoxAssist.HeaderPadding="4"
                              Style="{StaticResource MaterialDesignGroupBox}"&gt;
                        &lt;ScrollViewer Padding="4" materialDesign:ScrollViewerAssist.PaddingMode="Content"&gt;
                            &lt;StackPanel&gt;
                                &lt;TextBlock Margin="4" TextWrapping="Wrap" Text="{Binding SelectedDataItemInfo}" /&gt;
                            &lt;/StackPanel&gt;
                        &lt;/ScrollViewer&gt;
                    &lt;/GroupBox&gt;

                    &lt;StackPanel Orientation="Vertical" VerticalAlignment="Bottom"&gt;
                        &lt;Grid&gt;
                            &lt;Grid.ColumnDefinitions&gt;
                                &lt;ColumnDefinition Width="*"/&gt;
                                &lt;ColumnDefinition Width="*"/&gt;
                            &lt;/Grid.ColumnDefinitions&gt;
                            &lt;Button Grid.Column="0" Margin="6 0 0 0" Padding="4 0 4 0"
                                    HorizontalAlignment="Left" VerticalAlignment="Bottom"
                                    Command="{Binding ApplyFilterCommand}" Content="Filtering"
                                    Style="{StaticResource MaterialDesignFlatButton}" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                            &lt;Button Grid.Column="1" Margin="0 0 8 0" Padding="4 0 4 0"
                                    HorizontalAlignment="Right" VerticalAlignment="Bottom"
                                    Command="{Binding ClearFilterCommand}" Content="Clear"
                                    Style="{StaticResource MaterialDesignFlatButton}" IsEnabled="{Binding IsDataManegementEnabled}"/&gt;
                        &lt;/Grid&gt;
                        
                        &lt;ComboBox Margin="4 4 4 4" Width="150" Height="40"
                                  materialDesign:HintAssist.Hint="Header" IsEnabled="{Binding IsDataManegementEnabled}"
                                  Style="{StaticResource MaterialDesignFilledComboBox}"
                                  ItemsSource="{Binding Headers}" SelectedItem="{Binding SelectedHeaderKey}"&gt;
                            &lt;ComboBox.ItemTemplate&gt;
                                &lt;DataTemplate&gt;
                                    &lt;TextBlock Text="{Binding}" /&gt;
                                &lt;/DataTemplate&gt;
                            &lt;/ComboBox.ItemTemplate&gt;
                        &lt;/ComboBox&gt;
                        &lt;TextBox Margin="4 4 4 4" Width="150" Height="40" VerticalAlignment="Top"
                                 Padding="8 -8 0 -8" IsEnabled="{Binding IsDataManegementEnabled}"
                                 materialDesign:HintAssist.Hint="Filter"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Text="{Binding SelectedHeaderValue}"/&gt;
                    &lt;/StackPanel&gt;
                &lt;/StackPanel&gt;

                &lt;Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" Margin="4 1 4 4"&gt;
                    &lt;!--&lt;ListView ItemsSource="{Binding Files}" 
                              ScrollViewer.HorizontalScrollBarVisibility="Auto" 
                              ScrollViewer.VerticalScrollBarVisibility="Auto"&gt;
                        &lt;ListView.View&gt;
                            &lt;GridView&gt;
                                &lt;GridViewColumn DisplayMemberBinding="{Binding FolderName}" Header="No" /&gt;
                                &lt;GridViewColumn DisplayMemberBinding="{Binding FolderName}" Header="DataName" /&gt;
                                &lt;GridViewColumn DisplayMemberBinding="{Binding FileName}" Header="link"/&gt;
                                &lt;GridViewColumn DisplayMemberBinding="{Binding FileName}" Header="Type"/&gt;
                                &lt;GridViewColumn DisplayMemberBinding="{Binding FileName}" Header="Ver"/&gt;
                                &lt;GridViewColumn DisplayMemberBinding="{Binding FileName}" Header="Lot"/&gt;
                                &lt;GridViewColumn DisplayMemberBinding="{Binding FileName}" Header="Slot"/&gt;
                                &lt;GridViewColumn DisplayMemberBinding="{Binding FileName}" Header="Lot-Slot"/&gt;
                                &lt;GridViewColumn DisplayMemberBinding="{Binding FileName}" Header="Pro"/&gt;
                            &lt;/GridView&gt;
                        &lt;/ListView.View&gt;
                    &lt;/ListView&gt;--&gt;

                    &lt;DataGrid VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.VirtualizationMode="Recycling" 
                              EnableRowVirtualization="True" EnableColumnVirtualization="True"
                              CanUserAddRows="False" AutoGenerateColumns="False" IsEnabled="{Binding IsDataManegementEnabled}"
                              ItemsSource="{Binding DataItems, Mode=TwoWay}" SelectionMode="Extended"
                              SelectedItem="{Binding SelectedDataItem}" SelectionChanged="DataItem_SelectionChanged"&gt;
                        &lt;DataGrid.RowStyle&gt;
                            &lt;Style TargetType="{x:Type DataGridRow}" BasedOn="{StaticResource {x:Type DataGridRow}}"&gt;
                                &lt;Setter Property="IsSelected" Value="{Binding IsSelected,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/&gt;
                            &lt;/Style&gt;
                        &lt;/DataGrid.RowStyle&gt;
                        &lt;DataGrid.Columns&gt;
                            &lt;!--*** No ***--&gt;
                            &lt;DataGridTextColumn Header="No" Binding="{Binding No}" IsReadOnly="True"/&gt;
                            &lt;!--*** DataName ***--&gt;
                            &lt;DataGridTextColumn Header="DataName" Binding="{Binding DataName}" IsReadOnly="True"/&gt;
                            &lt;!--*** Link ***--&gt;
                            &lt;DataGridTemplateColumn Header="Link" IsReadOnly="True" Width="100"&gt;
                                &lt;DataGridTemplateColumn.CellTemplate&gt;
                                    &lt;DataTemplate&gt;
                                        &lt;TextBlock&gt; 
                                            &lt;Hyperlink NavigateUri="{Binding Link}" RequestNavigate="Hyperlink_RequestNavigate"&gt; 
                                                &lt;TextBlock Text="{Binding Link}"/&gt; 
                                            &lt;/Hyperlink&gt; 
                                        &lt;/TextBlock&gt;
                                    &lt;/DataTemplate&gt;
                                &lt;/DataGridTemplateColumn.CellTemplate&gt;
                            &lt;/DataGridTemplateColumn&gt;
                            &lt;!--*** Product ***--&gt;
                            &lt;materialDesign:DataGridTextColumn
                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                Header="Product"&gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Product"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Type ***--&gt;
                            &lt;materialDesign:DataGridTextColumn
                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                Header="Type"&gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Type"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Ver ***--&gt;
                            &lt;materialDesign:DataGridTextColumn
                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                Header="Ver"&gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Ver"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Lot ***--&gt;
                            &lt;materialDesign:DataGridTextColumn
                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                Header="Lot"&gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Lot"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Slot ***--&gt;
                            &lt;materialDesign:DataGridTextColumn
                            EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                            ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                            Header="Slot"&gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Slot"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** LotSlot ***--&gt;
                            &lt;materialDesign:DataGridTextColumn
                            EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                            ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                            Header="LotSlot"&gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="LotSlot"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Program ***--&gt;
                            &lt;materialDesign:DataGridTextColumn
                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                Header="Program"&gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Program"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                            &lt;!--*** Remark ***--&gt;
                            &lt;materialDesign:DataGridTextColumn
                                EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnPopupEditingStyle}"
                                ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}" 
                                Header="Remark"&gt;
                                &lt;materialDesign:DataGridTextColumn.Binding&gt;
                                    &lt;Binding Path="Remark"&gt;
                                        &lt;Binding.ValidationRules&gt;
                                            &lt;local:NotEmptyValidationRule /&gt;
                                        &lt;/Binding.ValidationRules&gt;
                                    &lt;/Binding&gt;
                                &lt;/materialDesign:DataGridTextColumn.Binding&gt;
                            &lt;/materialDesign:DataGridTextColumn&gt;
                        &lt;/DataGrid.Columns&gt;
                    &lt;/DataGrid&gt;
                    
                    &lt;!--&lt;DataGrid ItemsSource="{Binding DataItems}" AutoGenerateColumns="False" CanUserAddRows="False"&gt;
                        &lt;DataGrid.Columns&gt;
                            &lt;DataGridTextColumn Header="No" Binding="{Binding No}" IsReadOnly="True"/&gt;
                            &lt;DataGridTextColumn Header="DataName" Binding="{Binding DataName}" IsReadOnly="True"/&gt;
                            &lt;DataGridTemplateColumn Header="Link" IsReadOnly="True" Width="100"&gt;
                                &lt;DataGridTemplateColumn.CellTemplate&gt;
                                    &lt;DataTemplate&gt;
                                        &lt;TextBlock&gt; 
                                            &lt;Hyperlink NavigateUri="{Binding Link}" RequestNavigate="Hyperlink_RequestNavigate"&gt; 
                                                &lt;TextBlock Text="{Binding Link}"/&gt; 
                                            &lt;/Hyperlink&gt; 
                                        &lt;/TextBlock&gt;
                                    &lt;/DataTemplate&gt;
                                &lt;/DataGridTemplateColumn.CellTemplate&gt;
                            &lt;/DataGridTemplateColumn&gt;

                            --&gt;&lt;!--可変列をバインディングする--&gt;
                            &lt;!--&lt;DataGridTemplateColumn Header="Dynamic Columns"&gt;
                                &lt;DataGridTemplateColumn.CellTemplate&gt;
                                    &lt;DataTemplate&gt;
                                        &lt;ItemsControl ItemsSource="{Binding VariableColumns}"&gt;
                                            &lt;ItemsControl.ItemTemplate&gt;
                                                &lt;DataTemplate&gt;
                                                    &lt;TextBox Text="{Binding}" Margin="2"/&gt;
                                                &lt;/DataTemplate&gt;
                                            &lt;/ItemsControl.ItemTemplate&gt;
                                        &lt;/ItemsControl&gt;
                                    &lt;/DataTemplate&gt;
                                &lt;/DataGridTemplateColumn.CellTemplate&gt;
                            &lt;/DataGridTemplateColumn&gt;--&gt;&lt;!--
                        &lt;/DataGrid.Columns&gt;
                    &lt;/DataGrid&gt;--&gt;

                &lt;/Border&gt;
            &lt;/Grid&gt;

            &lt;Grid Grid.Column="2"&gt;
                &lt;Expander ExpandDirection="Right" IsEnabled="{Binding IsDataManegementEnabled}"&gt;
                    &lt;Expander.Header&gt;
                        &lt;TextBlock RenderTransformOrigin=".5,.5" Text="データ選択"&gt;
                            &lt;TextBlock.LayoutTransform&gt;
                                &lt;RotateTransform Angle="-90" /&gt;
                            &lt;/TextBlock.LayoutTransform&gt;
                        &lt;/TextBlock&gt;
                    &lt;/Expander.Header&gt;
                    &lt;StackPanel Margin="8,8,8,8" Orientation="Vertical" TextBlock.Foreground="{DynamicResource MaterialDesignBody}"&gt;
                        &lt;TextBlock Text="準備中" /&gt;
                    &lt;/StackPanel&gt;
                &lt;/Expander&gt;
            &lt;/Grid&gt;
        &lt;/Grid&gt;
    &lt;/Grid&gt;

&lt;/TabItem&gt;
            </code></pre>

            <p>
                MainWindow.xaml.cs
            </p>
            <pre><code class="prettyprint">
                public MainWindow()
{
    InitializeComponent();
    DataContext = new MainViewModel();
    //DataContextChanged += MainWindow_DataContextChanged;
}

//Home用
private void FlipAnimation_Completed(object sender, EventArgs e)
{
    if (DataContext is MainViewModel viewModel)
    {
        viewModel.EnableDataManegementCard();
    }
}

//データ管理
private void TextBox_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Enter)
    {
        if (DataContext is MainViewModel viewModel && viewModel.AddItemCommand.CanExecute(null))
        {
            viewModel.AddItemCommand.Execute(null);
        }
    }
}

private void ProductTextBox_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Enter)
    {
        if (DataContext is MainViewModel viewModel && viewModel.AddProductCommand.CanExecute(null))
        {
            viewModel.AddProductCommand.Execute(null);
        }
    }
}

private void TypeTextBox_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Enter)
    {
        if (DataContext is MainViewModel viewModel && viewModel.AddTypeCommand.CanExecute(null))
        {
            viewModel.AddTypeCommand.Execute(null);
        }
    }
}

private void VerTextBox_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Enter)
    {
        if (DataContext is MainViewModel viewModel && viewModel.AddVerCommand.CanExecute(null))
        {
            viewModel.AddVerCommand.Execute(null);
        }
    }
}

//private void Hyperlink_Click(object sender, RoutedEventArgs e)
//{
//    if (sender is Hyperlink hyperlink)
//    {
//        var url = hyperlink.NavigateUri.ToString();
//        System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo
//        {
//            FileName = url,
//            UseShellExecute = true
//        });
//    }
//}

//private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)
//{
//    System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(e.Uri.AbsoluteUri) { UseShellExecute = true });
//    e.Handled = true;
//}

//private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e) 
//{ 
//    var encodedUrl = HttpUtility.UrlEncode(e.Uri.AbsoluteUri); 
//    System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(encodedUrl) { UseShellExecute = true }); 
//    e.Handled = true; 
//}

private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)
{
    System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(e.Uri.ToString()) { UseShellExecute = true });
    e.Handled = true;
}

//private void MainWindow_DataContextChanged(object sender, DependencyPropertyChangedEventArgs e)
//{
//    if (DataContext is MainViewModel viewModel)
//    {
//        viewModel.LoadDataCommand.Execute(null);

//        foreach (var header in viewModel.DynamicColumnHeaders)
//        {
//            dataGrid.Columns.Add(new DataGridTextColumn
//            {
//                Header = header,
//                Binding = new System.Windows.Data.Binding($"VariableColumns[{viewModel.DynamicColumnHeaders.IndexOf(header)}]")
//            });
//        }
//    }
//}

private void DataItem_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    if (DataContext is MainViewModel viewModel && sender is System.Windows.Controls.DataGrid dataGrid)
    {
        foreach (DataItem item in dataGrid.Items)
        {
            item.IsSelected = dataGrid.SelectedItems.Contains(item);
        }

        // コマンドの有効状態を更新
        viewModel.RemoveDataListCommand.NotifyCanExecuteChanged();
    }
}
            </code></pre>
            <p>
                NotEmptyValidationRule.cs
            </p>
            <pre><code class="prettyprint">
                using System.Globalization;
using System.Windows.Controls;

namespace DataManager
{
    public class NotEmptyValidationRule : ValidationRule
    {
        public override ValidationResult Validate(object value, CultureInfo cultureInfo) 
        { 
            if (string.IsNullOrWhiteSpace(value?.ToString())) 
            { 
                return new ValidationResult(false, "空にはできません。");
            } 
            return ValidationResult.ValidResult;
        }
    }
}
            </code></pre>

            <p>
                Vals.cs
            </p>
            <pre><code class="prettyprint">
                namespace DataManager
{
    public static class Vals
    {
        public static readonly List<string> initialProducts = ["-"];
        public static readonly List<string> initialTypes = ["-", "test1", "test2", "test3", "test4", "test5", "test6", "test7"];
        public static readonly List<string> initialVers = ["all", "-"];
        public static readonly List<string> dataGridHeaders = ["No", "DataName", "Link", "Product", "Type", "Ver", "Lot", "Slot", "LotSlot", "Pro", "Remark"];
        public const int BATCH_SIZE = 50;
        public const int BATCH_DELAY = 10;
    }
}
            </code></pre>
        </article>
    </div>

    <footer>
        <div class="wrapper">
            <p><small>&copy; 2022 大人の学び舎</small></p>
        </div>
    </footer>
</body>

</html>